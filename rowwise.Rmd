
# rowwise operation  



## do() + rowwise()

```{r}
do(mtcars, head(., 2))
```



```{r}
do(mtcars, filter(., cyl > 6))
```

```{r}
by_cyl <- group_by(mtcars, cyl)
do(by_cyl, head(., 2))
```


```{r}
models <- by_cyl %>% 
  do(mod = lm(mpg ~ disp, data = .))

models
```

```{r}
models %>% do(data.frame(
  var = names(coef(.$mod)),
  coef(summary(.$mod)))
)

```

 
```{r}
by_cyl %>% 
  group_modify(~ broom::tidy(lm(mpg ~ disp, data = .)))
```

```{r}
df <- expand.grid(x = 1:3, y = 3:1)
df_done <- df %>% 
  rowwise() %>% 
  do(i = seq(.$x, .$y))
df_done
```

```{r}
df_done %>% 
  summarise(n = length(i))
```



## rap

see https://github.com/romainfrancois/rap
```{r}
# devtools::install_github("romainfrancois/rap")
```

```{r}
library(rap)
```


```{r}
tbl <- tibble(cyl_threshold = c(4, 6, 8), mpg_threshold = c(30, 25, 20)) 
tbl
```

```{r}
tbl %>% 
  rap(x = ~ filter(mtcars, cyl == cyl_threshold, mpg < mpg_threshold))
```

