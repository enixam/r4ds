<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>17.2 Wrangling | R for data science: tidyverse and beyond</title>
  <meta name="description" content="17.2 Wrangling | R for data science: tidyverse and beyond" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="17.2 Wrangling | R for data science: tidyverse and beyond" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="enixam/rfordatascience" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="17.2 Wrangling | R for data science: tidyverse and beyond" />
  
  
  

<meta name="author" content="Maxine" />


<meta name="date" content="2020-05-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="explore-missing.html"/>
<link rel="next" href="imputation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/jsoneditor-5.25.6/jsoneditor.min.css" rel="stylesheet" />
<script src="libs/jsoneditor-5.25.6/jsoneditor.min.js"></script>
<script src="libs/jsonedit-binding-3.0.0/jsonedit.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R4DS: tidyverse and beyond</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="part"><span><b>I R for data science</b></span></li>
<li class="chapter" data-level="1" data-path="dplyr-data-transformation.html"><a href="dplyr-data-transformation.html"><i class="fa fa-check"></i><b>1</b> dplyr: Data transformation</a><ul>
<li class="chapter" data-level="1.1" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>1.1</b> <code>filter()</code></a><ul>
<li class="chapter" data-level="1.1.1" data-path="filter.html"><a href="filter.html#operators"><i class="fa fa-check"></i><b>1.1.1</b> Operators</a></li>
<li class="chapter" data-level="1.1.2" data-path="filter.html"><a href="filter.html#missing-values"><i class="fa fa-check"></i><b>1.1.2</b> Missing values</a></li>
<li class="chapter" data-level="1.1.3" data-path="filter.html"><a href="filter.html#exercises"><i class="fa fa-check"></i><b>1.1.3</b> Exercises</a></li>
<li class="chapter" data-level="1.1.4" data-path="filter.html"><a href="filter.html#slice"><i class="fa fa-check"></i><b>1.1.4</b> <code>slice()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="arrange.html"><a href="arrange.html"><i class="fa fa-check"></i><b>1.2</b> <code>arrange()</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="arrange.html"><a href="arrange.html#exercises-1"><i class="fa fa-check"></i><b>1.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="select.html"><a href="select.html"><i class="fa fa-check"></i><b>1.3</b> <code>select()</code></a><ul>
<li class="chapter" data-level="1.3.1" data-path="select.html"><a href="select.html#练习"><i class="fa fa-check"></i><b>1.3.1</b> 练习</a></li>
<li class="chapter" data-level="1.3.2" data-path="select.html"><a href="select.html#常用创建函数"><i class="fa fa-check"></i><b>1.3.2</b> 常用创建函数</a></li>
<li class="chapter" data-level="1.3.3" data-path="select.html"><a href="select.html#exercises-2"><i class="fa fa-check"></i><b>1.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="summarize.html"><a href="summarize.html"><i class="fa fa-check"></i><b>1.4</b> <code>summarize()</code></a><ul>
<li class="chapter" data-level="1.4.1" data-path="summarize.html"><a href="summarize.html#missing-values-in-summarize"><i class="fa fa-check"></i><b>1.4.1</b> Missing values in <code>summarize()</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="summarize.html"><a href="summarize.html#计数函数"><i class="fa fa-check"></i><b>1.4.2</b> 计数函数</a></li>
<li class="chapter" data-level="1.4.3" data-path="summarize.html"><a href="summarize.html#逻辑值的计数和比例sumx-10-和-meany-0"><i class="fa fa-check"></i><b>1.4.3</b> 逻辑值的计数和比例:<code>sum(x &gt; 10) 和 mean(y == 0)</code></a></li>
<li class="chapter" data-level="1.4.4" data-path="summarize.html"><a href="summarize.html#其他常用的摘要函数"><i class="fa fa-check"></i><b>1.4.4</b> 其他常用的摘要函数</a></li>
<li class="chapter" data-level="1.4.5" data-path="summarize.html"><a href="summarize.html#多个分组变量的消耗"><i class="fa fa-check"></i><b>1.4.5</b> 多个分组变量的消耗</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="group-by-combined-with-other-functions.html"><a href="group-by-combined-with-other-functions.html"><i class="fa fa-check"></i><b>1.5</b> <code>group_by()</code> combined with other functions</a></li>
<li class="chapter" data-level="1.6" data-path="dplyr-exercise.html"><a href="dplyr-exercise.html"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tibble-modern-data-frames.html"><a href="tibble-modern-data-frames.html"><i class="fa fa-check"></i><b>2</b> tibble: Modern data frames</a><ul>
<li class="chapter" data-level="2.1" data-path="tibble-intro.html"><a href="tibble-intro.html"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html"><i class="fa fa-check"></i><b>2.2</b> Comparing tibble and data.frame</a><ul>
<li class="chapter" data-level="2.2.1" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html#creating"><i class="fa fa-check"></i><b>2.2.1</b> Creating</a></li>
<li class="chapter" data-level="2.2.2" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html#printing"><i class="fa fa-check"></i><b>2.2.2</b> Printing</a></li>
<li class="chapter" data-level="2.2.3" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html#subsetting"><i class="fa fa-check"></i><b>2.2.3</b> Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html"><i class="fa fa-check"></i><b>2.3</b> Comparing two data frames (tibbles)</a><ul>
<li class="chapter" data-level="2.3.1" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#dplyrall_equal"><i class="fa fa-check"></i><b>2.3.1</b> <code>dplyr::all_equal()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#janitorcompare_df_cols"><i class="fa fa-check"></i><b>2.3.2</b> <code>janitor::compare_df_cols()</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#vetralike"><i class="fa fa-check"></i><b>2.3.3</b> <code>vetr::alike()</code></a></li>
<li class="chapter" data-level="2.3.4" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#diffdfdiffdf"><i class="fa fa-check"></i><b>2.3.4</b> <code>diffdf::diffdf()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="tibble-exercise.html"><a href="tibble-exercise.html"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="readr-data-import.html"><a href="readr-data-import.html"><i class="fa fa-check"></i><b>3</b> readr: Data import</a><ul>
<li class="chapter" data-level="3.1" data-path="importing-data-in-base-r.html"><a href="importing-data-in-base-r.html"><i class="fa fa-check"></i><b>3.1</b> Importing data in base R</a></li>
<li class="chapter" data-level="3.2" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html"><i class="fa fa-check"></i><b>3.2</b> Importing data in <code>readr</code></a><ul>
<li class="chapter" data-level="3.2.1" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html#introduction"><i class="fa fa-check"></i><b>3.2.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2.2" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html#writing-data"><i class="fa fa-check"></i><b>3.2.2</b> Writing data</a></li>
<li class="chapter" data-level="3.2.3" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html#exercises-3"><i class="fa fa-check"></i><b>3.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html"><i class="fa fa-check"></i><b>3.3</b> Parsing a vector</a><ul>
<li class="chapter" data-level="3.3.1" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#numeric"><i class="fa fa-check"></i><b>3.3.1</b> Numeric</a></li>
<li class="chapter" data-level="3.3.2" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#character"><i class="fa fa-check"></i><b>3.3.2</b> Character</a></li>
<li class="chapter" data-level="3.3.3" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#factor"><i class="fa fa-check"></i><b>3.3.3</b> Factor</a></li>
<li class="chapter" data-level="3.3.4" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#date-and-time"><i class="fa fa-check"></i><b>3.3.4</b> Date and time</a></li>
<li class="chapter" data-level="3.3.5" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#exercises-4"><i class="fa fa-check"></i><b>3.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="parsing-a-file.html"><a href="parsing-a-file.html"><i class="fa fa-check"></i><b>3.4</b> Parsing a file</a><ul>
<li class="chapter" data-level="3.4.1" data-path="parsing-a-file.html"><a href="parsing-a-file.html#strategies"><i class="fa fa-check"></i><b>3.4.1</b> Strategies</a></li>
<li class="chapter" data-level="3.4.2" data-path="parsing-a-file.html"><a href="parsing-a-file.html#possible-challenges"><i class="fa fa-check"></i><b>3.4.2</b> Possible challenges</a></li>
<li class="chapter" data-level="3.4.3" data-path="parsing-a-file.html"><a href="parsing-a-file.html#other-tips"><i class="fa fa-check"></i><b>3.4.3</b> Other tips</a></li>
<li class="chapter" data-level="3.4.4" data-path="parsing-a-file.html"><a href="parsing-a-file.html#example-dealing-with-metadata"><i class="fa fa-check"></i><b>3.4.4</b> Example: Dealing with metadata</a></li>
<li class="chapter" data-level="3.4.5" data-path="parsing-a-file.html"><a href="parsing-a-file.html#example-multi-row-headers"><i class="fa fa-check"></i><b>3.4.5</b> Example: multi-row headers</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="readxl.html"><a href="readxl.html"><i class="fa fa-check"></i><b>3.5</b> <code>readxl</code></a><ul>
<li class="chapter" data-level="3.5.1" data-path="readxl.html"><a href="readxl.html#multi-row-headers-in-excel"><i class="fa fa-check"></i><b>3.5.1</b> Multi-row headers in Excel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lubridate-dates-and-times.html"><a href="lubridate-dates-and-times.html"><i class="fa fa-check"></i><b>4</b> lubridate: Dates and times</a><ul>
<li class="chapter" data-level="4.1" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html"><i class="fa fa-check"></i><b>4.1</b> Creating dates and times</a><ul>
<li class="chapter" data-level="4.1.1" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#from-strings"><i class="fa fa-check"></i><b>4.1.1</b> From strings</a></li>
<li class="chapter" data-level="4.1.2" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#from-individual-components"><i class="fa fa-check"></i><b>4.1.2</b> From individual components</a></li>
<li class="chapter" data-level="4.1.3" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#from-other-times"><i class="fa fa-check"></i><b>4.1.3</b> From other times</a></li>
<li class="chapter" data-level="4.1.4" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#exercises-5"><i class="fa fa-check"></i><b>4.1.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="date-time-components.html"><a href="date-time-components.html"><i class="fa fa-check"></i><b>4.2</b> Date-time components</a><ul>
<li class="chapter" data-level="4.2.1" data-path="date-time-components.html"><a href="date-time-components.html#accessing-components"><i class="fa fa-check"></i><b>4.2.1</b> Accessing components</a></li>
<li class="chapter" data-level="4.2.2" data-path="date-time-components.html"><a href="date-time-components.html#rounding"><i class="fa fa-check"></i><b>4.2.2</b> Rounding</a></li>
<li class="chapter" data-level="4.2.3" data-path="date-time-components.html"><a href="date-time-components.html#setting-components"><i class="fa fa-check"></i><b>4.2.3</b> Setting components</a></li>
<li class="chapter" data-level="4.2.4" data-path="date-time-components.html"><a href="date-time-components.html#exercises-6"><i class="fa fa-check"></i><b>4.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="time-span.html"><a href="time-span.html"><i class="fa fa-check"></i><b>4.3</b> Time span</a><ul>
<li class="chapter" data-level="4.3.1" data-path="time-span.html"><a href="time-span.html#时期-durations"><i class="fa fa-check"></i><b>4.3.1</b> 时期 Durations</a></li>
<li class="chapter" data-level="4.3.2" data-path="time-span.html"><a href="time-span.html#阶段-periods"><i class="fa fa-check"></i><b>4.3.2</b> 阶段 Periods</a></li>
<li class="chapter" data-level="4.3.3" data-path="time-span.html"><a href="time-span.html#区间-intervals"><i class="fa fa-check"></i><b>4.3.3</b> 区间 Intervals</a></li>
<li class="chapter" data-level="4.3.4" data-path="time-span.html"><a href="time-span.html#conclusion"><i class="fa fa-check"></i><b>4.3.4</b> Conclusion</a></li>
<li class="chapter" data-level="4.3.5" data-path="time-span.html"><a href="time-span.html#exercises-7"><i class="fa fa-check"></i><b>4.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="hms.html"><a href="hms.html"><i class="fa fa-check"></i><b>4.4</b> hms</a></li>
<li class="chapter" data-level="4.5" data-path="dint.html"><a href="dint.html"><i class="fa fa-check"></i><b>4.5</b> dint</a><ul>
<li class="chapter" data-level="4.5.1" data-path="dint.html"><a href="dint.html#creation"><i class="fa fa-check"></i><b>4.5.1</b> Creation</a></li>
<li class="chapter" data-level="4.5.2" data-path="dint.html"><a href="dint.html#arithmetic-and-sequences"><i class="fa fa-check"></i><b>4.5.2</b> Arithmetic and Sequences</a></li>
<li class="chapter" data-level="4.5.3" data-path="dint.html"><a href="dint.html#accessors"><i class="fa fa-check"></i><b>4.5.3</b> Accessors</a></li>
<li class="chapter" data-level="4.5.4" data-path="dint.html"><a href="dint.html#formatting"><i class="fa fa-check"></i><b>4.5.4</b> Formatting</a></li>
<li class="chapter" data-level="4.5.5" data-path="dint.html"><a href="dint.html#labelling-functions-in-ggplot2"><i class="fa fa-check"></i><b>4.5.5</b> Labelling functions in ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="forcats-factor.html"><a href="forcats-factor.html"><i class="fa fa-check"></i><b>5</b> forcats: factor</a><ul>
<li class="chapter" data-level="5.1" data-path="factor-basics.html"><a href="factor-basics.html"><i class="fa fa-check"></i><b>5.1</b> Factor basics</a></li>
<li class="chapter" data-level="5.2" data-path="sorting.html"><a href="sorting.html"><i class="fa fa-check"></i><b>5.2</b> Sorting</a><ul>
<li class="chapter" data-level="5.2.1" data-path="sorting.html"><a href="sorting.html#sorting-by-frequency-appearance-or-numeric-order"><i class="fa fa-check"></i><b>5.2.1</b> Sorting by frequency, appearance, or numeric order</a></li>
<li class="chapter" data-level="5.2.2" data-path="sorting.html"><a href="sorting.html#sorting-by-another-variable"><i class="fa fa-check"></i><b>5.2.2</b> Sorting by another variable</a></li>
<li class="chapter" data-level="5.2.3" data-path="sorting.html"><a href="sorting.html#sorting-manually"><i class="fa fa-check"></i><b>5.2.3</b> Sorting manually</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html"><i class="fa fa-check"></i><b>5.3</b> Chaninge number of levels</a><ul>
<li class="chapter" data-level="5.3.1" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#lumping-levels"><i class="fa fa-check"></i><b>5.3.1</b> Lumping levels</a></li>
<li class="chapter" data-level="5.3.2" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#expanding-levels"><i class="fa fa-check"></i><b>5.3.2</b> Expanding levels</a></li>
<li class="chapter" data-level="5.3.3" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#dropping-levels"><i class="fa fa-check"></i><b>5.3.3</b> Dropping levels</a></li>
<li class="chapter" data-level="5.3.4" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#transforming-na-levels"><i class="fa fa-check"></i><b>5.3.4</b> Transforming NA levels</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="recoding.html"><a href="recoding.html"><i class="fa fa-check"></i><b>5.4</b> Recoding</a><ul>
<li class="chapter" data-level="5.4.1" data-path="recoding.html"><a href="recoding.html#exercises-8"><i class="fa fa-check"></i><b>5.4.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidyr-tidy-data.html"><a href="tidyr-tidy-data.html"><i class="fa fa-check"></i><b>6</b> tidyr: Tidy data</a><ul>
<li class="chapter" data-level="6.1" data-path="tidyr-intro.html"><a href="tidyr-intro.html"><i class="fa fa-check"></i><b>6.1</b> Tidy data</a><ul>
<li class="chapter" data-level="6.1.1" data-path="tidyr-intro.html"><a href="tidyr-intro.html#exercises-9"><i class="fa fa-check"></i><b>6.1.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="pivoting.html"><a href="pivoting.html"><i class="fa fa-check"></i><b>6.2</b> Pivoting</a><ul>
<li class="chapter" data-level="6.2.1" data-path="pivoting.html"><a href="pivoting.html#pivot_longer"><i class="fa fa-check"></i><b>6.2.1</b> <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="pivoting.html"><a href="pivoting.html#pivot_wider"><i class="fa fa-check"></i><b>6.2.2</b> <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="6.2.3" data-path="pivoting.html"><a href="pivoting.html#combining-pivot_longer-and-pivot_wider"><i class="fa fa-check"></i><b>6.2.3</b> Combining <code>pivot_longer()</code> and <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="pivoting.html"><a href="pivoting.html#exercises-10"><i class="fa fa-check"></i><b>6.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="nesting.html"><a href="nesting.html"><i class="fa fa-check"></i><b>6.3</b> Nesting</a><ul>
<li class="chapter" data-level="6.3.1" data-path="nesting.html"><a href="nesting.html#example-managing-multiple-models"><i class="fa fa-check"></i><b>6.3.1</b> Example: Managing multiple models</a></li>
<li class="chapter" data-level="6.3.2" data-path="nesting.html"><a href="nesting.html#multi-choice"><i class="fa fa-check"></i><b>6.3.2</b> Example: Multicple hoice data</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="rectangling.html"><a href="rectangling.html"><i class="fa fa-check"></i><b>6.4</b> Rectangling</a><ul>
<li class="chapter" data-level="6.4.1" data-path="rectangling.html"><a href="rectangling.html#github-users"><i class="fa fa-check"></i><b>6.4.1</b> Github users</a></li>
<li class="chapter" data-level="6.4.2" data-path="rectangling.html"><a href="rectangling.html#github-repos"><i class="fa fa-check"></i><b>6.4.2</b> Github repos</a></li>
<li class="chapter" data-level="6.4.3" data-path="rectangling.html"><a href="rectangling.html#game-of-throne-characters"><i class="fa fa-check"></i><b>6.4.3</b> Game of Throne characters</a></li>
<li class="chapter" data-level="6.4.4" data-path="rectangling.html"><a href="rectangling.html#sharla-gelfands-discography"><i class="fa fa-check"></i><b>6.4.4</b> Sharla Gelfand’s discography</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="separate-and-untie.html"><a href="separate-and-untie.html"><i class="fa fa-check"></i><b>6.5</b> <code>separate()</code> and <code>untie()</code></a><ul>
<li class="chapter" data-level="6.5.1" data-path="separate-and-untie.html"><a href="separate-and-untie.html#separate"><i class="fa fa-check"></i><b>6.5.1</b> <code>separate()</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="separate-and-untie.html"><a href="separate-and-untie.html#unite"><i class="fa fa-check"></i><b>6.5.2</b> <code>unite()</code></a></li>
<li class="chapter" data-level="6.5.3" data-path="separate-and-untie.html"><a href="separate-and-untie.html#exercises-11"><i class="fa fa-check"></i><b>6.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="tidyr-missing.html"><a href="tidyr-missing.html"><i class="fa fa-check"></i><b>6.6</b> Handling missing values</a></li>
<li class="chapter" data-level="6.7" data-path="tidyr-case.html"><a href="tidyr-case.html"><i class="fa fa-check"></i><b>6.7</b> Case Study</a></li>
<li class="chapter" data-level="6.8" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html"><i class="fa fa-check"></i><b>6.8</b> Miscellaneous Functions</a><ul>
<li class="chapter" data-level="6.8.1" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html#chop-and-unchop"><i class="fa fa-check"></i><b>6.8.1</b> <code>chop()</code> and <code>unchop()</code></a></li>
<li class="chapter" data-level="6.8.2" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html#uncount"><i class="fa fa-check"></i><b>6.8.2</b> <code>uncount()</code></a></li>
<li class="chapter" data-level="6.8.3" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html#exercises-12"><i class="fa fa-check"></i><b>6.8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="non-tidy.html"><a href="non-tidy.html"><i class="fa fa-check"></i><b>6.9</b> None-tidy data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="purrr-functional-programming.html"><a href="purrr-functional-programming.html"><i class="fa fa-check"></i><b>7</b> purrr: Functional programming</a><ul>
<li class="chapter" data-level="7.1" data-path="map-family.html"><a href="map-family.html"><i class="fa fa-check"></i><b>7.1</b> <code>map()</code> family</a></li>
<li class="chapter" data-level="7.2" data-path="producing-atomic-vectors.html"><a href="producing-atomic-vectors.html"><i class="fa fa-check"></i><b>7.2</b> Producing atomic vectors</a><ul>
<li class="chapter" data-level="7.2.1" data-path="producing-atomic-vectors.html"><a href="producing-atomic-vectors.html#purrr-style-anonymous-functions"><i class="fa fa-check"></i><b>7.2.1</b> purrr-style anonymous functions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="predicate-functions.html"><a href="predicate-functions.html"><i class="fa fa-check"></i><b>7.3</b> Predicate functions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="predicate-functions.html"><a href="predicate-functions.html#basics"><i class="fa fa-check"></i><b>7.3.1</b> Basics</a></li>
<li class="chapter" data-level="7.3.2" data-path="predicate-functions.html"><a href="predicate-functions.html#map-variants"><i class="fa fa-check"></i><b>7.3.2</b> Map variants</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="group-functions.html"><a href="group-functions.html"><i class="fa fa-check"></i><b>7.4</b> group functions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="group-functions.html"><a href="group-functions.html#group_mapgroup_modify"><i class="fa fa-check"></i><b>7.4.1</b> group_map、group_modify</a></li>
<li class="chapter" data-level="7.4.2" data-path="group-functions.html"><a href="group-functions.html#group_nestgroup_splitgroup_keysgroup_data"><i class="fa fa-check"></i><b>7.4.2</b> group_nest、group_split、group_keys、group_data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="other-useful-tools.html"><a href="other-useful-tools.html"><i class="fa fa-check"></i><b>7.5</b> Other useful tools</a><ul>
<li class="chapter" data-level="7.5.1" data-path="other-useful-tools.html"><a href="other-useful-tools.html#imap"><i class="fa fa-check"></i><b>7.5.1</b> <code>imap()</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="other-useful-tools.html"><a href="other-useful-tools.html#adverbs"><i class="fa fa-check"></i><b>7.5.2</b> adverbs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>8</b> Relational data</a><ul>
<li class="chapter" data-level="8.1" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="mutating-joins.html"><a href="mutating-joins.html"><i class="fa fa-check"></i><b>8.2</b> Mutating joins</a></li>
<li class="chapter" data-level="8.3" data-path="filtering-join.html"><a href="filtering-join.html"><i class="fa fa-check"></i><b>8.3</b> Filtering join</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="broom-tidy-representation-of-models.html"><a href="broom-tidy-representation-of-models.html"><i class="fa fa-check"></i><b>9</b> broom: Tidy representation of models</a><ul>
<li class="chapter" data-level="9.1" data-path="viz-many-models.html"><a href="viz-many-models.html"><i class="fa fa-check"></i><b>9.1</b> Visualizing many models</a></li>
<li class="chapter" data-level="9.2" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>9.2</b> Examples</a><ul>
<li class="chapter" data-level="9.2.1" data-path="examples.html"><a href="examples.html#pca"><i class="fa fa-check"></i><b>9.2.1</b> PCA</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="broomextra.html"><a href="broomextra.html"><i class="fa fa-check"></i><b>9.3</b> broomExtra</a></li>
<li class="chapter" data-level="9.4" data-path="ggfortify.html"><a href="ggfortify.html"><i class="fa fa-check"></i><b>9.4</b> ggfortify</a></li>
</ul></li>
<li class="part"><span><b>II Importing</b></span></li>
<li class="chapter" data-level="10" data-path="vroom-fast-reading-of-delimited-files.html"><a href="vroom-fast-reading-of-delimited-files.html"><i class="fa fa-check"></i><b>10</b> vroom: Fast reading of delimited files</a></li>
<li class="chapter" data-level="11" data-path="reading-in-data-from-other-formats.html"><a href="reading-in-data-from-other-formats.html"><i class="fa fa-check"></i><b>11</b> Reading in data from other formats</a><ul>
<li class="chapter" data-level="11.1" data-path="pdf.html"><a href="pdf.html"><i class="fa fa-check"></i><b>11.1</b> PDF</a><ul>
<li class="chapter" data-level="11.1.1" data-path="pdf.html"><a href="pdf.html#scraping-pdf-data"><i class="fa fa-check"></i><b>11.1.1</b> Scraping pdf data</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="office-documents.html"><a href="office-documents.html"><i class="fa fa-check"></i><b>11.2</b> Office documents</a></li>
<li class="chapter" data-level="11.3" data-path="google-sheet.html"><a href="google-sheet.html"><i class="fa fa-check"></i><b>11.3</b> Google sheet</a></li>
<li class="chapter" data-level="11.4" data-path="images.html"><a href="images.html"><i class="fa fa-check"></i><b>11.4</b> Images</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="useful-apis.html"><a href="useful-apis.html"><i class="fa fa-check"></i><b>12</b> Useful APIs</a><ul>
<li class="chapter" data-level="12.1" data-path="wdi.html"><a href="wdi.html"><i class="fa fa-check"></i><b>12.1</b> WDI</a><ul>
<li class="chapter" data-level="12.1.1" data-path="wdi.html"><a href="wdi.html#wdisearch"><i class="fa fa-check"></i><b>12.1.1</b> <code>WDIsearch()</code></a></li>
<li class="chapter" data-level="12.1.2" data-path="wdi.html"><a href="wdi.html#wdi-1"><i class="fa fa-check"></i><b>12.1.2</b> <code>WDI</code></a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="ipumsr.html"><a href="ipumsr.html"><i class="fa fa-check"></i><b>12.2</b> ipumsr</a></li>
</ul></li>
<li class="part"><span><b>III Exploring and Wrangling</b></span></li>
<li class="chapter" data-level="13" data-path="data-summary.html"><a href="data-summary.html"><i class="fa fa-check"></i><b>13</b> Data summary</a><ul>
<li class="chapter" data-level="13.1" data-path="skimr.html"><a href="skimr.html"><i class="fa fa-check"></i><b>13.1</b> skimr</a></li>
<li class="chapter" data-level="13.2" data-path="visdat.html"><a href="visdat.html"><i class="fa fa-check"></i><b>13.2</b> visdat</a></li>
<li class="chapter" data-level="13.3" data-path="summarytools.html"><a href="summarytools.html"><i class="fa fa-check"></i><b>13.3</b> summarytools</a><ul>
<li class="chapter" data-level="13.3.1" data-path="summarytools.html"><a href="summarytools.html#freq"><i class="fa fa-check"></i><b>13.3.1</b> <code>freq</code></a></li>
<li class="chapter" data-level="13.3.2" data-path="summarytools.html"><a href="summarytools.html#descr"><i class="fa fa-check"></i><b>13.3.2</b> <code>descr()</code></a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="gt-and-gtsummary.html"><a href="gt-and-gtsummary.html"><i class="fa fa-check"></i><b>13.4</b> gt and gtsummary</a></li>
<li class="chapter" data-level="13.5" data-path="naniar.html"><a href="naniar.html"><i class="fa fa-check"></i><b>13.5</b> naniar</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="janitor.html"><a href="janitor.html"><i class="fa fa-check"></i><b>14</b> Janitor</a><ul>
<li class="chapter" data-level="14.1" data-path="janitor-cleaning.html"><a href="janitor-cleaning.html"><i class="fa fa-check"></i><b>14.1</b> cleaning</a><ul>
<li class="chapter" data-level="14.1.1" data-path="janitor-cleaning.html"><a href="janitor-cleaning.html#clean_names"><i class="fa fa-check"></i><b>14.1.1</b> <code>clean_names</code></a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="janitor-explore.html"><a href="janitor-explore.html"><i class="fa fa-check"></i><b>14.2</b> Exploring</a><ul>
<li class="chapter" data-level="14.2.1" data-path="janitor-explore.html"><a href="janitor-explore.html#tabyl"><i class="fa fa-check"></i><b>14.2.1</b> <code>tabyl</code></a></li>
<li class="chapter" data-level="14.2.2" data-path="janitor-explore.html"><a href="janitor-explore.html#get_dupes"><i class="fa fa-check"></i><b>14.2.2</b> <code>get_dupes</code></a></li>
<li class="chapter" data-level="14.2.3" data-path="janitor-explore.html"><a href="janitor-explore.html#remove_"><i class="fa fa-check"></i><b>14.2.3</b> <code>remove_</code></a></li>
<li class="chapter" data-level="14.2.4" data-path="janitor-explore.html"><a href="janitor-explore.html#round_half_up"><i class="fa fa-check"></i><b>14.2.4</b> <code>round_half_up</code></a></li>
<li class="chapter" data-level="14.2.5" data-path="janitor-explore.html"><a href="janitor-explore.html#excel_numeric_to_date"><i class="fa fa-check"></i><b>14.2.5</b> <code>excel_numeric_to_date</code></a></li>
<li class="chapter" data-level="14.2.6" data-path="janitor-explore.html"><a href="janitor-explore.html#top_levels"><i class="fa fa-check"></i><b>14.2.6</b> <code>top_levels</code></a></li>
<li class="chapter" data-level="14.2.7" data-path="janitor-explore.html"><a href="janitor-explore.html#row_to_names"><i class="fa fa-check"></i><b>14.2.7</b> <code>row_to_names</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Miscellaneous tools</b></span></li>
<li class="chapter" data-level="15" data-path="advanced-relational-data.html"><a href="advanced-relational-data.html"><i class="fa fa-check"></i><b>15</b> Advanced relational data</a><ul>
<li class="chapter" data-level="15.1" data-path="fuzzyjoin.html"><a href="fuzzyjoin.html"><i class="fa fa-check"></i><b>15.1</b> fuzzyjoin</a><ul>
<li class="chapter" data-level="15.1.1" data-path="fuzzyjoin.html"><a href="fuzzyjoin.html#inexact-matching"><i class="fa fa-check"></i><b>15.1.1</b> inexact matching</a></li>
<li class="chapter" data-level="15.1.2" data-path="fuzzyjoin.html"><a href="fuzzyjoin.html#stringdist"><i class="fa fa-check"></i><b>15.1.2</b> stringdist</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="funneljoin.html"><a href="funneljoin.html"><i class="fa fa-check"></i><b>15.2</b> funneljoin</a><ul>
<li class="chapter" data-level="15.2.1" data-path="funneljoin.html"><a href="funneljoin.html#after_join"><i class="fa fa-check"></i><b>15.2.1</b> <code>after_join()</code></a></li>
<li class="chapter" data-level="15.2.2" data-path="funneljoin.html"><a href="funneljoin.html#funnel-in-one-table"><i class="fa fa-check"></i><b>15.2.2</b> funnel in one table</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="dm.html"><a href="dm.html"><i class="fa fa-check"></i><b>15.3</b> dm</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="categorical-data-facotr.html"><a href="categorical-data-facotr.html"><i class="fa fa-check"></i><b>16</b> Categorical data (facotr)</a><ul>
<li class="chapter" data-level="16.1" data-path="frequency-and-contingency-table.html"><a href="frequency-and-contingency-table.html"><i class="fa fa-check"></i><b>16.1</b> Frequency and contingency table</a><ul>
<li class="chapter" data-level="16.1.1" data-path="frequency-and-contingency-table.html"><a href="frequency-and-contingency-table.html#frq-and-flat_table"><i class="fa fa-check"></i><b>16.1.1</b> <code>frq()</code> and <code>flat_table()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="coding.html"><a href="coding.html"><i class="fa fa-check"></i><b>16.2</b> Coding</a><ul>
<li class="chapter" data-level="16.2.1" data-path="coding.html"><a href="coding.html#rec"><i class="fa fa-check"></i><b>16.2.1</b> <code>rec()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="cutting.html"><a href="cutting.html"><i class="fa fa-check"></i><b>16.3</b> Cutting</a><ul>
<li class="chapter" data-level="16.3.1" data-path="cutting.html"><a href="cutting.html#chop"><i class="fa fa-check"></i><b>16.3.1</b> <code>chop()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="dealing-with-missing-values.html"><a href="dealing-with-missing-values.html"><i class="fa fa-check"></i><b>17</b> Dealing with missing values</a><ul>
<li class="chapter" data-level="17.1" data-path="explore-missing.html"><a href="explore-missing.html"><i class="fa fa-check"></i><b>17.1</b> Exploring</a><ul>
<li class="chapter" data-level="17.1.1" data-path="explore-missing.html"><a href="explore-missing.html#naniar-1"><i class="fa fa-check"></i><b>17.1.1</b> naniar</a></li>
<li class="chapter" data-level="17.1.2" data-path="explore-missing.html"><a href="explore-missing.html#replace-a-value-with-na"><i class="fa fa-check"></i><b>17.1.2</b> Replace a value with NA</a></li>
<li class="chapter" data-level="17.1.3" data-path="explore-missing.html"><a href="explore-missing.html#janitor-1"><i class="fa fa-check"></i><b>17.1.3</b> janitor</a></li>
<li class="chapter" data-level="17.1.4" data-path="explore-missing.html"><a href="explore-missing.html#sjmisc"><i class="fa fa-check"></i><b>17.1.4</b> sjmisc</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>17.2</b> Wrangling</a><ul>
<li class="chapter" data-level="17.2.1" data-path="wrangling.html"><a href="wrangling.html#tidyr"><i class="fa fa-check"></i><b>17.2.1</b> tidyr</a></li>
<li class="chapter" data-level="17.2.2" data-path="wrangling.html"><a href="wrangling.html#janitor-2"><i class="fa fa-check"></i><b>17.2.2</b> janitor</a></li>
<li class="chapter" data-level="17.2.3" data-path="wrangling.html"><a href="wrangling.html#visdat-1"><i class="fa fa-check"></i><b>17.2.3</b> visdat</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="imputation.html"><a href="imputation.html"><i class="fa fa-check"></i><b>17.3</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">written with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for data science: tidyverse and beyond</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="wrangling" class="section level2">
<h2><span class="header-section-number">17.2</span> Wrangling</h2>
<div id="tidyr" class="section level3">
<h3><span class="header-section-number">17.2.1</span> tidyr</h3>
<p><code>tidyr</code> provides a handful of tools for converting between implicit (absent rows) and explicit (<code>NA</code>) missing values, and for handling explicit <code>NA</code>s.</p>
<div id="drop_na-drop-rows-containing-missing-values" class="section level4">
<h4><span class="header-section-number">17.2.1.1</span> <code>drop_na()</code> drop rows containing missing values</h4>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb609-1" title="1"><span class="co"># df %&gt;% drop_na(Ozone, Solar.R, Wind, Temp, Month, Day)</span></a>
<a class="sourceLine" id="cb609-2" title="2">airquality &lt;-<span class="st"> </span>airquality <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb609-3" title="3">airquality <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>() </a>
<a class="sourceLine" id="cb609-4" title="4"><span class="co">#&gt; # A tibble: 111 x 6</span></a>
<a class="sourceLine" id="cb609-5" title="5"><span class="co">#&gt;   Ozone Solar.R  Wind  Temp Month   Day</span></a>
<a class="sourceLine" id="cb609-6" title="6"><span class="co">#&gt;   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb609-7" title="7"><span class="co">#&gt; 1    41     190   7.4    67     5     1</span></a>
<a class="sourceLine" id="cb609-8" title="8"><span class="co">#&gt; 2    36     118   8      72     5     2</span></a>
<a class="sourceLine" id="cb609-9" title="9"><span class="co">#&gt; 3    12     149  12.6    74     5     3</span></a>
<a class="sourceLine" id="cb609-10" title="10"><span class="co">#&gt; 4    18     313  11.5    62     5     4</span></a>
<a class="sourceLine" id="cb609-11" title="11"><span class="co">#&gt; 5    23     299   8.6    65     5     7</span></a>
<a class="sourceLine" id="cb609-12" title="12"><span class="co">#&gt; 6    19      99  13.8    59     5     8</span></a>
<a class="sourceLine" id="cb609-13" title="13"><span class="co">#&gt; # ... with 105 more rows</span></a>
<a class="sourceLine" id="cb609-14" title="14"></a>
<a class="sourceLine" id="cb609-15" title="15">airquality <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>(Solar.R)</a>
<a class="sourceLine" id="cb609-16" title="16"><span class="co">#&gt; # A tibble: 146 x 6</span></a>
<a class="sourceLine" id="cb609-17" title="17"><span class="co">#&gt;   Ozone Solar.R  Wind  Temp Month   Day</span></a>
<a class="sourceLine" id="cb609-18" title="18"><span class="co">#&gt;   &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb609-19" title="19"><span class="co">#&gt; 1    41     190   7.4    67     5     1</span></a>
<a class="sourceLine" id="cb609-20" title="20"><span class="co">#&gt; 2    36     118   8      72     5     2</span></a>
<a class="sourceLine" id="cb609-21" title="21"><span class="co">#&gt; 3    12     149  12.6    74     5     3</span></a>
<a class="sourceLine" id="cb609-22" title="22"><span class="co">#&gt; 4    18     313  11.5    62     5     4</span></a>
<a class="sourceLine" id="cb609-23" title="23"><span class="co">#&gt; 5    23     299   8.6    65     5     7</span></a>
<a class="sourceLine" id="cb609-24" title="24"><span class="co">#&gt; 6    19      99  13.8    59     5     8</span></a>
<a class="sourceLine" id="cb609-25" title="25"><span class="co">#&gt; # ... with 140 more rows</span></a></code></pre></div>
</div>
<div id="replace_na-replace-missing-values" class="section level4">
<h4><span class="header-section-number">17.2.1.2</span> <code>replace_na()</code> replace missing values</h4>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb610-1" title="1"><span class="co"># NULL are the list-col equivalent of NAs</span></a>
<a class="sourceLine" id="cb610-2" title="2">df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="ot">NA</span>), </a>
<a class="sourceLine" id="cb610-3" title="3">             <span class="dt">y =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="ot">NA</span>, <span class="st">&quot;b&quot;</span>), </a>
<a class="sourceLine" id="cb610-4" title="4">             <span class="dt">z =</span> <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="ot">NULL</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">20</span>)) </a>
<a class="sourceLine" id="cb610-5" title="5"></a>
<a class="sourceLine" id="cb610-6" title="6"></a>
<a class="sourceLine" id="cb610-7" title="7">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x =</span> <span class="kw">replace_na</span>(x, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb610-8" title="8"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb610-9" title="9"><span class="co">#&gt;       x y     z         </span></a>
<a class="sourceLine" id="cb610-10" title="10"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;list&gt;    </span></a>
<a class="sourceLine" id="cb610-11" title="11"><span class="co">#&gt; 1     1 a     &lt;int [5]&gt; </span></a>
<a class="sourceLine" id="cb610-12" title="12"><span class="co">#&gt; 2     2 &lt;NA&gt;  &lt;NULL&gt;    </span></a>
<a class="sourceLine" id="cb610-13" title="13"><span class="co">#&gt; 3     0 b     &lt;int [11]&gt;</span></a>
<a class="sourceLine" id="cb610-14" title="14"></a>
<a class="sourceLine" id="cb610-15" title="15">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">replace_na</span>(<span class="kw">list</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="st">&quot;unknown&quot;</span>))</a>
<a class="sourceLine" id="cb610-16" title="16"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb610-17" title="17"><span class="co">#&gt;       x y       z         </span></a>
<a class="sourceLine" id="cb610-18" title="18"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;list&gt;    </span></a>
<a class="sourceLine" id="cb610-19" title="19"><span class="co">#&gt; 1     1 a       &lt;int [5]&gt; </span></a>
<a class="sourceLine" id="cb610-20" title="20"><span class="co">#&gt; 2     2 unknown &lt;NULL&gt;    </span></a>
<a class="sourceLine" id="cb610-21" title="21"><span class="co">#&gt; 3     0 b       &lt;int [11]&gt;</span></a>
<a class="sourceLine" id="cb610-22" title="22"></a>
<a class="sourceLine" id="cb610-23" title="23">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">replace_na</span>(<span class="kw">list</span>(<span class="dt">z =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb610-24" title="24"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb610-25" title="25"><span class="co">#&gt;       x y     z         </span></a>
<a class="sourceLine" id="cb610-26" title="26"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;list&gt;    </span></a>
<a class="sourceLine" id="cb610-27" title="27"><span class="co">#&gt; 1     1 a     &lt;int [5]&gt; </span></a>
<a class="sourceLine" id="cb610-28" title="28"><span class="co">#&gt; 2     2 &lt;NA&gt;  &lt;dbl [1]&gt; </span></a>
<a class="sourceLine" id="cb610-29" title="29"><span class="co">#&gt; 3    NA b     &lt;int [11]&gt;</span></a></code></pre></div>
</div>
<div id="fill-fill-in-missing-values-with-previous-or-next-value" class="section level4">
<h4><span class="header-section-number">17.2.1.3</span> <code>fill()</code> fill in missing values with previous or next value</h4>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb611-1" title="1">df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Month =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb611-2" title="2">             <span class="dt">Year =</span> <span class="kw">c</span>(<span class="dv">2000</span>, <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">11</span>), </a>
<a class="sourceLine" id="cb611-3" title="3">                      <span class="dv">2001</span>, <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">11</span>)))</a>
<a class="sourceLine" id="cb611-4" title="4"></a>
<a class="sourceLine" id="cb611-5" title="5">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fill</span>(Year) <span class="co"># .direction = &quot;down&quot;</span></a>
<a class="sourceLine" id="cb611-6" title="6"><span class="co">#&gt; # A tibble: 24 x 2</span></a>
<a class="sourceLine" id="cb611-7" title="7"><span class="co">#&gt;   Month  Year</span></a>
<a class="sourceLine" id="cb611-8" title="8"><span class="co">#&gt;   &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb611-9" title="9"><span class="co">#&gt; 1     1  2000</span></a>
<a class="sourceLine" id="cb611-10" title="10"><span class="co">#&gt; 2     2  2000</span></a>
<a class="sourceLine" id="cb611-11" title="11"><span class="co">#&gt; 3     3  2000</span></a>
<a class="sourceLine" id="cb611-12" title="12"><span class="co">#&gt; 4     4  2000</span></a>
<a class="sourceLine" id="cb611-13" title="13"><span class="co">#&gt; 5     5  2000</span></a>
<a class="sourceLine" id="cb611-14" title="14"><span class="co">#&gt; 6     6  2000</span></a>
<a class="sourceLine" id="cb611-15" title="15"><span class="co">#&gt; # ... with 18 more rows</span></a>
<a class="sourceLine" id="cb611-16" title="16">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fill</span>(Year, <span class="dt">.direction =</span> <span class="st">&quot;up&quot;</span>)</a>
<a class="sourceLine" id="cb611-17" title="17"><span class="co">#&gt; # A tibble: 24 x 2</span></a>
<a class="sourceLine" id="cb611-18" title="18"><span class="co">#&gt;   Month  Year</span></a>
<a class="sourceLine" id="cb611-19" title="19"><span class="co">#&gt;   &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb611-20" title="20"><span class="co">#&gt; 1     1  2000</span></a>
<a class="sourceLine" id="cb611-21" title="21"><span class="co">#&gt; 2     2  2001</span></a>
<a class="sourceLine" id="cb611-22" title="22"><span class="co">#&gt; 3     3  2001</span></a>
<a class="sourceLine" id="cb611-23" title="23"><span class="co">#&gt; 4     4  2001</span></a>
<a class="sourceLine" id="cb611-24" title="24"><span class="co">#&gt; 5     5  2001</span></a>
<a class="sourceLine" id="cb611-25" title="25"><span class="co">#&gt; 6     6  2001</span></a>
<a class="sourceLine" id="cb611-26" title="26"><span class="co">#&gt; # ... with 18 more rows</span></a>
<a class="sourceLine" id="cb611-27" title="27">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fill</span>(Year, <span class="dt">.direction =</span> <span class="st">&quot;updown&quot;</span>)</a>
<a class="sourceLine" id="cb611-28" title="28"><span class="co">#&gt; # A tibble: 24 x 2</span></a>
<a class="sourceLine" id="cb611-29" title="29"><span class="co">#&gt;   Month  Year</span></a>
<a class="sourceLine" id="cb611-30" title="30"><span class="co">#&gt;   &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb611-31" title="31"><span class="co">#&gt; 1     1  2000</span></a>
<a class="sourceLine" id="cb611-32" title="32"><span class="co">#&gt; 2     2  2001</span></a>
<a class="sourceLine" id="cb611-33" title="33"><span class="co">#&gt; 3     3  2001</span></a>
<a class="sourceLine" id="cb611-34" title="34"><span class="co">#&gt; 4     4  2001</span></a>
<a class="sourceLine" id="cb611-35" title="35"><span class="co">#&gt; 5     5  2001</span></a>
<a class="sourceLine" id="cb611-36" title="36"><span class="co">#&gt; 6     6  2001</span></a>
<a class="sourceLine" id="cb611-37" title="37"><span class="co">#&gt; # ... with 18 more rows</span></a>
<a class="sourceLine" id="cb611-38" title="38">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fill</span>(Year, <span class="dt">.direction =</span> <span class="st">&quot;downup&quot;</span>)</a>
<a class="sourceLine" id="cb611-39" title="39"><span class="co">#&gt; # A tibble: 24 x 2</span></a>
<a class="sourceLine" id="cb611-40" title="40"><span class="co">#&gt;   Month  Year</span></a>
<a class="sourceLine" id="cb611-41" title="41"><span class="co">#&gt;   &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb611-42" title="42"><span class="co">#&gt; 1     1  2000</span></a>
<a class="sourceLine" id="cb611-43" title="43"><span class="co">#&gt; 2     2  2000</span></a>
<a class="sourceLine" id="cb611-44" title="44"><span class="co">#&gt; 3     3  2000</span></a>
<a class="sourceLine" id="cb611-45" title="45"><span class="co">#&gt; 4     4  2000</span></a>
<a class="sourceLine" id="cb611-46" title="46"><span class="co">#&gt; 5     5  2000</span></a>
<a class="sourceLine" id="cb611-47" title="47"><span class="co">#&gt; 6     6  2000</span></a>
<a class="sourceLine" id="cb611-48" title="48"><span class="co">#&gt; # ... with 18 more rows</span></a></code></pre></div>
</div>
<div id="full_seq-create-the-full-sequence-of-values-in-a-vector" class="section level4">
<h4><span class="header-section-number">17.2.1.4</span> <code>full_seq()</code> create the full sequence of values in a vector</h4>
<p>This is useful if you want to fill in missing values that should have been observed but weren’t. For example, <code>full_seq(c(1, 2, 4, 6), 1)</code> will return 1:6.</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb612-1" title="1"><span class="co"># `period` specify step length</span></a>
<a class="sourceLine" id="cb612-2" title="2"><span class="kw">full_seq</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">13</span>), <span class="dt">period =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb612-3" title="3"><span class="co">#&gt; [1]  1  3  5  7  9 11 13</span></a>
<a class="sourceLine" id="cb612-4" title="4"></a>
<a class="sourceLine" id="cb612-5" title="5"><span class="co"># Works with dates, too!</span></a>
<a class="sourceLine" id="cb612-6" title="6">y &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw">ymd</span>(<span class="kw">c</span>(<span class="st">&quot;2020-01-01&quot;</span>, <span class="st">&quot;2020-01-03&quot;</span>))</a>
<a class="sourceLine" id="cb612-7" title="7"></a>
<a class="sourceLine" id="cb612-8" title="8"><span class="kw">full_seq</span>(y, <span class="dt">period =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb612-9" title="9"><span class="co">#&gt; [1] &quot;2020-01-01&quot; &quot;2020-01-02&quot; &quot;2020-01-03&quot;</span></a></code></pre></div>
</div>
<div id="expand-expand-data-frame-to-include-all-combinations-of-values" class="section level4">
<h4><span class="header-section-number">17.2.1.5</span> <code>expand()</code> expand data frame to include all combinations of values</h4>
<p><code>expand()</code> creates a data frame containing all conbinations of specified columns, often used in conjunction with <code>left_join()</code> to convert implicit missing values to explicit missing values, with <code>anti_join()</code> to figure out which combinations are missing.</p>
<p>To find all unique combinations of <code>x</code>, <code>y</code> and <code>z</code>, including those not found in the data, supply each variable as a separate argument. To find only the combinations that occur in the data, use nest: <code>expand(df, nesting(x, y, z))</code>.</p>
<p>You can combine the two forms. For example, <code>expand(df, nesting(school_id, student_id), date)</code> would produce a row for every student for each date.</p>
<p>For factors, the full set of levels (not just those that appear in the data) are used. For continuous variables, you may need to fill in values that don’t appear in the data: to do so use expressions like <code>year = 2010:2020</code>or <code>year = full_seq(year, 1)</code>.</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb613-1" title="1"><span class="co"># All possible combinations of vs &amp; cyl, even those that aren&#39;t</span></a>
<a class="sourceLine" id="cb613-2" title="2"><span class="co"># present in the data</span></a>
<a class="sourceLine" id="cb613-3" title="3"><span class="kw">expand</span>(mtcars, vs, cyl)</a>
<a class="sourceLine" id="cb613-4" title="4"><span class="co">#&gt; # A tibble: 6 x 2</span></a>
<a class="sourceLine" id="cb613-5" title="5"><span class="co">#&gt;      vs   cyl</span></a>
<a class="sourceLine" id="cb613-6" title="6"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb613-7" title="7"><span class="co">#&gt; 1     0     4</span></a>
<a class="sourceLine" id="cb613-8" title="8"><span class="co">#&gt; 2     0     6</span></a>
<a class="sourceLine" id="cb613-9" title="9"><span class="co">#&gt; 3     0     8</span></a>
<a class="sourceLine" id="cb613-10" title="10"><span class="co">#&gt; 4     1     4</span></a>
<a class="sourceLine" id="cb613-11" title="11"><span class="co">#&gt; 5     1     6</span></a>
<a class="sourceLine" id="cb613-12" title="12"><span class="co">#&gt; 6     1     8</span></a>
<a class="sourceLine" id="cb613-13" title="13"></a>
<a class="sourceLine" id="cb613-14" title="14"><span class="co"># Only combinations of vs and cyl that appear in the data</span></a>
<a class="sourceLine" id="cb613-15" title="15"><span class="kw">expand</span>(mtcars, <span class="kw">nesting</span>(vs, cyl))</a>
<a class="sourceLine" id="cb613-16" title="16"><span class="co">#&gt; # A tibble: 5 x 2</span></a>
<a class="sourceLine" id="cb613-17" title="17"><span class="co">#&gt;      vs   cyl</span></a>
<a class="sourceLine" id="cb613-18" title="18"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb613-19" title="19"><span class="co">#&gt; 1     0     4</span></a>
<a class="sourceLine" id="cb613-20" title="20"><span class="co">#&gt; 2     0     6</span></a>
<a class="sourceLine" id="cb613-21" title="21"><span class="co">#&gt; 3     0     8</span></a>
<a class="sourceLine" id="cb613-22" title="22"><span class="co">#&gt; 4     1     4</span></a>
<a class="sourceLine" id="cb613-23" title="23"><span class="co">#&gt; 5     1     6</span></a></code></pre></div>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb614-1" title="1"><span class="co"># Implicit missings ---------------------------------------------------------</span></a>
<a class="sourceLine" id="cb614-2" title="2">df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb614-3" title="3">  <span class="dt">year   =</span> <span class="kw">c</span>(<span class="dv">2010</span>, <span class="dv">2010</span>, <span class="dv">2010</span>, <span class="dv">2010</span>, <span class="dv">2012</span>, <span class="dv">2012</span>, <span class="dv">2012</span>),</a>
<a class="sourceLine" id="cb614-4" title="4">  <span class="dt">qtr    =</span> <span class="kw">c</span>(   <span class="dv">1</span>,    <span class="dv">2</span>,    <span class="dv">3</span>,    <span class="dv">4</span>,    <span class="dv">1</span>,    <span class="dv">2</span>,    <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb614-5" title="5">  <span class="dt">return =</span> <span class="kw">rnorm</span>(<span class="dv">7</span>)</a>
<a class="sourceLine" id="cb614-6" title="6">)</a>
<a class="sourceLine" id="cb614-7" title="7"></a>
<a class="sourceLine" id="cb614-8" title="8">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">expand</span>(year, qtr)</a>
<a class="sourceLine" id="cb614-9" title="9"><span class="co">#&gt; # A tibble: 8 x 2</span></a>
<a class="sourceLine" id="cb614-10" title="10"><span class="co">#&gt;    year   qtr</span></a>
<a class="sourceLine" id="cb614-11" title="11"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb614-12" title="12"><span class="co">#&gt; 1  2010     1</span></a>
<a class="sourceLine" id="cb614-13" title="13"><span class="co">#&gt; 2  2010     2</span></a>
<a class="sourceLine" id="cb614-14" title="14"><span class="co">#&gt; 3  2010     3</span></a>
<a class="sourceLine" id="cb614-15" title="15"><span class="co">#&gt; 4  2010     4</span></a>
<a class="sourceLine" id="cb614-16" title="16"><span class="co">#&gt; 5  2012     1</span></a>
<a class="sourceLine" id="cb614-17" title="17"><span class="co">#&gt; 6  2012     2</span></a>
<a class="sourceLine" id="cb614-18" title="18"><span class="co">#&gt; # ... with 2 more rows</span></a>
<a class="sourceLine" id="cb614-19" title="19"></a>
<a class="sourceLine" id="cb614-20" title="20">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">expand</span>(<span class="dt">year =</span> <span class="dv">2010</span><span class="op">:</span><span class="dv">2012</span>, qtr)</a>
<a class="sourceLine" id="cb614-21" title="21"><span class="co">#&gt; # A tibble: 12 x 2</span></a>
<a class="sourceLine" id="cb614-22" title="22"><span class="co">#&gt;    year   qtr</span></a>
<a class="sourceLine" id="cb614-23" title="23"><span class="co">#&gt;   &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb614-24" title="24"><span class="co">#&gt; 1  2010     1</span></a>
<a class="sourceLine" id="cb614-25" title="25"><span class="co">#&gt; 2  2010     2</span></a>
<a class="sourceLine" id="cb614-26" title="26"><span class="co">#&gt; 3  2010     3</span></a>
<a class="sourceLine" id="cb614-27" title="27"><span class="co">#&gt; 4  2010     4</span></a>
<a class="sourceLine" id="cb614-28" title="28"><span class="co">#&gt; 5  2011     1</span></a>
<a class="sourceLine" id="cb614-29" title="29"><span class="co">#&gt; 6  2011     2</span></a>
<a class="sourceLine" id="cb614-30" title="30"><span class="co">#&gt; # ... with 6 more rows</span></a>
<a class="sourceLine" id="cb614-31" title="31"></a>
<a class="sourceLine" id="cb614-32" title="32">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">expand</span>(<span class="dt">year =</span> <span class="kw">full_seq</span>(year, <span class="dv">1</span>), qtr)</a>
<a class="sourceLine" id="cb614-33" title="33"><span class="co">#&gt; # A tibble: 12 x 2</span></a>
<a class="sourceLine" id="cb614-34" title="34"><span class="co">#&gt;    year   qtr</span></a>
<a class="sourceLine" id="cb614-35" title="35"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb614-36" title="36"><span class="co">#&gt; 1  2010     1</span></a>
<a class="sourceLine" id="cb614-37" title="37"><span class="co">#&gt; 2  2010     2</span></a>
<a class="sourceLine" id="cb614-38" title="38"><span class="co">#&gt; 3  2010     3</span></a>
<a class="sourceLine" id="cb614-39" title="39"><span class="co">#&gt; 4  2010     4</span></a>
<a class="sourceLine" id="cb614-40" title="40"><span class="co">#&gt; 5  2011     1</span></a>
<a class="sourceLine" id="cb614-41" title="41"><span class="co">#&gt; 6  2011     2</span></a>
<a class="sourceLine" id="cb614-42" title="42"><span class="co">#&gt; # ... with 6 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb615-1" title="1"><span class="co"># Each person was given one of two treatments, repeated three times</span></a>
<a class="sourceLine" id="cb615-2" title="2"><span class="co"># But some of the replications haven&#39;t happened yet, so we have</span></a>
<a class="sourceLine" id="cb615-3" title="3"><span class="co"># incomplete data:</span></a>
<a class="sourceLine" id="cb615-4" title="4">experiment &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb615-5" title="5">  <span class="dt">name =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Alex&quot;</span>, <span class="st">&quot;Robert&quot;</span>, <span class="st">&quot;Sam&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb615-6" title="6">  <span class="dt">trt  =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb615-7" title="7">  <span class="dt">rep =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb615-8" title="8">  <span class="dt">measurement_1 =</span> <span class="kw">runif</span>(<span class="dv">6</span>),</a>
<a class="sourceLine" id="cb615-9" title="9">  <span class="dt">measurement_2 =</span> <span class="kw">runif</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb615-10" title="10">)</a>
<a class="sourceLine" id="cb615-11" title="11"></a>
<a class="sourceLine" id="cb615-12" title="12"><span class="co"># We can figure out the complete set of data with expand()</span></a>
<a class="sourceLine" id="cb615-13" title="13"><span class="co"># Each person only gets one treatment, so we nest name and trt together:</span></a>
<a class="sourceLine" id="cb615-14" title="14">all &lt;-<span class="st"> </span>experiment <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">expand</span>(<span class="kw">nesting</span>(name, trt), rep)</a>
<a class="sourceLine" id="cb615-15" title="15">all</a>
<a class="sourceLine" id="cb615-16" title="16"><span class="co">#&gt; # A tibble: 9 x 3</span></a>
<a class="sourceLine" id="cb615-17" title="17"><span class="co">#&gt;   name   trt     rep</span></a>
<a class="sourceLine" id="cb615-18" title="18"><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb615-19" title="19"><span class="co">#&gt; 1 Alex   a         1</span></a>
<a class="sourceLine" id="cb615-20" title="20"><span class="co">#&gt; 2 Alex   a         2</span></a>
<a class="sourceLine" id="cb615-21" title="21"><span class="co">#&gt; 3 Alex   a         3</span></a>
<a class="sourceLine" id="cb615-22" title="22"><span class="co">#&gt; 4 Robert b         1</span></a>
<a class="sourceLine" id="cb615-23" title="23"><span class="co">#&gt; 5 Robert b         2</span></a>
<a class="sourceLine" id="cb615-24" title="24"><span class="co">#&gt; 6 Robert b         3</span></a>
<a class="sourceLine" id="cb615-25" title="25"><span class="co">#&gt; # ... with 3 more rows</span></a>
<a class="sourceLine" id="cb615-26" title="26"></a>
<a class="sourceLine" id="cb615-27" title="27"><span class="co"># use left_join to convert implicit missing values to explicit missing values</span></a>
<a class="sourceLine" id="cb615-28" title="28">all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(experiment)</a>
<a class="sourceLine" id="cb615-29" title="29"><span class="co">#&gt; # A tibble: 9 x 5</span></a>
<a class="sourceLine" id="cb615-30" title="30"><span class="co">#&gt;   name   trt     rep measurement_1 measurement_2</span></a>
<a class="sourceLine" id="cb615-31" title="31"><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb615-32" title="32"><span class="co">#&gt; 1 Alex   a         1         0.614         0.379</span></a>
<a class="sourceLine" id="cb615-33" title="33"><span class="co">#&gt; 2 Alex   a         2         0.915         0.811</span></a>
<a class="sourceLine" id="cb615-34" title="34"><span class="co">#&gt; 3 Alex   a         3         0.838         0.475</span></a>
<a class="sourceLine" id="cb615-35" title="35"><span class="co">#&gt; 4 Robert b         1         0.855         0.838</span></a>
<a class="sourceLine" id="cb615-36" title="36"><span class="co">#&gt; 5 Robert b         2         0.501         0.739</span></a>
<a class="sourceLine" id="cb615-37" title="37"><span class="co">#&gt; 6 Robert b         3        NA            NA    </span></a>
<a class="sourceLine" id="cb615-38" title="38"><span class="co">#&gt; # ... with 3 more rows</span></a>
<a class="sourceLine" id="cb615-39" title="39"><span class="co"># can use anti_join to figure out which observations are missing</span></a>
<a class="sourceLine" id="cb615-40" title="40">all <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">anti_join</span>(experiment)</a>
<a class="sourceLine" id="cb615-41" title="41"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb615-42" title="42"><span class="co">#&gt;   name   trt     rep</span></a>
<a class="sourceLine" id="cb615-43" title="43"><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb615-44" title="44"><span class="co">#&gt; 1 Robert b         3</span></a>
<a class="sourceLine" id="cb615-45" title="45"><span class="co">#&gt; 2 Sam    a         2</span></a>
<a class="sourceLine" id="cb615-46" title="46"><span class="co">#&gt; 3 Sam    a         3</span></a>
<a class="sourceLine" id="cb615-47" title="47"></a>
<a class="sourceLine" id="cb615-48" title="48"></a>
<a class="sourceLine" id="cb615-49" title="49"><span class="co"># And use right_join to add in the appropriate missing values to the</span></a>
<a class="sourceLine" id="cb615-50" title="50"><span class="co"># original data</span></a>
<a class="sourceLine" id="cb615-51" title="51">experiment <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">right_join</span>(all)</a>
<a class="sourceLine" id="cb615-52" title="52"><span class="co">#&gt; # A tibble: 9 x 5</span></a>
<a class="sourceLine" id="cb615-53" title="53"><span class="co">#&gt;   name   trt     rep measurement_1 measurement_2</span></a>
<a class="sourceLine" id="cb615-54" title="54"><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb615-55" title="55"><span class="co">#&gt; 1 Alex   a         1         0.614         0.379</span></a>
<a class="sourceLine" id="cb615-56" title="56"><span class="co">#&gt; 2 Alex   a         2         0.915         0.811</span></a>
<a class="sourceLine" id="cb615-57" title="57"><span class="co">#&gt; 3 Alex   a         3         0.838         0.475</span></a>
<a class="sourceLine" id="cb615-58" title="58"><span class="co">#&gt; 4 Robert b         1         0.855         0.838</span></a>
<a class="sourceLine" id="cb615-59" title="59"><span class="co">#&gt; 5 Robert b         2         0.501         0.739</span></a>
<a class="sourceLine" id="cb615-60" title="60"><span class="co">#&gt; 6 Robert b         3        NA            NA    </span></a>
<a class="sourceLine" id="cb615-61" title="61"><span class="co">#&gt; # ... with 3 more rows</span></a></code></pre></div>
<p><code>complete()</code> is a short hand function around <code>expand() + left_join()</code>: firt create specified combinations and then left join original data to convert implicit missing values to explicit missing values:</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" title="1">experiment <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb616-2" title="2"><span class="st">  </span><span class="kw">complete</span>(rep, <span class="kw">nesting</span>(name, trt))</a>
<a class="sourceLine" id="cb616-3" title="3"><span class="co">#&gt; # A tibble: 9 x 5</span></a>
<a class="sourceLine" id="cb616-4" title="4"><span class="co">#&gt;     rep name   trt   measurement_1 measurement_2</span></a>
<a class="sourceLine" id="cb616-5" title="5"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb616-6" title="6"><span class="co">#&gt; 1     1 Alex   a             0.614         0.379</span></a>
<a class="sourceLine" id="cb616-7" title="7"><span class="co">#&gt; 2     1 Robert b             0.855         0.838</span></a>
<a class="sourceLine" id="cb616-8" title="8"><span class="co">#&gt; 3     1 Sam    a             0.158         0.278</span></a>
<a class="sourceLine" id="cb616-9" title="9"><span class="co">#&gt; 4     2 Alex   a             0.915         0.811</span></a>
<a class="sourceLine" id="cb616-10" title="10"><span class="co">#&gt; 5     2 Robert b             0.501         0.739</span></a>
<a class="sourceLine" id="cb616-11" title="11"><span class="co">#&gt; 6     2 Sam    a            NA            NA    </span></a>
<a class="sourceLine" id="cb616-12" title="12"><span class="co">#&gt; # ... with 3 more rows</span></a></code></pre></div>
</div>
<div id="expand_grid-create-a-tibble-from-all-combinations-of-inputs" class="section level4">
<h4><span class="header-section-number">17.2.1.6</span> <code>expand_grid</code>: create a tibble from all combinations of inputs</h4>
<p><code>expand_grid()</code> is analogus to a (atomic) vector version if <code>expand()</code>. Instead of taking in a data frame, <code>expand_grid()</code> use multiple name-value pairs to generate all combinations :</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb617-1" title="1"><span class="kw">expand_grid</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), <span class="dt">z =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</a>
<a class="sourceLine" id="cb617-2" title="2"><span class="co">#&gt; # A tibble: 18 x 3</span></a>
<a class="sourceLine" id="cb617-3" title="3"><span class="co">#&gt;       x     y z    </span></a>
<a class="sourceLine" id="cb617-4" title="4"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb617-5" title="5"><span class="co">#&gt; 1     3    10 a    </span></a>
<a class="sourceLine" id="cb617-6" title="6"><span class="co">#&gt; 2     3    10 b    </span></a>
<a class="sourceLine" id="cb617-7" title="7"><span class="co">#&gt; 3     3    10 c    </span></a>
<a class="sourceLine" id="cb617-8" title="8"><span class="co">#&gt; 4     3     5 a    </span></a>
<a class="sourceLine" id="cb617-9" title="9"><span class="co">#&gt; 5     3     5 b    </span></a>
<a class="sourceLine" id="cb617-10" title="10"><span class="co">#&gt; 6     3     5 c    </span></a>
<a class="sourceLine" id="cb617-11" title="11"><span class="co">#&gt; # ... with 12 more rows</span></a></code></pre></div>
<p><code>crossing()</code> is a wrapper around <code>expand_grid()</code> that deduplicates and sorts each input.</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb618-1" title="1"><span class="kw">crossing</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), <span class="dt">z =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</a>
<a class="sourceLine" id="cb618-2" title="2"><span class="co">#&gt; # A tibble: 18 x 3</span></a>
<a class="sourceLine" id="cb618-3" title="3"><span class="co">#&gt;       x     y z    </span></a>
<a class="sourceLine" id="cb618-4" title="4"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb618-5" title="5"><span class="co">#&gt; 1     1     5 a    </span></a>
<a class="sourceLine" id="cb618-6" title="6"><span class="co">#&gt; 2     1     5 b    </span></a>
<a class="sourceLine" id="cb618-7" title="7"><span class="co">#&gt; 3     1     5 c    </span></a>
<a class="sourceLine" id="cb618-8" title="8"><span class="co">#&gt; 4     1    10 a    </span></a>
<a class="sourceLine" id="cb618-9" title="9"><span class="co">#&gt; 5     1    10 b    </span></a>
<a class="sourceLine" id="cb618-10" title="10"><span class="co">#&gt; 6     1    10 c    </span></a>
<a class="sourceLine" id="cb618-11" title="11"><span class="co">#&gt; # ... with 12 more rows</span></a></code></pre></div>
</div>
</div>
<div id="janitor-2" class="section level3">
<h3><span class="header-section-number">17.2.2</span> janitor</h3>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb619-1" title="1"><span class="kw">library</span>(janitor)</a></code></pre></div>
<p><code>remove_empty(dat, which = c("rows", "cols"))</code></p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" title="1">(df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="ot">NA</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb620-2" title="2">             <span class="dt">y =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb620-3" title="3">             <span class="dt">z =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="ot">NA</span>, <span class="dv">5</span>)))</a>
<a class="sourceLine" id="cb620-4" title="4"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb620-5" title="5"><span class="co">#&gt;       x y         z</span></a>
<a class="sourceLine" id="cb620-6" title="6"><span class="co">#&gt;   &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb620-7" title="7"><span class="co">#&gt; 1     1 NA        4</span></a>
<a class="sourceLine" id="cb620-8" title="8"><span class="co">#&gt; 2    NA NA       NA</span></a>
<a class="sourceLine" id="cb620-9" title="9"><span class="co">#&gt; 3     3 NA        5</span></a>
<a class="sourceLine" id="cb620-10" title="10"></a>
<a class="sourceLine" id="cb620-11" title="11">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">remove_empty</span>()</a>
<a class="sourceLine" id="cb620-12" title="12"><span class="co">#&gt; # A tibble: 2 x 2</span></a>
<a class="sourceLine" id="cb620-13" title="13"><span class="co">#&gt;       x     z</span></a>
<a class="sourceLine" id="cb620-14" title="14"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb620-15" title="15"><span class="co">#&gt; 1     1     4</span></a>
<a class="sourceLine" id="cb620-16" title="16"><span class="co">#&gt; 2     3     5</span></a>
<a class="sourceLine" id="cb620-17" title="17">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">remove_empty</span>(<span class="st">&quot;rows&quot;</span>)</a>
<a class="sourceLine" id="cb620-18" title="18"><span class="co">#&gt; # A tibble: 2 x 3</span></a>
<a class="sourceLine" id="cb620-19" title="19"><span class="co">#&gt;       x y         z</span></a>
<a class="sourceLine" id="cb620-20" title="20"><span class="co">#&gt;   &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb620-21" title="21"><span class="co">#&gt; 1     1 NA        4</span></a>
<a class="sourceLine" id="cb620-22" title="22"><span class="co">#&gt; 2     3 NA        5</span></a>
<a class="sourceLine" id="cb620-23" title="23">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">remove_empty</span>(<span class="st">&quot;cols&quot;</span>)</a>
<a class="sourceLine" id="cb620-24" title="24"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb620-25" title="25"><span class="co">#&gt;       x     z</span></a>
<a class="sourceLine" id="cb620-26" title="26"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb620-27" title="27"><span class="co">#&gt; 1     1     4</span></a>
<a class="sourceLine" id="cb620-28" title="28"><span class="co">#&gt; 2    NA    NA</span></a>
<a class="sourceLine" id="cb620-29" title="29"><span class="co">#&gt; 3     3     5</span></a></code></pre></div>
</div>
<div id="visdat-1" class="section level3">
<h3><span class="header-section-number">17.2.3</span> visdat</h3>
<p><code>visdat::vis_missing()</code></p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb621-1" title="1"><span class="kw">library</span>(visdat)</a>
<a class="sourceLine" id="cb621-2" title="2"><span class="kw">vis_miss</span>(df)</a></code></pre></div>
<p><img src="missing-values_files/figure-html/unnamed-chunk-30-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>Advanced: <code>mice</code>, <code>Amelia</code></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="explore-missing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="imputation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/rfordatascience/edit/master/missing-values.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
