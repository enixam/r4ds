<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.3 select() | R for data science: tidyverse and beyond</title>
  <meta name="description" content="1.3 select() | R for data science: tidyverse and beyond" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="1.3 select() | R for data science: tidyverse and beyond" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="enixam/rfordatascience" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.3 select() | R for data science: tidyverse and beyond" />
  
  
  

<meta name="author" content="Maxine" />


<meta name="date" content="2020-05-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="arrange.html"/>
<link rel="next" href="summarize.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/jsoneditor-5.25.6/jsoneditor.min.css" rel="stylesheet" />
<script src="libs/jsoneditor-5.25.6/jsoneditor.min.js"></script>
<script src="libs/jsonedit-binding-3.0.0/jsonedit.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R4DS: tidyverse and beyond</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="part"><span><b>I R for data science</b></span></li>
<li class="chapter" data-level="1" data-path="dplyr-data-transformation.html"><a href="dplyr-data-transformation.html"><i class="fa fa-check"></i><b>1</b> dplyr: Data transformation</a><ul>
<li class="chapter" data-level="1.1" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>1.1</b> <code>filter()</code></a><ul>
<li class="chapter" data-level="1.1.1" data-path="filter.html"><a href="filter.html#operators"><i class="fa fa-check"></i><b>1.1.1</b> Operators</a></li>
<li class="chapter" data-level="1.1.2" data-path="filter.html"><a href="filter.html#missing-values"><i class="fa fa-check"></i><b>1.1.2</b> Missing values</a></li>
<li class="chapter" data-level="1.1.3" data-path="filter.html"><a href="filter.html#exercises"><i class="fa fa-check"></i><b>1.1.3</b> Exercises</a></li>
<li class="chapter" data-level="1.1.4" data-path="filter.html"><a href="filter.html#slice"><i class="fa fa-check"></i><b>1.1.4</b> <code>slice()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="arrange.html"><a href="arrange.html"><i class="fa fa-check"></i><b>1.2</b> <code>arrange()</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="arrange.html"><a href="arrange.html#exercises-1"><i class="fa fa-check"></i><b>1.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="select.html"><a href="select.html"><i class="fa fa-check"></i><b>1.3</b> <code>select()</code></a><ul>
<li class="chapter" data-level="1.3.1" data-path="select.html"><a href="select.html#练习"><i class="fa fa-check"></i><b>1.3.1</b> 练习</a></li>
<li class="chapter" data-level="1.3.2" data-path="select.html"><a href="select.html#常用创建函数"><i class="fa fa-check"></i><b>1.3.2</b> 常用创建函数</a></li>
<li class="chapter" data-level="1.3.3" data-path="select.html"><a href="select.html#exercises-2"><i class="fa fa-check"></i><b>1.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="summarize.html"><a href="summarize.html"><i class="fa fa-check"></i><b>1.4</b> <code>summarize()</code></a><ul>
<li class="chapter" data-level="1.4.1" data-path="summarize.html"><a href="summarize.html#missing-values-in-summarize"><i class="fa fa-check"></i><b>1.4.1</b> Missing values in <code>summarize()</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="summarize.html"><a href="summarize.html#计数函数"><i class="fa fa-check"></i><b>1.4.2</b> 计数函数</a></li>
<li class="chapter" data-level="1.4.3" data-path="summarize.html"><a href="summarize.html#逻辑值的计数和比例sumx-10-和-meany-0"><i class="fa fa-check"></i><b>1.4.3</b> 逻辑值的计数和比例:<code>sum(x &gt; 10) 和 mean(y == 0)</code></a></li>
<li class="chapter" data-level="1.4.4" data-path="summarize.html"><a href="summarize.html#其他常用的摘要函数"><i class="fa fa-check"></i><b>1.4.4</b> 其他常用的摘要函数</a></li>
<li class="chapter" data-level="1.4.5" data-path="summarize.html"><a href="summarize.html#多个分组变量的消耗"><i class="fa fa-check"></i><b>1.4.5</b> 多个分组变量的消耗</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="group-by-combined-with-other-functions.html"><a href="group-by-combined-with-other-functions.html"><i class="fa fa-check"></i><b>1.5</b> <code>group_by()</code> combined with other functions</a></li>
<li class="chapter" data-level="1.6" data-path="dplyr-exercise.html"><a href="dplyr-exercise.html"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tibble-modern-data-frames.html"><a href="tibble-modern-data-frames.html"><i class="fa fa-check"></i><b>2</b> tibble: Modern data frames</a><ul>
<li class="chapter" data-level="2.1" data-path="tibble-intro.html"><a href="tibble-intro.html"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html"><i class="fa fa-check"></i><b>2.2</b> Comparing tibble and data.frame</a><ul>
<li class="chapter" data-level="2.2.1" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html#creating"><i class="fa fa-check"></i><b>2.2.1</b> Creating</a></li>
<li class="chapter" data-level="2.2.2" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html#printing"><i class="fa fa-check"></i><b>2.2.2</b> Printing</a></li>
<li class="chapter" data-level="2.2.3" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html#subsetting"><i class="fa fa-check"></i><b>2.2.3</b> Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html"><i class="fa fa-check"></i><b>2.3</b> Comparing two data frames (tibbles)</a><ul>
<li class="chapter" data-level="2.3.1" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#dplyrall_equal"><i class="fa fa-check"></i><b>2.3.1</b> <code>dplyr::all_equal()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#janitorcompare_df_cols"><i class="fa fa-check"></i><b>2.3.2</b> <code>janitor::compare_df_cols()</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#vetralike"><i class="fa fa-check"></i><b>2.3.3</b> <code>vetr::alike()</code></a></li>
<li class="chapter" data-level="2.3.4" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#diffdfdiffdf"><i class="fa fa-check"></i><b>2.3.4</b> <code>diffdf::diffdf()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="tibble-exercise.html"><a href="tibble-exercise.html"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="readr-data-import.html"><a href="readr-data-import.html"><i class="fa fa-check"></i><b>3</b> readr: Data import</a><ul>
<li class="chapter" data-level="3.1" data-path="importing-data-in-base-r.html"><a href="importing-data-in-base-r.html"><i class="fa fa-check"></i><b>3.1</b> Importing data in base R</a></li>
<li class="chapter" data-level="3.2" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html"><i class="fa fa-check"></i><b>3.2</b> Importing data in <code>readr</code></a><ul>
<li class="chapter" data-level="3.2.1" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html#introduction"><i class="fa fa-check"></i><b>3.2.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2.2" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html#writing-data"><i class="fa fa-check"></i><b>3.2.2</b> Writing data</a></li>
<li class="chapter" data-level="3.2.3" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html#exercises-3"><i class="fa fa-check"></i><b>3.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html"><i class="fa fa-check"></i><b>3.3</b> Parsing a vector</a><ul>
<li class="chapter" data-level="3.3.1" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#numeric"><i class="fa fa-check"></i><b>3.3.1</b> Numeric</a></li>
<li class="chapter" data-level="3.3.2" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#character"><i class="fa fa-check"></i><b>3.3.2</b> Character</a></li>
<li class="chapter" data-level="3.3.3" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#factor"><i class="fa fa-check"></i><b>3.3.3</b> Factor</a></li>
<li class="chapter" data-level="3.3.4" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#date-and-time"><i class="fa fa-check"></i><b>3.3.4</b> Date and time</a></li>
<li class="chapter" data-level="3.3.5" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#exercises-4"><i class="fa fa-check"></i><b>3.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="parsing-a-file.html"><a href="parsing-a-file.html"><i class="fa fa-check"></i><b>3.4</b> Parsing a file</a><ul>
<li class="chapter" data-level="3.4.1" data-path="parsing-a-file.html"><a href="parsing-a-file.html#strategies"><i class="fa fa-check"></i><b>3.4.1</b> Strategies</a></li>
<li class="chapter" data-level="3.4.2" data-path="parsing-a-file.html"><a href="parsing-a-file.html#possible-challenges"><i class="fa fa-check"></i><b>3.4.2</b> Possible challenges</a></li>
<li class="chapter" data-level="3.4.3" data-path="parsing-a-file.html"><a href="parsing-a-file.html#other-tips"><i class="fa fa-check"></i><b>3.4.3</b> Other tips</a></li>
<li class="chapter" data-level="3.4.4" data-path="parsing-a-file.html"><a href="parsing-a-file.html#example-dealing-with-metadata"><i class="fa fa-check"></i><b>3.4.4</b> Example: Dealing with metadata</a></li>
<li class="chapter" data-level="3.4.5" data-path="parsing-a-file.html"><a href="parsing-a-file.html#example-multi-row-headers"><i class="fa fa-check"></i><b>3.4.5</b> Example: multi-row headers</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="readxl.html"><a href="readxl.html"><i class="fa fa-check"></i><b>3.5</b> <code>readxl</code></a><ul>
<li class="chapter" data-level="3.5.1" data-path="readxl.html"><a href="readxl.html#multi-row-headers-in-excel"><i class="fa fa-check"></i><b>3.5.1</b> Multi-row headers in Excel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lubridate-dates-and-times.html"><a href="lubridate-dates-and-times.html"><i class="fa fa-check"></i><b>4</b> lubridate: Dates and times</a><ul>
<li class="chapter" data-level="4.1" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html"><i class="fa fa-check"></i><b>4.1</b> Creating dates and times</a><ul>
<li class="chapter" data-level="4.1.1" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#from-strings"><i class="fa fa-check"></i><b>4.1.1</b> From strings</a></li>
<li class="chapter" data-level="4.1.2" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#from-individual-components"><i class="fa fa-check"></i><b>4.1.2</b> From individual components</a></li>
<li class="chapter" data-level="4.1.3" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#from-other-times"><i class="fa fa-check"></i><b>4.1.3</b> From other times</a></li>
<li class="chapter" data-level="4.1.4" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#exercises-5"><i class="fa fa-check"></i><b>4.1.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="date-time-components.html"><a href="date-time-components.html"><i class="fa fa-check"></i><b>4.2</b> Date-time components</a><ul>
<li class="chapter" data-level="4.2.1" data-path="date-time-components.html"><a href="date-time-components.html#accessing-components"><i class="fa fa-check"></i><b>4.2.1</b> Accessing components</a></li>
<li class="chapter" data-level="4.2.2" data-path="date-time-components.html"><a href="date-time-components.html#rounding"><i class="fa fa-check"></i><b>4.2.2</b> Rounding</a></li>
<li class="chapter" data-level="4.2.3" data-path="date-time-components.html"><a href="date-time-components.html#setting-components"><i class="fa fa-check"></i><b>4.2.3</b> Setting components</a></li>
<li class="chapter" data-level="4.2.4" data-path="date-time-components.html"><a href="date-time-components.html#exercises-6"><i class="fa fa-check"></i><b>4.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="time-span.html"><a href="time-span.html"><i class="fa fa-check"></i><b>4.3</b> Time span</a><ul>
<li class="chapter" data-level="4.3.1" data-path="time-span.html"><a href="time-span.html#时期-durations"><i class="fa fa-check"></i><b>4.3.1</b> 时期 Durations</a></li>
<li class="chapter" data-level="4.3.2" data-path="time-span.html"><a href="time-span.html#阶段-periods"><i class="fa fa-check"></i><b>4.3.2</b> 阶段 Periods</a></li>
<li class="chapter" data-level="4.3.3" data-path="time-span.html"><a href="time-span.html#区间-intervals"><i class="fa fa-check"></i><b>4.3.3</b> 区间 Intervals</a></li>
<li class="chapter" data-level="4.3.4" data-path="time-span.html"><a href="time-span.html#conclusion"><i class="fa fa-check"></i><b>4.3.4</b> Conclusion</a></li>
<li class="chapter" data-level="4.3.5" data-path="time-span.html"><a href="time-span.html#exercises-7"><i class="fa fa-check"></i><b>4.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="hms.html"><a href="hms.html"><i class="fa fa-check"></i><b>4.4</b> hms</a></li>
<li class="chapter" data-level="4.5" data-path="dint.html"><a href="dint.html"><i class="fa fa-check"></i><b>4.5</b> dint</a><ul>
<li class="chapter" data-level="4.5.1" data-path="dint.html"><a href="dint.html#creation"><i class="fa fa-check"></i><b>4.5.1</b> Creation</a></li>
<li class="chapter" data-level="4.5.2" data-path="dint.html"><a href="dint.html#arithmetic-and-sequences"><i class="fa fa-check"></i><b>4.5.2</b> Arithmetic and Sequences</a></li>
<li class="chapter" data-level="4.5.3" data-path="dint.html"><a href="dint.html#accessors"><i class="fa fa-check"></i><b>4.5.3</b> Accessors</a></li>
<li class="chapter" data-level="4.5.4" data-path="dint.html"><a href="dint.html#formatting"><i class="fa fa-check"></i><b>4.5.4</b> Formatting</a></li>
<li class="chapter" data-level="4.5.5" data-path="dint.html"><a href="dint.html#labelling-functions-in-ggplot2"><i class="fa fa-check"></i><b>4.5.5</b> Labelling functions in ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="forcats-factor.html"><a href="forcats-factor.html"><i class="fa fa-check"></i><b>5</b> forcats: factor</a><ul>
<li class="chapter" data-level="5.1" data-path="factor-basics.html"><a href="factor-basics.html"><i class="fa fa-check"></i><b>5.1</b> Factor basics</a></li>
<li class="chapter" data-level="5.2" data-path="sorting.html"><a href="sorting.html"><i class="fa fa-check"></i><b>5.2</b> Sorting</a><ul>
<li class="chapter" data-level="5.2.1" data-path="sorting.html"><a href="sorting.html#sorting-by-frequency-appearance-or-numeric-order"><i class="fa fa-check"></i><b>5.2.1</b> Sorting by frequency, appearance, or numeric order</a></li>
<li class="chapter" data-level="5.2.2" data-path="sorting.html"><a href="sorting.html#sorting-by-another-variable"><i class="fa fa-check"></i><b>5.2.2</b> Sorting by another variable</a></li>
<li class="chapter" data-level="5.2.3" data-path="sorting.html"><a href="sorting.html#sorting-manually"><i class="fa fa-check"></i><b>5.2.3</b> Sorting manually</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html"><i class="fa fa-check"></i><b>5.3</b> Chaninge number of levels</a><ul>
<li class="chapter" data-level="5.3.1" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#lumping-levels"><i class="fa fa-check"></i><b>5.3.1</b> Lumping levels</a></li>
<li class="chapter" data-level="5.3.2" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#expanding-levels"><i class="fa fa-check"></i><b>5.3.2</b> Expanding levels</a></li>
<li class="chapter" data-level="5.3.3" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#dropping-levels"><i class="fa fa-check"></i><b>5.3.3</b> Dropping levels</a></li>
<li class="chapter" data-level="5.3.4" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#transforming-na-levels"><i class="fa fa-check"></i><b>5.3.4</b> Transforming NA levels</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="recoding.html"><a href="recoding.html"><i class="fa fa-check"></i><b>5.4</b> Recoding</a><ul>
<li class="chapter" data-level="5.4.1" data-path="recoding.html"><a href="recoding.html#exercises-8"><i class="fa fa-check"></i><b>5.4.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidyr-tidy-data.html"><a href="tidyr-tidy-data.html"><i class="fa fa-check"></i><b>6</b> tidyr: Tidy data</a><ul>
<li class="chapter" data-level="6.1" data-path="tidyr-intro.html"><a href="tidyr-intro.html"><i class="fa fa-check"></i><b>6.1</b> Tidy data</a><ul>
<li class="chapter" data-level="6.1.1" data-path="tidyr-intro.html"><a href="tidyr-intro.html#exercises-9"><i class="fa fa-check"></i><b>6.1.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="pivoting.html"><a href="pivoting.html"><i class="fa fa-check"></i><b>6.2</b> Pivoting</a><ul>
<li class="chapter" data-level="6.2.1" data-path="pivoting.html"><a href="pivoting.html#pivot_longer"><i class="fa fa-check"></i><b>6.2.1</b> <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="pivoting.html"><a href="pivoting.html#pivot_wider"><i class="fa fa-check"></i><b>6.2.2</b> <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="6.2.3" data-path="pivoting.html"><a href="pivoting.html#combining-pivot_longer-and-pivot_wider"><i class="fa fa-check"></i><b>6.2.3</b> Combining <code>pivot_longer()</code> and <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="pivoting.html"><a href="pivoting.html#exercises-10"><i class="fa fa-check"></i><b>6.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="nesting.html"><a href="nesting.html"><i class="fa fa-check"></i><b>6.3</b> Nesting</a><ul>
<li class="chapter" data-level="6.3.1" data-path="nesting.html"><a href="nesting.html#example-managing-multiple-models"><i class="fa fa-check"></i><b>6.3.1</b> Example: Managing multiple models</a></li>
<li class="chapter" data-level="6.3.2" data-path="nesting.html"><a href="nesting.html#multi-choice"><i class="fa fa-check"></i><b>6.3.2</b> Example: Multicple hoice data</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="rectangling.html"><a href="rectangling.html"><i class="fa fa-check"></i><b>6.4</b> Rectangling</a><ul>
<li class="chapter" data-level="6.4.1" data-path="rectangling.html"><a href="rectangling.html#github-users"><i class="fa fa-check"></i><b>6.4.1</b> Github users</a></li>
<li class="chapter" data-level="6.4.2" data-path="rectangling.html"><a href="rectangling.html#github-repos"><i class="fa fa-check"></i><b>6.4.2</b> Github repos</a></li>
<li class="chapter" data-level="6.4.3" data-path="rectangling.html"><a href="rectangling.html#game-of-throne-characters"><i class="fa fa-check"></i><b>6.4.3</b> Game of Throne characters</a></li>
<li class="chapter" data-level="6.4.4" data-path="rectangling.html"><a href="rectangling.html#sharla-gelfands-discography"><i class="fa fa-check"></i><b>6.4.4</b> Sharla Gelfand’s discography</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="separate-and-untie.html"><a href="separate-and-untie.html"><i class="fa fa-check"></i><b>6.5</b> <code>separate()</code> and <code>untie()</code></a><ul>
<li class="chapter" data-level="6.5.1" data-path="separate-and-untie.html"><a href="separate-and-untie.html#separate"><i class="fa fa-check"></i><b>6.5.1</b> <code>separate()</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="separate-and-untie.html"><a href="separate-and-untie.html#unite"><i class="fa fa-check"></i><b>6.5.2</b> <code>unite()</code></a></li>
<li class="chapter" data-level="6.5.3" data-path="separate-and-untie.html"><a href="separate-and-untie.html#exercises-11"><i class="fa fa-check"></i><b>6.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="tidyr-missing.html"><a href="tidyr-missing.html"><i class="fa fa-check"></i><b>6.6</b> Handling missing values</a></li>
<li class="chapter" data-level="6.7" data-path="tidyr-case.html"><a href="tidyr-case.html"><i class="fa fa-check"></i><b>6.7</b> Case Study</a></li>
<li class="chapter" data-level="6.8" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html"><i class="fa fa-check"></i><b>6.8</b> Miscellaneous Functions</a><ul>
<li class="chapter" data-level="6.8.1" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html#chop-and-unchop"><i class="fa fa-check"></i><b>6.8.1</b> <code>chop()</code> and <code>unchop()</code></a></li>
<li class="chapter" data-level="6.8.2" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html#uncount"><i class="fa fa-check"></i><b>6.8.2</b> <code>uncount()</code></a></li>
<li class="chapter" data-level="6.8.3" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html#exercises-12"><i class="fa fa-check"></i><b>6.8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="non-tidy.html"><a href="non-tidy.html"><i class="fa fa-check"></i><b>6.9</b> None-tidy data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="purrr-functional-programming.html"><a href="purrr-functional-programming.html"><i class="fa fa-check"></i><b>7</b> purrr: Functional programming</a><ul>
<li class="chapter" data-level="7.1" data-path="map-family.html"><a href="map-family.html"><i class="fa fa-check"></i><b>7.1</b> <code>map()</code> family</a></li>
<li class="chapter" data-level="7.2" data-path="producing-atomic-vectors.html"><a href="producing-atomic-vectors.html"><i class="fa fa-check"></i><b>7.2</b> Producing atomic vectors</a><ul>
<li class="chapter" data-level="7.2.1" data-path="producing-atomic-vectors.html"><a href="producing-atomic-vectors.html#purrr-style-anonymous-functions"><i class="fa fa-check"></i><b>7.2.1</b> purrr-style anonymous functions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="predicate-functions.html"><a href="predicate-functions.html"><i class="fa fa-check"></i><b>7.3</b> Predicate functions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="predicate-functions.html"><a href="predicate-functions.html#basics"><i class="fa fa-check"></i><b>7.3.1</b> Basics</a></li>
<li class="chapter" data-level="7.3.2" data-path="predicate-functions.html"><a href="predicate-functions.html#map-variants"><i class="fa fa-check"></i><b>7.3.2</b> Map variants</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="group-functions.html"><a href="group-functions.html"><i class="fa fa-check"></i><b>7.4</b> group functions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="group-functions.html"><a href="group-functions.html#group_mapgroup_modify"><i class="fa fa-check"></i><b>7.4.1</b> group_map、group_modify</a></li>
<li class="chapter" data-level="7.4.2" data-path="group-functions.html"><a href="group-functions.html#group_nestgroup_splitgroup_keysgroup_data"><i class="fa fa-check"></i><b>7.4.2</b> group_nest、group_split、group_keys、group_data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="other-useful-tools.html"><a href="other-useful-tools.html"><i class="fa fa-check"></i><b>7.5</b> Other useful tools</a><ul>
<li class="chapter" data-level="7.5.1" data-path="other-useful-tools.html"><a href="other-useful-tools.html#imap"><i class="fa fa-check"></i><b>7.5.1</b> <code>imap()</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="other-useful-tools.html"><a href="other-useful-tools.html#adverbs"><i class="fa fa-check"></i><b>7.5.2</b> adverbs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>8</b> Relational data</a><ul>
<li class="chapter" data-level="8.1" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="mutating-joins.html"><a href="mutating-joins.html"><i class="fa fa-check"></i><b>8.2</b> Mutating joins</a></li>
<li class="chapter" data-level="8.3" data-path="filtering-join.html"><a href="filtering-join.html"><i class="fa fa-check"></i><b>8.3</b> Filtering join</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="broom-tidy-representation-of-models.html"><a href="broom-tidy-representation-of-models.html"><i class="fa fa-check"></i><b>9</b> broom: Tidy representation of models</a><ul>
<li class="chapter" data-level="9.1" data-path="viz-many-models.html"><a href="viz-many-models.html"><i class="fa fa-check"></i><b>9.1</b> Visualizing many models</a></li>
<li class="chapter" data-level="9.2" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>9.2</b> Examples</a><ul>
<li class="chapter" data-level="9.2.1" data-path="examples.html"><a href="examples.html#pca"><i class="fa fa-check"></i><b>9.2.1</b> PCA</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="broomextra.html"><a href="broomextra.html"><i class="fa fa-check"></i><b>9.3</b> broomExtra</a></li>
<li class="chapter" data-level="9.4" data-path="ggfortify.html"><a href="ggfortify.html"><i class="fa fa-check"></i><b>9.4</b> ggfortify</a></li>
</ul></li>
<li class="part"><span><b>II Importing</b></span></li>
<li class="chapter" data-level="10" data-path="vroom-fast-reading-of-delimited-files.html"><a href="vroom-fast-reading-of-delimited-files.html"><i class="fa fa-check"></i><b>10</b> vroom: Fast reading of delimited files</a></li>
<li class="chapter" data-level="11" data-path="reading-in-data-from-other-formats.html"><a href="reading-in-data-from-other-formats.html"><i class="fa fa-check"></i><b>11</b> Reading in data from other formats</a><ul>
<li class="chapter" data-level="11.1" data-path="pdf.html"><a href="pdf.html"><i class="fa fa-check"></i><b>11.1</b> PDF</a><ul>
<li class="chapter" data-level="11.1.1" data-path="pdf.html"><a href="pdf.html#scraping-pdf-data"><i class="fa fa-check"></i><b>11.1.1</b> Scraping pdf data</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="office-documents.html"><a href="office-documents.html"><i class="fa fa-check"></i><b>11.2</b> Office documents</a></li>
<li class="chapter" data-level="11.3" data-path="google-sheet.html"><a href="google-sheet.html"><i class="fa fa-check"></i><b>11.3</b> Google sheet</a></li>
<li class="chapter" data-level="11.4" data-path="images.html"><a href="images.html"><i class="fa fa-check"></i><b>11.4</b> Images</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="useful-apis.html"><a href="useful-apis.html"><i class="fa fa-check"></i><b>12</b> Useful APIs</a><ul>
<li class="chapter" data-level="12.1" data-path="wdi.html"><a href="wdi.html"><i class="fa fa-check"></i><b>12.1</b> WDI</a><ul>
<li class="chapter" data-level="12.1.1" data-path="wdi.html"><a href="wdi.html#wdisearch"><i class="fa fa-check"></i><b>12.1.1</b> <code>WDIsearch()</code></a></li>
<li class="chapter" data-level="12.1.2" data-path="wdi.html"><a href="wdi.html#wdi-1"><i class="fa fa-check"></i><b>12.1.2</b> <code>WDI</code></a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="ipumsr.html"><a href="ipumsr.html"><i class="fa fa-check"></i><b>12.2</b> ipumsr</a></li>
</ul></li>
<li class="part"><span><b>III Exploring and Wrangling</b></span></li>
<li class="chapter" data-level="13" data-path="data-summary.html"><a href="data-summary.html"><i class="fa fa-check"></i><b>13</b> Data summary</a><ul>
<li class="chapter" data-level="13.1" data-path="skimr.html"><a href="skimr.html"><i class="fa fa-check"></i><b>13.1</b> skimr</a></li>
<li class="chapter" data-level="13.2" data-path="visdat.html"><a href="visdat.html"><i class="fa fa-check"></i><b>13.2</b> visdat</a></li>
<li class="chapter" data-level="13.3" data-path="summarytools.html"><a href="summarytools.html"><i class="fa fa-check"></i><b>13.3</b> summarytools</a><ul>
<li class="chapter" data-level="13.3.1" data-path="summarytools.html"><a href="summarytools.html#freq"><i class="fa fa-check"></i><b>13.3.1</b> <code>freq</code></a></li>
<li class="chapter" data-level="13.3.2" data-path="summarytools.html"><a href="summarytools.html#descr"><i class="fa fa-check"></i><b>13.3.2</b> <code>descr()</code></a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="gt-and-gtsummary.html"><a href="gt-and-gtsummary.html"><i class="fa fa-check"></i><b>13.4</b> gt and gtsummary</a></li>
<li class="chapter" data-level="13.5" data-path="naniar.html"><a href="naniar.html"><i class="fa fa-check"></i><b>13.5</b> naniar</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="janitor.html"><a href="janitor.html"><i class="fa fa-check"></i><b>14</b> Janitor</a><ul>
<li class="chapter" data-level="14.1" data-path="janitor-cleaning.html"><a href="janitor-cleaning.html"><i class="fa fa-check"></i><b>14.1</b> cleaning</a><ul>
<li class="chapter" data-level="14.1.1" data-path="janitor-cleaning.html"><a href="janitor-cleaning.html#clean_names"><i class="fa fa-check"></i><b>14.1.1</b> <code>clean_names</code></a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="janitor-explore.html"><a href="janitor-explore.html"><i class="fa fa-check"></i><b>14.2</b> Exploring</a><ul>
<li class="chapter" data-level="14.2.1" data-path="janitor-explore.html"><a href="janitor-explore.html#tabyl"><i class="fa fa-check"></i><b>14.2.1</b> <code>tabyl</code></a></li>
<li class="chapter" data-level="14.2.2" data-path="janitor-explore.html"><a href="janitor-explore.html#get_dupes"><i class="fa fa-check"></i><b>14.2.2</b> <code>get_dupes</code></a></li>
<li class="chapter" data-level="14.2.3" data-path="janitor-explore.html"><a href="janitor-explore.html#remove_"><i class="fa fa-check"></i><b>14.2.3</b> <code>remove_</code></a></li>
<li class="chapter" data-level="14.2.4" data-path="janitor-explore.html"><a href="janitor-explore.html#round_half_up"><i class="fa fa-check"></i><b>14.2.4</b> <code>round_half_up</code></a></li>
<li class="chapter" data-level="14.2.5" data-path="janitor-explore.html"><a href="janitor-explore.html#excel_numeric_to_date"><i class="fa fa-check"></i><b>14.2.5</b> <code>excel_numeric_to_date</code></a></li>
<li class="chapter" data-level="14.2.6" data-path="janitor-explore.html"><a href="janitor-explore.html#top_levels"><i class="fa fa-check"></i><b>14.2.6</b> <code>top_levels</code></a></li>
<li class="chapter" data-level="14.2.7" data-path="janitor-explore.html"><a href="janitor-explore.html#row_to_names"><i class="fa fa-check"></i><b>14.2.7</b> <code>row_to_names</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Miscellaneous tools</b></span></li>
<li class="chapter" data-level="15" data-path="advanced-relational-data.html"><a href="advanced-relational-data.html"><i class="fa fa-check"></i><b>15</b> Advanced relational data</a><ul>
<li class="chapter" data-level="15.1" data-path="fuzzyjoin.html"><a href="fuzzyjoin.html"><i class="fa fa-check"></i><b>15.1</b> fuzzyjoin</a><ul>
<li class="chapter" data-level="15.1.1" data-path="fuzzyjoin.html"><a href="fuzzyjoin.html#inexact-matching"><i class="fa fa-check"></i><b>15.1.1</b> inexact matching</a></li>
<li class="chapter" data-level="15.1.2" data-path="fuzzyjoin.html"><a href="fuzzyjoin.html#stringdist"><i class="fa fa-check"></i><b>15.1.2</b> stringdist</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="funneljoin.html"><a href="funneljoin.html"><i class="fa fa-check"></i><b>15.2</b> funneljoin</a><ul>
<li class="chapter" data-level="15.2.1" data-path="funneljoin.html"><a href="funneljoin.html#after_join"><i class="fa fa-check"></i><b>15.2.1</b> <code>after_join()</code></a></li>
<li class="chapter" data-level="15.2.2" data-path="funneljoin.html"><a href="funneljoin.html#funnel-in-one-table"><i class="fa fa-check"></i><b>15.2.2</b> funnel in one table</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="dm.html"><a href="dm.html"><i class="fa fa-check"></i><b>15.3</b> dm</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="categorical-data-facotr.html"><a href="categorical-data-facotr.html"><i class="fa fa-check"></i><b>16</b> Categorical data (facotr)</a><ul>
<li class="chapter" data-level="16.1" data-path="frequency-and-contingency-table.html"><a href="frequency-and-contingency-table.html"><i class="fa fa-check"></i><b>16.1</b> Frequency and contingency table</a><ul>
<li class="chapter" data-level="16.1.1" data-path="frequency-and-contingency-table.html"><a href="frequency-and-contingency-table.html#frq-and-flat_table"><i class="fa fa-check"></i><b>16.1.1</b> <code>frq()</code> and <code>flat_table()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="coding.html"><a href="coding.html"><i class="fa fa-check"></i><b>16.2</b> Coding</a><ul>
<li class="chapter" data-level="16.2.1" data-path="coding.html"><a href="coding.html#rec"><i class="fa fa-check"></i><b>16.2.1</b> <code>rec()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="cutting.html"><a href="cutting.html"><i class="fa fa-check"></i><b>16.3</b> Cutting</a><ul>
<li class="chapter" data-level="16.3.1" data-path="cutting.html"><a href="cutting.html#chop"><i class="fa fa-check"></i><b>16.3.1</b> <code>chop()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="dealing-with-missing-values.html"><a href="dealing-with-missing-values.html"><i class="fa fa-check"></i><b>17</b> Dealing with missing values</a><ul>
<li class="chapter" data-level="17.1" data-path="explore-missing.html"><a href="explore-missing.html"><i class="fa fa-check"></i><b>17.1</b> Exploring</a><ul>
<li class="chapter" data-level="17.1.1" data-path="explore-missing.html"><a href="explore-missing.html#naniar-1"><i class="fa fa-check"></i><b>17.1.1</b> naniar</a></li>
<li class="chapter" data-level="17.1.2" data-path="explore-missing.html"><a href="explore-missing.html#replace-a-value-with-na"><i class="fa fa-check"></i><b>17.1.2</b> Replace a value with NA</a></li>
<li class="chapter" data-level="17.1.3" data-path="explore-missing.html"><a href="explore-missing.html#janitor-1"><i class="fa fa-check"></i><b>17.1.3</b> janitor</a></li>
<li class="chapter" data-level="17.1.4" data-path="explore-missing.html"><a href="explore-missing.html#sjmisc"><i class="fa fa-check"></i><b>17.1.4</b> sjmisc</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>17.2</b> Wrangling</a><ul>
<li class="chapter" data-level="17.2.1" data-path="wrangling.html"><a href="wrangling.html#tidyr"><i class="fa fa-check"></i><b>17.2.1</b> tidyr</a></li>
<li class="chapter" data-level="17.2.2" data-path="wrangling.html"><a href="wrangling.html#janitor-2"><i class="fa fa-check"></i><b>17.2.2</b> janitor</a></li>
<li class="chapter" data-level="17.2.3" data-path="wrangling.html"><a href="wrangling.html#visdat-1"><i class="fa fa-check"></i><b>17.2.3</b> visdat</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="imputation.html"><a href="imputation.html"><i class="fa fa-check"></i><b>17.3</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">written with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for data science: tidyverse and beyond</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="select" class="section level2">
<h2><span class="header-section-number">1.3</span> <code>select()</code></h2>
<p>如今，数据集有几百个甚至几千个变量已经司空见惯。这种情况下，如何找出真正感兴趣的变量经常是一个挑战。通过基于变量名的操作，<code>select()</code>函数可以让我们快速生成一个有用的变量子集。</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">glimpse</span>(flights)</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="co">#&gt; Rows: 336,776</span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="co">#&gt; Columns: 19</span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="co">#&gt; $ year           &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013...</span></a>
<a class="sourceLine" id="cb43-5" title="5"><span class="co">#&gt; $ month          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...</span></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="co">#&gt; $ day            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...</span></a>
<a class="sourceLine" id="cb43-7" title="7"><span class="co">#&gt; $ dep_time       &lt;int&gt; 517, 533, 542, 544, 554, 554, 555, 557, 557, 558, 55...</span></a>
<a class="sourceLine" id="cb43-8" title="8"><span class="co">#&gt; $ sched_dep_time &lt;int&gt; 515, 529, 540, 545, 600, 558, 600, 600, 600, 600, 60...</span></a>
<a class="sourceLine" id="cb43-9" title="9"><span class="co">#&gt; $ dep_delay      &lt;dbl&gt; 2, 4, 2, -1, -6, -4, -5, -3, -3, -2, -2, -2, -2, -2,...</span></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="co">#&gt; $ arr_time       &lt;int&gt; 830, 850, 923, 1004, 812, 740, 913, 709, 838, 753, 8...</span></a>
<a class="sourceLine" id="cb43-11" title="11"><span class="co">#&gt; $ sched_arr_time &lt;int&gt; 819, 830, 850, 1022, 837, 728, 854, 723, 846, 745, 8...</span></a>
<a class="sourceLine" id="cb43-12" title="12"><span class="co">#&gt; $ arr_delay      &lt;dbl&gt; 11, 20, 33, -18, -25, 12, 19, -14, -8, 8, -2, -3, 7,...</span></a>
<a class="sourceLine" id="cb43-13" title="13"><span class="co">#&gt; $ carrier        &lt;chr&gt; &quot;UA&quot;, &quot;UA&quot;, &quot;AA&quot;, &quot;B6&quot;, &quot;DL&quot;, &quot;UA&quot;, &quot;B6&quot;, &quot;EV&quot;, &quot;B6&quot;...</span></a>
<a class="sourceLine" id="cb43-14" title="14"><span class="co">#&gt; $ flight         &lt;int&gt; 1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, 301...</span></a>
<a class="sourceLine" id="cb43-15" title="15"><span class="co">#&gt; $ tailnum        &lt;chr&gt; &quot;N14228&quot;, &quot;N24211&quot;, &quot;N619AA&quot;, &quot;N804JB&quot;, &quot;N668DN&quot;, &quot;N...</span></a>
<a class="sourceLine" id="cb43-16" title="16"><span class="co">#&gt; $ origin         &lt;chr&gt; &quot;EWR&quot;, &quot;LGA&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;LGA&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;LG...</span></a>
<a class="sourceLine" id="cb43-17" title="17"><span class="co">#&gt; $ dest           &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;MIA&quot;, &quot;BQN&quot;, &quot;ATL&quot;, &quot;ORD&quot;, &quot;FLL&quot;, &quot;IA...</span></a>
<a class="sourceLine" id="cb43-18" title="18"><span class="co">#&gt; $ air_time       &lt;dbl&gt; 227, 227, 160, 183, 116, 150, 158, 53, 140, 138, 149...</span></a>
<a class="sourceLine" id="cb43-19" title="19"><span class="co">#&gt; $ distance       &lt;dbl&gt; 1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944, 73...</span></a>
<a class="sourceLine" id="cb43-20" title="20"><span class="co">#&gt; $ hour           &lt;dbl&gt; 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6...</span></a>
<a class="sourceLine" id="cb43-21" title="21"><span class="co">#&gt; $ minute         &lt;dbl&gt; 15, 29, 40, 45, 0, 58, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59...</span></a>
<a class="sourceLine" id="cb43-22" title="22"><span class="co">#&gt; $ time_hour      &lt;dttm&gt; 2013-01-01 05:00:00, 2013-01-01 05:00:00, 2013-01-0...</span></a>
<a class="sourceLine" id="cb43-23" title="23"><span class="co"># 选择 year,month,day 三个变量</span></a>
<a class="sourceLine" id="cb43-24" title="24">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, month, day)</a>
<a class="sourceLine" id="cb43-25" title="25"><span class="co">#&gt; # A tibble: 336,776 x 3</span></a>
<a class="sourceLine" id="cb43-26" title="26"><span class="co">#&gt;    year month   day</span></a>
<a class="sourceLine" id="cb43-27" title="27"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb43-28" title="28"><span class="co">#&gt; 1  2013     1     1</span></a>
<a class="sourceLine" id="cb43-29" title="29"><span class="co">#&gt; 2  2013     1     1</span></a>
<a class="sourceLine" id="cb43-30" title="30"><span class="co">#&gt; 3  2013     1     1</span></a>
<a class="sourceLine" id="cb43-31" title="31"><span class="co">#&gt; 4  2013     1     1</span></a>
<a class="sourceLine" id="cb43-32" title="32"><span class="co">#&gt; 5  2013     1     1</span></a>
<a class="sourceLine" id="cb43-33" title="33"><span class="co">#&gt; 6  2013     1     1</span></a>
<a class="sourceLine" id="cb43-34" title="34"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p>顺便说一句，如果把变量名变成字符串或者它在所有变量中的顺序也可以正常工作,如 <code>flights %&gt;% select("year", "month", "day")</code>和<code>flights %&gt;% select(1, 2, 3)</code>和上面代码会返回一样结果，但是这两种方法都不值得推荐。</p>
<p>关于 Non-standard evalution <code>{{ var }}</code> <code>!!enquo(var)</code> 或者 <code>.data[[var]]</code> 将会使 <code>select()</code>按照我们希望的那样工作。</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">my_select &lt;-<span class="st"> </span><span class="cf">function</span>(df, var) {</a>
<a class="sourceLine" id="cb44-2" title="2">  <span class="kw">select</span>(df, var)</a>
<a class="sourceLine" id="cb44-3" title="3">}</a>
<a class="sourceLine" id="cb44-4" title="4"></a>
<a class="sourceLine" id="cb44-5" title="5">df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb44-6" title="6"></a>
<a class="sourceLine" id="cb44-7" title="7"><span class="co"># wrong way</span></a>
<a class="sourceLine" id="cb44-8" title="8">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">my_select</span>(x)</a>
<a class="sourceLine" id="cb44-9" title="9"><span class="co">#&gt; Error: Selections can&#39;t have missing values.</span></a>
<a class="sourceLine" id="cb44-10" title="10"></a>
<a class="sourceLine" id="cb44-11" title="11"><span class="co"># solution 1</span></a>
<a class="sourceLine" id="cb44-12" title="12">my_select &lt;-<span class="st"> </span><span class="cf">function</span>(df, var) {</a>
<a class="sourceLine" id="cb44-13" title="13">  <span class="kw">select</span>(df, {{ var }})</a>
<a class="sourceLine" id="cb44-14" title="14">}</a>
<a class="sourceLine" id="cb44-15" title="15">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">my_select</span>(x)</a>
<a class="sourceLine" id="cb44-16" title="16"><span class="co">#&gt; # A tibble: 3 x 1</span></a>
<a class="sourceLine" id="cb44-17" title="17"><span class="co">#&gt;       x</span></a>
<a class="sourceLine" id="cb44-18" title="18"><span class="co">#&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb44-19" title="19"><span class="co">#&gt; 1     1</span></a>
<a class="sourceLine" id="cb44-20" title="20"><span class="co">#&gt; 2     2</span></a>
<a class="sourceLine" id="cb44-21" title="21"><span class="co">#&gt; 3     3</span></a>
<a class="sourceLine" id="cb44-22" title="22"></a>
<a class="sourceLine" id="cb44-23" title="23"><span class="co"># solution 2 </span></a>
<a class="sourceLine" id="cb44-24" title="24">my_select &lt;-<span class="st"> </span><span class="cf">function</span>(df, var) {</a>
<a class="sourceLine" id="cb44-25" title="25">  <span class="kw">select</span>(df, var)</a>
<a class="sourceLine" id="cb44-26" title="26">}</a>
<a class="sourceLine" id="cb44-27" title="27">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">my_select</span>(.data<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb44-28" title="28"><span class="co">#&gt; # A tibble: 3 x 0</span></a>
<a class="sourceLine" id="cb44-29" title="29"></a>
<a class="sourceLine" id="cb44-30" title="30"><span class="co"># solution 3</span></a>
<a class="sourceLine" id="cb44-31" title="31">my_select &lt;-<span class="st"> </span><span class="cf">function</span>(df, var) {</a>
<a class="sourceLine" id="cb44-32" title="32">  <span class="kw">select</span>(df, <span class="op">!!</span><span class="kw">enquo</span>(var))</a>
<a class="sourceLine" id="cb44-33" title="33">}</a>
<a class="sourceLine" id="cb44-34" title="34">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">my_select</span>(x)</a>
<a class="sourceLine" id="cb44-35" title="35"><span class="co">#&gt; # A tibble: 3 x 1</span></a>
<a class="sourceLine" id="cb44-36" title="36"><span class="co">#&gt;       x</span></a>
<a class="sourceLine" id="cb44-37" title="37"><span class="co">#&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb44-38" title="38"><span class="co">#&gt; 1     1</span></a>
<a class="sourceLine" id="cb44-39" title="39"><span class="co">#&gt; 2     2</span></a>
<a class="sourceLine" id="cb44-40" title="40"><span class="co">#&gt; 3     3</span></a></code></pre></div>
<p>这里的问题同样适用于 dplyr 中的其他采用惰性求值的函数。另外, <code>all_of(var)</code> 和 <code>.env$var</code> 可以处理相反的问题。</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">var &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</a>
<a class="sourceLine" id="cb45-2" title="2"></a>
<a class="sourceLine" id="cb45-3" title="3">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">all_of</span>(var))</a>
<a class="sourceLine" id="cb45-4" title="4"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb45-5" title="5"><span class="co">#&gt;       x     y</span></a>
<a class="sourceLine" id="cb45-6" title="6"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb45-7" title="7"><span class="co">#&gt; 1     1     4</span></a>
<a class="sourceLine" id="cb45-8" title="8"><span class="co">#&gt; 2     2     5</span></a>
<a class="sourceLine" id="cb45-9" title="9"><span class="co">#&gt; 3     3     6</span></a>
<a class="sourceLine" id="cb45-10" title="10">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(.env<span class="op">$</span>var)</a>
<a class="sourceLine" id="cb45-11" title="11"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb45-12" title="12"><span class="co">#&gt;       x     y</span></a>
<a class="sourceLine" id="cb45-13" title="13"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb45-14" title="14"><span class="co">#&gt; 1     1     4</span></a>
<a class="sourceLine" id="cb45-15" title="15"><span class="co">#&gt; 2     2     5</span></a>
<a class="sourceLine" id="cb45-16" title="16"><span class="co">#&gt; 3     3     6</span></a></code></pre></div>
<p><code>select()</code> 还可以重命名变量，但应该避免这样使用它，因为这样会丢掉所有未明确提及的变量。我们应该使用 <code>select()</code> 函数的变体 <code>rename()</code> 函数来重命名变量，它会把未提及的那些变量按照原名字放到生成的数据框里：</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="co"># 将 tail_num 重命名为 tailnum</span></a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw">rename</span>(flights, <span class="dt">tail_num =</span> tailnum)</a>
<a class="sourceLine" id="cb46-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 19</span></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb46-5" title="5"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></a>
<a class="sourceLine" id="cb46-7" title="7"><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></a>
<a class="sourceLine" id="cb46-8" title="8"><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></a>
<a class="sourceLine" id="cb46-9" title="9"><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></a>
<a class="sourceLine" id="cb46-10" title="10"><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></a>
<a class="sourceLine" id="cb46-11" title="11"><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></a>
<a class="sourceLine" id="cb46-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb46-13" title="13"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tail_num &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb46-14" title="14"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<p>其他常见的<code>select()</code>函数用法如下所示：</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co">## 选择“year”和“day”之间的所有变量，冒号</span></a>
<a class="sourceLine" id="cb47-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year<span class="op">:</span>day)</a>
<a class="sourceLine" id="cb47-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 3</span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="co">#&gt;    year month   day</span></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb47-6" title="6"><span class="co">#&gt; 1  2013     1     1</span></a>
<a class="sourceLine" id="cb47-7" title="7"><span class="co">#&gt; 2  2013     1     1</span></a>
<a class="sourceLine" id="cb47-8" title="8"><span class="co">#&gt; 3  2013     1     1</span></a>
<a class="sourceLine" id="cb47-9" title="9"><span class="co">#&gt; 4  2013     1     1</span></a>
<a class="sourceLine" id="cb47-10" title="10"><span class="co">#&gt; 5  2013     1     1</span></a>
<a class="sourceLine" id="cb47-11" title="11"><span class="co">#&gt; 6  2013     1     1</span></a>
<a class="sourceLine" id="cb47-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co">## 选择不在“year”和“day”之间的所有列，减号</span></a>
<a class="sourceLine" id="cb48-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>(year<span class="op">:</span>day))</a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 16</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="co">#&gt;   dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier</span></a>
<a class="sourceLine" id="cb48-5" title="5"><span class="co">#&gt;      &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="co">#&gt; 1      517            515         2      830            819        11 UA     </span></a>
<a class="sourceLine" id="cb48-7" title="7"><span class="co">#&gt; 2      533            529         4      850            830        20 UA     </span></a>
<a class="sourceLine" id="cb48-8" title="8"><span class="co">#&gt; 3      542            540         2      923            850        33 AA     </span></a>
<a class="sourceLine" id="cb48-9" title="9"><span class="co">#&gt; 4      544            545        -1     1004           1022       -18 B6     </span></a>
<a class="sourceLine" id="cb48-10" title="10"><span class="co">#&gt; 5      554            600        -6      812            837       -25 DL     </span></a>
<a class="sourceLine" id="cb48-11" title="11"><span class="co">#&gt; 6      554            558        -4      740            728        12 UA     </span></a>
<a class="sourceLine" id="cb48-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows, and 9 more variables: flight &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb48-13" title="13"><span class="co">#&gt; #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb48-14" title="14"><span class="co">#&gt; #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<p>还可以在<code>select()</code>函数中使用一些辅助函数：<br />
* <code>starts_with("abc")</code>：匹配以名字以“abc”开头的列</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;arr&quot;</span>))  <span class="co">## 所有以arr开头的列</span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="co">#&gt; # A tibble: 336,776 x 2</span></a>
<a class="sourceLine" id="cb49-3" title="3"><span class="co">#&gt;   arr_time arr_delay</span></a>
<a class="sourceLine" id="cb49-4" title="4"><span class="co">#&gt;      &lt;int&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb49-5" title="5"><span class="co">#&gt; 1      830        11</span></a>
<a class="sourceLine" id="cb49-6" title="6"><span class="co">#&gt; 2      850        20</span></a>
<a class="sourceLine" id="cb49-7" title="7"><span class="co">#&gt; 3      923        33</span></a>
<a class="sourceLine" id="cb49-8" title="8"><span class="co">#&gt; 4     1004       -18</span></a>
<a class="sourceLine" id="cb49-9" title="9"><span class="co">#&gt; 5      812       -25</span></a>
<a class="sourceLine" id="cb49-10" title="10"><span class="co">#&gt; 6      740        12</span></a>
<a class="sourceLine" id="cb49-11" title="11"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<ul>
<li><code>ends_with("xyz")</code>: 匹配名字以“xyz”结尾的列</li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co">## 所有以&quot;delay&quot;结尾的列</span></a>
<a class="sourceLine" id="cb50-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;delay&quot;</span>))</a>
<a class="sourceLine" id="cb50-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 2</span></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="co">#&gt;   dep_delay arr_delay</span></a>
<a class="sourceLine" id="cb50-5" title="5"><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb50-6" title="6"><span class="co">#&gt; 1         2        11</span></a>
<a class="sourceLine" id="cb50-7" title="7"><span class="co">#&gt; 2         4        20</span></a>
<a class="sourceLine" id="cb50-8" title="8"><span class="co">#&gt; 3         2        33</span></a>
<a class="sourceLine" id="cb50-9" title="9"><span class="co">#&gt; 4        -1       -18</span></a>
<a class="sourceLine" id="cb50-10" title="10"><span class="co">#&gt; 5        -6       -25</span></a>
<a class="sourceLine" id="cb50-11" title="11"><span class="co">#&gt; 6        -4        12</span></a>
<a class="sourceLine" id="cb50-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<ul>
<li><code>contains("ijk")</code>，匹配名字包含“ijk”的列</li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co">## 所有包含&quot;time&quot;的列</span></a>
<a class="sourceLine" id="cb51-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;time&quot;</span>))</a>
<a class="sourceLine" id="cb51-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 6</span></a>
<a class="sourceLine" id="cb51-4" title="4"><span class="co">#&gt;   dep_time sched_dep_time arr_time sched_arr_time air_time time_hour          </span></a>
<a class="sourceLine" id="cb51-5" title="5"><span class="co">#&gt;      &lt;int&gt;          &lt;int&gt;    &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt; &lt;dttm&gt;             </span></a>
<a class="sourceLine" id="cb51-6" title="6"><span class="co">#&gt; 1      517            515      830            819      227 2013-01-01 05:00:00</span></a>
<a class="sourceLine" id="cb51-7" title="7"><span class="co">#&gt; 2      533            529      850            830      227 2013-01-01 05:00:00</span></a>
<a class="sourceLine" id="cb51-8" title="8"><span class="co">#&gt; 3      542            540      923            850      160 2013-01-01 05:00:00</span></a>
<a class="sourceLine" id="cb51-9" title="9"><span class="co">#&gt; 4      544            545     1004           1022      183 2013-01-01 05:00:00</span></a>
<a class="sourceLine" id="cb51-10" title="10"><span class="co">#&gt; 5      554            600      812            837      116 2013-01-01 06:00:00</span></a>
<a class="sourceLine" id="cb51-11" title="11"><span class="co">#&gt; 6      554            558      740            728      150 2013-01-01 05:00:00</span></a>
<a class="sourceLine" id="cb51-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<ul>
<li><code>matches("(.)\\1")</code>：选择名字符合正则表达式要求的列，后面将具体讲述正则表达式<br />
</li>
<li><code>num_range("x",c(1,2,3))</code>，选择名字为“x1”、“x2”、“x3”的列</li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x1 =</span> <span class="dv">1</span>,<span class="dt">x2 =</span> <span class="dv">2</span>,<span class="dt">x3 =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb52-2" title="2">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">num_range</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb52-3" title="3"><span class="co">#&gt; # A tibble: 1 x 0</span></a></code></pre></div>
<ul>
<li><code>one_of(character_1,···,character_n)</code>:如果某个列的名字出现在序列里，则选出它</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">one_of</span>(<span class="st">&quot;arr_delay&quot;</span>, <span class="st">&quot;dep_delay&quot;</span>, <span class="st">&quot;xyz&quot;</span>))</a>
<a class="sourceLine" id="cb53-2" title="2"><span class="co">#&gt; # A tibble: 336,776 x 2</span></a>
<a class="sourceLine" id="cb53-3" title="3"><span class="co">#&gt;   arr_delay dep_delay</span></a>
<a class="sourceLine" id="cb53-4" title="4"><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb53-5" title="5"><span class="co">#&gt; 1        11         2</span></a>
<a class="sourceLine" id="cb53-6" title="6"><span class="co">#&gt; 2        20         4</span></a>
<a class="sourceLine" id="cb53-7" title="7"><span class="co">#&gt; 3        33         2</span></a>
<a class="sourceLine" id="cb53-8" title="8"><span class="co">#&gt; 4       -18        -1</span></a>
<a class="sourceLine" id="cb53-9" title="9"><span class="co">#&gt; 5       -25        -6</span></a>
<a class="sourceLine" id="cb53-10" title="10"><span class="co">#&gt; 6        12        -4</span></a>
<a class="sourceLine" id="cb53-11" title="11"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<ul>
<li><code>everything()</code>：匹配所有(剩余)变量，当想要将几个变量移到数据集开头时，这种方法很有用</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co">## 将time_hour和air_time两个变量移到flights数据的开头</span></a>
<a class="sourceLine" id="cb54-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(time_hour,air_time, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb54-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 19</span></a>
<a class="sourceLine" id="cb54-4" title="4"><span class="co">#&gt;   time_hour           air_time  year month   day dep_time sched_dep_time</span></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="co">#&gt;   &lt;dttm&gt;                 &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb54-6" title="6"><span class="co">#&gt; 1 2013-01-01 05:00:00      227  2013     1     1      517            515</span></a>
<a class="sourceLine" id="cb54-7" title="7"><span class="co">#&gt; 2 2013-01-01 05:00:00      227  2013     1     1      533            529</span></a>
<a class="sourceLine" id="cb54-8" title="8"><span class="co">#&gt; 3 2013-01-01 05:00:00      160  2013     1     1      542            540</span></a>
<a class="sourceLine" id="cb54-9" title="9"><span class="co">#&gt; 4 2013-01-01 05:00:00      183  2013     1     1      544            545</span></a>
<a class="sourceLine" id="cb54-10" title="10"><span class="co">#&gt; 5 2013-01-01 06:00:00      116  2013     1     1      554            600</span></a>
<a class="sourceLine" id="cb54-11" title="11"><span class="co">#&gt; 6 2013-01-01 05:00:00      150  2013     1     1      554            558</span></a>
<a class="sourceLine" id="cb54-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows, and 12 more variables: dep_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb54-13" title="13"><span class="co">#&gt; #   arr_time &lt;int&gt;, sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb54-14" title="14"><span class="co">#&gt; #   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, distance &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb54-15" title="15"><span class="co">#&gt; #   hour &lt;dbl&gt;, minute &lt;dbl&gt;</span></a></code></pre></div>
<ul>
<li><code>last_col(offset = n)</code>：选择倒数第n列，不设置offset时，默认选择最后一列</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">last_col</span>())</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="co">#&gt; # A tibble: 336,776 x 1</span></a>
<a class="sourceLine" id="cb55-3" title="3"><span class="co">#&gt;   time_hour          </span></a>
<a class="sourceLine" id="cb55-4" title="4"><span class="co">#&gt;   &lt;dttm&gt;             </span></a>
<a class="sourceLine" id="cb55-5" title="5"><span class="co">#&gt; 1 2013-01-01 05:00:00</span></a>
<a class="sourceLine" id="cb55-6" title="6"><span class="co">#&gt; 2 2013-01-01 05:00:00</span></a>
<a class="sourceLine" id="cb55-7" title="7"><span class="co">#&gt; 3 2013-01-01 05:00:00</span></a>
<a class="sourceLine" id="cb55-8" title="8"><span class="co">#&gt; 4 2013-01-01 05:00:00</span></a>
<a class="sourceLine" id="cb55-9" title="9"><span class="co">#&gt; 5 2013-01-01 06:00:00</span></a>
<a class="sourceLine" id="cb55-10" title="10"><span class="co">#&gt; 6 2013-01-01 05:00:00</span></a>
<a class="sourceLine" id="cb55-11" title="11"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p>利用这些帮助函数，我们可以为选择列设置任意数目的条件，<code>select()</code>中以逗号分隔的列表示<strong>“或”</strong> 关系，如：</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co">## 找出以“arr”开头或者以“time”结尾的列</span></a>
<a class="sourceLine" id="cb56-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;arr&quot;</span>), <span class="kw">ends_with</span>(<span class="st">&quot;time&quot;</span>))</a>
<a class="sourceLine" id="cb56-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 6</span></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="co">#&gt;   arr_time arr_delay dep_time sched_dep_time sched_arr_time air_time</span></a>
<a class="sourceLine" id="cb56-5" title="5"><span class="co">#&gt;      &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb56-6" title="6"><span class="co">#&gt; 1      830        11      517            515            819      227</span></a>
<a class="sourceLine" id="cb56-7" title="7"><span class="co">#&gt; 2      850        20      533            529            830      227</span></a>
<a class="sourceLine" id="cb56-8" title="8"><span class="co">#&gt; 3      923        33      542            540            850      160</span></a>
<a class="sourceLine" id="cb56-9" title="9"><span class="co">#&gt; 4     1004       -18      544            545           1022      183</span></a>
<a class="sourceLine" id="cb56-10" title="10"><span class="co">#&gt; 5      812       -25      554            600            837      116</span></a>
<a class="sourceLine" id="cb56-11" title="11"><span class="co">#&gt; 6      740        12      554            558            728      150</span></a>
<a class="sourceLine" id="cb56-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p><strong>注意</strong>:<br />
所有帮助函数都忽略大小写:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;DELAY&quot;</span>))</a>
<a class="sourceLine" id="cb57-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 2</span></a>
<a class="sourceLine" id="cb57-4" title="4"><span class="co">#&gt;   dep_delay arr_delay</span></a>
<a class="sourceLine" id="cb57-5" title="5"><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="co">#&gt; 1         2        11</span></a>
<a class="sourceLine" id="cb57-7" title="7"><span class="co">#&gt; 2         4        20</span></a>
<a class="sourceLine" id="cb57-8" title="8"><span class="co">#&gt; 3         2        33</span></a>
<a class="sourceLine" id="cb57-9" title="9"><span class="co">#&gt; 4        -1       -18</span></a>
<a class="sourceLine" id="cb57-10" title="10"><span class="co">#&gt; 5        -6       -25</span></a>
<a class="sourceLine" id="cb57-11" title="11"><span class="co">#&gt; 6        -4        12</span></a>
<a class="sourceLine" id="cb57-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p>如果要区分大小写，可以设置任意帮助函数的参数<code>ignore.case = FALSE</code></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;DELAY&quot;</span>, <span class="dt">ignore.case =</span> F))   <span class="co">## 将不会选择出任何列</span></a>
<a class="sourceLine" id="cb58-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 0</span></a></code></pre></div>
<div id="练习" class="section level3">
<h3><span class="header-section-number">1.3.1</span> 练习</h3>

<div class="exercise">
<span id="exr:unnamed-chunk-67" class="exercise"><strong>Exercise 1.7  </strong></span>从 <code>flights</code> 中选择 <code>dep_time</code>、<code>dep_delay</code>、<code>arr_time</code>、<code>arr_delay</code>，找出尽可能多的方法
</div>

<p>先查看这些变量的位置：</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">glimpse</span>(flights)</a>
<a class="sourceLine" id="cb59-2" title="2"><span class="co">#&gt; Rows: 336,776</span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="co">#&gt; Columns: 19</span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="co">#&gt; $ year           &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013...</span></a>
<a class="sourceLine" id="cb59-5" title="5"><span class="co">#&gt; $ month          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...</span></a>
<a class="sourceLine" id="cb59-6" title="6"><span class="co">#&gt; $ day            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...</span></a>
<a class="sourceLine" id="cb59-7" title="7"><span class="co">#&gt; $ dep_time       &lt;int&gt; 517, 533, 542, 544, 554, 554, 555, 557, 557, 558, 55...</span></a>
<a class="sourceLine" id="cb59-8" title="8"><span class="co">#&gt; $ sched_dep_time &lt;int&gt; 515, 529, 540, 545, 600, 558, 600, 600, 600, 600, 60...</span></a>
<a class="sourceLine" id="cb59-9" title="9"><span class="co">#&gt; $ dep_delay      &lt;dbl&gt; 2, 4, 2, -1, -6, -4, -5, -3, -3, -2, -2, -2, -2, -2,...</span></a>
<a class="sourceLine" id="cb59-10" title="10"><span class="co">#&gt; $ arr_time       &lt;int&gt; 830, 850, 923, 1004, 812, 740, 913, 709, 838, 753, 8...</span></a>
<a class="sourceLine" id="cb59-11" title="11"><span class="co">#&gt; $ sched_arr_time &lt;int&gt; 819, 830, 850, 1022, 837, 728, 854, 723, 846, 745, 8...</span></a>
<a class="sourceLine" id="cb59-12" title="12"><span class="co">#&gt; $ arr_delay      &lt;dbl&gt; 11, 20, 33, -18, -25, 12, 19, -14, -8, 8, -2, -3, 7,...</span></a>
<a class="sourceLine" id="cb59-13" title="13"><span class="co">#&gt; $ carrier        &lt;chr&gt; &quot;UA&quot;, &quot;UA&quot;, &quot;AA&quot;, &quot;B6&quot;, &quot;DL&quot;, &quot;UA&quot;, &quot;B6&quot;, &quot;EV&quot;, &quot;B6&quot;...</span></a>
<a class="sourceLine" id="cb59-14" title="14"><span class="co">#&gt; $ flight         &lt;int&gt; 1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, 301...</span></a>
<a class="sourceLine" id="cb59-15" title="15"><span class="co">#&gt; $ tailnum        &lt;chr&gt; &quot;N14228&quot;, &quot;N24211&quot;, &quot;N619AA&quot;, &quot;N804JB&quot;, &quot;N668DN&quot;, &quot;N...</span></a>
<a class="sourceLine" id="cb59-16" title="16"><span class="co">#&gt; $ origin         &lt;chr&gt; &quot;EWR&quot;, &quot;LGA&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;LGA&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;LG...</span></a>
<a class="sourceLine" id="cb59-17" title="17"><span class="co">#&gt; $ dest           &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;MIA&quot;, &quot;BQN&quot;, &quot;ATL&quot;, &quot;ORD&quot;, &quot;FLL&quot;, &quot;IA...</span></a>
<a class="sourceLine" id="cb59-18" title="18"><span class="co">#&gt; $ air_time       &lt;dbl&gt; 227, 227, 160, 183, 116, 150, 158, 53, 140, 138, 149...</span></a>
<a class="sourceLine" id="cb59-19" title="19"><span class="co">#&gt; $ distance       &lt;dbl&gt; 1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944, 73...</span></a>
<a class="sourceLine" id="cb59-20" title="20"><span class="co">#&gt; $ hour           &lt;dbl&gt; 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6...</span></a>
<a class="sourceLine" id="cb59-21" title="21"><span class="co">#&gt; $ minute         &lt;dbl&gt; 15, 29, 40, 45, 0, 58, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59...</span></a>
<a class="sourceLine" id="cb59-22" title="22"><span class="co">#&gt; $ time_hour      &lt;dttm&gt; 2013-01-01 05:00:00, 2013-01-01 05:00:00, 2013-01-0...</span></a></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co"># 常规方法</span></a>
<a class="sourceLine" id="cb60-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(dep_time, dep_delay, arr_time, arr_delay)</a>
<a class="sourceLine" id="cb60-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 4</span></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="co">#&gt;   dep_time dep_delay arr_time arr_delay</span></a>
<a class="sourceLine" id="cb60-5" title="5"><span class="co">#&gt;      &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb60-6" title="6"><span class="co">#&gt; 1      517         2      830        11</span></a>
<a class="sourceLine" id="cb60-7" title="7"><span class="co">#&gt; 2      533         4      850        20</span></a>
<a class="sourceLine" id="cb60-8" title="8"><span class="co">#&gt; 3      542         2      923        33</span></a>
<a class="sourceLine" id="cb60-9" title="9"><span class="co">#&gt; 4      544        -1     1004       -18</span></a>
<a class="sourceLine" id="cb60-10" title="10"><span class="co">#&gt; 5      554        -6      812       -25</span></a>
<a class="sourceLine" id="cb60-11" title="11"><span class="co">#&gt; 6      554        -4      740        12</span></a>
<a class="sourceLine" id="cb60-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># one_of()</span></a>
<a class="sourceLine" id="cb61-2" title="2">vars =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dep_time&quot;</span>, <span class="st">&quot;dep_delay&quot;</span>, <span class="st">&quot;arr_time&quot;</span>, <span class="st">&quot;arr_delay&quot;</span>)</a>
<a class="sourceLine" id="cb61-3" title="3">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">one_of</span>(vars))</a>
<a class="sourceLine" id="cb61-4" title="4"><span class="co">#&gt; # A tibble: 336,776 x 4</span></a>
<a class="sourceLine" id="cb61-5" title="5"><span class="co">#&gt;   dep_time dep_delay arr_time arr_delay</span></a>
<a class="sourceLine" id="cb61-6" title="6"><span class="co">#&gt;      &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb61-7" title="7"><span class="co">#&gt; 1      517         2      830        11</span></a>
<a class="sourceLine" id="cb61-8" title="8"><span class="co">#&gt; 2      533         4      850        20</span></a>
<a class="sourceLine" id="cb61-9" title="9"><span class="co">#&gt; 3      542         2      923        33</span></a>
<a class="sourceLine" id="cb61-10" title="10"><span class="co">#&gt; 4      544        -1     1004       -18</span></a>
<a class="sourceLine" id="cb61-11" title="11"><span class="co">#&gt; 5      554        -6      812       -25</span></a>
<a class="sourceLine" id="cb61-12" title="12"><span class="co">#&gt; 6      554        -4      740        12</span></a>
<a class="sourceLine" id="cb61-13" title="13"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># 多个条件</span></a>
<a class="sourceLine" id="cb62-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;arr_&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;dep_&quot;</span>))</a>
<a class="sourceLine" id="cb62-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 4</span></a>
<a class="sourceLine" id="cb62-4" title="4"><span class="co">#&gt;   arr_time arr_delay dep_time dep_delay</span></a>
<a class="sourceLine" id="cb62-5" title="5"><span class="co">#&gt;      &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb62-6" title="6"><span class="co">#&gt; 1      830        11      517         2</span></a>
<a class="sourceLine" id="cb62-7" title="7"><span class="co">#&gt; 2      850        20      533         4</span></a>
<a class="sourceLine" id="cb62-8" title="8"><span class="co">#&gt; 3      923        33      542         2</span></a>
<a class="sourceLine" id="cb62-9" title="9"><span class="co">#&gt; 4     1004       -18      544        -1</span></a>
<a class="sourceLine" id="cb62-10" title="10"><span class="co">#&gt; 5      812       -25      554        -6</span></a>
<a class="sourceLine" id="cb62-11" title="11"><span class="co">#&gt; 6      740        12      554        -4</span></a>
<a class="sourceLine" id="cb62-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>

<div class="exercise">
<span id="exr:unnamed-chunk-72" class="exercise"><strong>Exercise 1.8  </strong></span>如果在<code>select()</code>中多次计入一个变量名，会发生什么情况？
</div>

<p><code>select()</code>函数将会忽略重复出现的变量，只选出一列，同时也不会报错：</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, month, day, year, month, day)</a>
<a class="sourceLine" id="cb63-2" title="2"><span class="co">#&gt; # A tibble: 336,776 x 3</span></a>
<a class="sourceLine" id="cb63-3" title="3"><span class="co">#&gt;    year month   day</span></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb63-5" title="5"><span class="co">#&gt; 1  2013     1     1</span></a>
<a class="sourceLine" id="cb63-6" title="6"><span class="co">#&gt; 2  2013     1     1</span></a>
<a class="sourceLine" id="cb63-7" title="7"><span class="co">#&gt; 3  2013     1     1</span></a>
<a class="sourceLine" id="cb63-8" title="8"><span class="co">#&gt; 4  2013     1     1</span></a>
<a class="sourceLine" id="cb63-9" title="9"><span class="co">#&gt; 5  2013     1     1</span></a>
<a class="sourceLine" id="cb63-10" title="10"><span class="co">#&gt; 6  2013     1     1</span></a>
<a class="sourceLine" id="cb63-11" title="11"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p>##<code>mutate()</code></p>
<p>除了选择现有的列，经常还需要添加新列。新列是现有列的函数，这就 <code>mutate()</code> 函数的作用。<br />
<code>mutate()</code> 总是将新列添加在最后,格式为 <code>新列名= 表达式</code>。为了便于观察它的效果，我们需要先创建一个更狭窄的数据集，以便能看到新变量。<br />
例如，我们希望创建两个新列<code>gain</code>和<code>hours</code>，分别表示飞机在飞行过程中弥补的延误时间 (<code>gain = arr_dealy - dep_delay</code>)，然后把飞行时间换算成小时 <code>hours = air_time / 60</code></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">(flights_gain &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="st">   </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;delay&quot;</span>),air_time) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-3" title="3"><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">gain =</span> arr_delay <span class="op">-</span><span class="st"> </span>dep_delay,</a>
<a class="sourceLine" id="cb64-4" title="4">            <span class="dt">hours =</span> air_time <span class="op">/</span><span class="st"> </span><span class="dv">60</span>))</a>
<a class="sourceLine" id="cb64-5" title="5"><span class="co">#&gt; # A tibble: 336,776 x 5</span></a>
<a class="sourceLine" id="cb64-6" title="6"><span class="co">#&gt;   dep_delay arr_delay air_time  gain hours</span></a>
<a class="sourceLine" id="cb64-7" title="7"><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb64-8" title="8"><span class="co">#&gt; 1         2        11      227     9  3.78</span></a>
<a class="sourceLine" id="cb64-9" title="9"><span class="co">#&gt; 2         4        20      227    16  3.78</span></a>
<a class="sourceLine" id="cb64-10" title="10"><span class="co">#&gt; 3         2        33      160    31  2.67</span></a>
<a class="sourceLine" id="cb64-11" title="11"><span class="co">#&gt; 4        -1       -18      183   -17  3.05</span></a>
<a class="sourceLine" id="cb64-12" title="12"><span class="co">#&gt; 5        -6       -25      116   -19  1.93</span></a>
<a class="sourceLine" id="cb64-13" title="13"><span class="co">#&gt; 6        -4        12      150    16  2.5 </span></a>
<a class="sourceLine" id="cb64-14" title="14"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p>一旦新列被创建，就可以立即使用。例如，可能想知道对gain做时间上的平均：</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">flights_gain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">gain_per_hour =</span> gain <span class="op">/</span><span class="st"> </span>hours)</a>
<a class="sourceLine" id="cb65-2" title="2"><span class="co">#&gt; # A tibble: 336,776 x 6</span></a>
<a class="sourceLine" id="cb65-3" title="3"><span class="co">#&gt;   dep_delay arr_delay air_time  gain hours gain_per_hour</span></a>
<a class="sourceLine" id="cb65-4" title="4"><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb65-5" title="5"><span class="co">#&gt; 1         2        11      227     9  3.78          2.38</span></a>
<a class="sourceLine" id="cb65-6" title="6"><span class="co">#&gt; 2         4        20      227    16  3.78          4.23</span></a>
<a class="sourceLine" id="cb65-7" title="7"><span class="co">#&gt; 3         2        33      160    31  2.67         11.6 </span></a>
<a class="sourceLine" id="cb65-8" title="8"><span class="co">#&gt; 4        -1       -18      183   -17  3.05         -5.57</span></a>
<a class="sourceLine" id="cb65-9" title="9"><span class="co">#&gt; 5        -6       -25      116   -19  1.93         -9.83</span></a>
<a class="sourceLine" id="cb65-10" title="10"><span class="co">#&gt; 6        -4        12      150    16  2.5           6.4 </span></a>
<a class="sourceLine" id="cb65-11" title="11"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p>以上的数据转换也可以通过<code>mutate()</code>一次完成：</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;delay&quot;</span>),air_time) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb66-4" title="4">    <span class="dt">gain =</span> arr_delay <span class="op">-</span><span class="st"> </span>dep_delay,</a>
<a class="sourceLine" id="cb66-5" title="5">    <span class="dt">hours =</span> air_time <span class="op">/</span><span class="st"> </span><span class="dv">60</span>,</a>
<a class="sourceLine" id="cb66-6" title="6">    <span class="dt">gain_per_hour =</span> gain<span class="op">/</span>hours)</a>
<a class="sourceLine" id="cb66-7" title="7"><span class="co">#&gt; # A tibble: 336,776 x 6</span></a>
<a class="sourceLine" id="cb66-8" title="8"><span class="co">#&gt;   dep_delay arr_delay air_time  gain hours gain_per_hour</span></a>
<a class="sourceLine" id="cb66-9" title="9"><span class="co">#&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb66-10" title="10"><span class="co">#&gt; 1         2        11      227     9  3.78          2.38</span></a>
<a class="sourceLine" id="cb66-11" title="11"><span class="co">#&gt; 2         4        20      227    16  3.78          4.23</span></a>
<a class="sourceLine" id="cb66-12" title="12"><span class="co">#&gt; 3         2        33      160    31  2.67         11.6 </span></a>
<a class="sourceLine" id="cb66-13" title="13"><span class="co">#&gt; 4        -1       -18      183   -17  3.05         -5.57</span></a>
<a class="sourceLine" id="cb66-14" title="14"><span class="co">#&gt; 5        -6       -25      116   -19  1.93         -9.83</span></a>
<a class="sourceLine" id="cb66-15" title="15"><span class="co">#&gt; 6        -4        12      150    16  2.5           6.4 </span></a>
<a class="sourceLine" id="cb66-16" title="16"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p>如果只想在保留新变量，可以使用<code>transmute()</code>：</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;delay&quot;</span>),air_time) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-3" title="3"><span class="st">  </span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb67-4" title="4">    <span class="dt">gain =</span> arr_delay <span class="op">-</span><span class="st"> </span>dep_delay,</a>
<a class="sourceLine" id="cb67-5" title="5">    <span class="dt">hours =</span> air_time <span class="op">/</span><span class="st"> </span><span class="dv">60</span>,</a>
<a class="sourceLine" id="cb67-6" title="6">    <span class="dt">gain_per_hour =</span> gain<span class="op">/</span>hours)</a>
<a class="sourceLine" id="cb67-7" title="7"><span class="co">#&gt; # A tibble: 336,776 x 3</span></a>
<a class="sourceLine" id="cb67-8" title="8"><span class="co">#&gt;    gain hours gain_per_hour</span></a>
<a class="sourceLine" id="cb67-9" title="9"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb67-10" title="10"><span class="co">#&gt; 1     9  3.78          2.38</span></a>
<a class="sourceLine" id="cb67-11" title="11"><span class="co">#&gt; 2    16  3.78          4.23</span></a>
<a class="sourceLine" id="cb67-12" title="12"><span class="co">#&gt; 3    31  2.67         11.6 </span></a>
<a class="sourceLine" id="cb67-13" title="13"><span class="co">#&gt; 4   -17  3.05         -5.57</span></a>
<a class="sourceLine" id="cb67-14" title="14"><span class="co">#&gt; 5   -19  1.93         -9.83</span></a>
<a class="sourceLine" id="cb67-15" title="15"><span class="co">#&gt; 6    16  2.5           6.4 </span></a>
<a class="sourceLine" id="cb67-16" title="16"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
</div>
<div id="常用创建函数" class="section level3">
<h3><span class="header-section-number">1.3.2</span> 常用创建函数</h3>
<p>有多种函数可以帮助<code>mutate()</code>创建新变量。比较重要的一点是，这些函数必须是向量化的：它能接受一个向量作为输入，并返回一个向量作为输出，而且输入和输出向量长度相等。下面介绍一些比较常用的函数。</p>
<p>**算术运算符 +、-、*、/、^**<br />
它们都是向量化的，使用所谓的“循环法则(recycling rules)”。如果一个参数比另一个参数短，那么前者会自动扩展到相同的长度，但某个参数是单个数值时，这种方式是最有效的，如<code>air_time * 60 或者 hours * 60 + minute</code>等。<br />
算术运算符的另一个用途是与我们后面将很快学到的聚集函数结合起来使用。例如,<code>x / sum(x)</code>可以计算出x的各个分量在总数中的比例，<code>y - mean(y)</code>计算出y的各个分量与均值之间的差异。</p>
<p><strong>模运算符 %/% 和 % </strong><br />
%/%（整除）和%%（求余）满足<code>x == y * (x %/% y) + （x %% y</code>, 这两个运算符在Python中分别是// 和 % 。<br />
模运算非常好用，因为它可以拆分整数。例如，在flights数据集中，可以根据<code>dep_time</code>计算出 <code>hour</code> 和 <code>minute</code>：</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="co">## air_time中表示时间的方式是“xyz”表示x点yz分</span></a>
<a class="sourceLine" id="cb68-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">hour =</span> air_time <span class="op">%/%</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb68-4" title="4">            <span class="dt">minute =</span> air_time <span class="op">%%</span><span class="st"> </span><span class="dv">100</span>)   </a>
<a class="sourceLine" id="cb68-5" title="5"><span class="co">#&gt; # A tibble: 336,776 x 2</span></a>
<a class="sourceLine" id="cb68-6" title="6"><span class="co">#&gt;    hour minute</span></a>
<a class="sourceLine" id="cb68-7" title="7"><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb68-8" title="8"><span class="co">#&gt; 1     2     27</span></a>
<a class="sourceLine" id="cb68-9" title="9"><span class="co">#&gt; 2     2     27</span></a>
<a class="sourceLine" id="cb68-10" title="10"><span class="co">#&gt; 3     1     60</span></a>
<a class="sourceLine" id="cb68-11" title="11"><span class="co">#&gt; 4     1     83</span></a>
<a class="sourceLine" id="cb68-12" title="12"><span class="co">#&gt; 5     1     16</span></a>
<a class="sourceLine" id="cb68-13" title="13"><span class="co">#&gt; 6     1     50</span></a>
<a class="sourceLine" id="cb68-14" title="14"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p><strong>对数函数 log()/log2()/log10()</strong><br />
在处理取值范围变化多个数量级的数据时，对数变换很有用。其他条件相同的情况下，更推荐使用<code>log2()</code>函数，因为它的解释很容易，对数变换后的变量每增加一个单位，意味着原始变量加倍 ； 减少一个单位，则原始数据变为原来的一半。</p>
<p><strong>偏移函数</strong><br />
<code>lead()</code>和<code>lag()</code>函数分别将一个向量向前或向后移动指定的单位：</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="co">## 将x向前移动2个单位</span></a>
<a class="sourceLine" id="cb69-3" title="3"><span class="kw">lead</span>(x,<span class="dt">n=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb69-4" title="4"><span class="co">#&gt;  [1]  3  4  5  6  7  8  9 10 NA NA</span></a>
<a class="sourceLine" id="cb69-5" title="5"><span class="co">## 将x向后移动一个单位（默认n=1）</span></a>
<a class="sourceLine" id="cb69-6" title="6"><span class="kw">lag</span>(x)</a>
<a class="sourceLine" id="cb69-7" title="7"><span class="co">#&gt;  [1] NA  1  2  3  4  5  6  7  8  9</span></a></code></pre></div>
<p><strong>累加和滚动聚合</strong><br />
R的基础包提供了计算累加和、累加积、累加最小值和累加最大值的函数：<code>cumsum()、cumprod()、cummax()、cummin()</code>；dplyr包还提供了<code>cummean()</code>函数以计算累积平均值。</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb70-2" title="2"><span class="kw">cumsum</span>(x)</a>
<a class="sourceLine" id="cb70-3" title="3"><span class="co">#&gt;  [1]  1  3  6 10 15 21 28 36 45 55</span></a>
<a class="sourceLine" id="cb70-4" title="4"><span class="kw">cumprod</span>(x)</a>
<a class="sourceLine" id="cb70-5" title="5"><span class="co">#&gt;  [1]       1       2       6      24     120     720    5040   40320  362880</span></a>
<a class="sourceLine" id="cb70-6" title="6"><span class="co">#&gt; [10] 3628800</span></a>
<a class="sourceLine" id="cb70-7" title="7"><span class="kw">cummax</span>(x)</a>
<a class="sourceLine" id="cb70-8" title="8"><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></a>
<a class="sourceLine" id="cb70-9" title="9"><span class="kw">cummin</span>(x)</a>
<a class="sourceLine" id="cb70-10" title="10"><span class="co">#&gt;  [1] 1 1 1 1 1 1 1 1 1 1</span></a>
<a class="sourceLine" id="cb70-11" title="11"><span class="kw">cummean</span>(x)</a>
<a class="sourceLine" id="cb70-12" title="12"><span class="co">#&gt;  [1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5</span></a></code></pre></div>
<p><strong>逻辑比较 &gt;、&lt;=、&gt;、&gt;=、==、!=</strong><br />
如果要进行一系列复杂的逻辑运算，最好将中间结果保存在新变量中，这样就可以检查每一步是否都符合预期。</p>
<p><strong>排秩</strong><br />
排秩函数有很多，从<code>min_rank()</code>开始，它可以完成最常用的排秩任务。默认的排秩方式是，最小的值获得最前面的秩（升序），使用<code>desc(x)</code>可以让最大的值获得前面的名次,NA值对应的秩也是NA：</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="ot">NA</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb71-2" title="2"><span class="kw">min_rank</span>(x)</a>
<a class="sourceLine" id="cb71-3" title="3"><span class="co">#&gt; [1]  1  2  2 NA  4  5</span></a>
<a class="sourceLine" id="cb71-4" title="4"><span class="kw">min_rank</span>(<span class="kw">desc</span>(x))</a>
<a class="sourceLine" id="cb71-5" title="5"><span class="co">#&gt; [1]  5  3  3 NA  2  1</span></a></code></pre></div>
<p><code>min_rank()</code>函数把相同值赋予相同的秩，如果有n个值秩相同为x，则下一个值的秩会直接从x+n开始
如果<code>min_rank()</code>无法满足需要，可以看一下它的一些变体：</p>
<ul>
<li><code>row_number()</code>,相同值不同秩</li>
</ul>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="ot">NA</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb72-2" title="2"><span class="kw">min_rank</span>(x)</a>
<a class="sourceLine" id="cb72-3" title="3"><span class="co">#&gt; [1]  1  2  2 NA  4  5</span></a>
<a class="sourceLine" id="cb72-4" title="4"><span class="kw">row_number</span>(x)</a>
<a class="sourceLine" id="cb72-5" title="5"><span class="co">#&gt; [1]  1  2  3 NA  4  5</span></a></code></pre></div>
<ul>
<li><code>dense_rank</code>：相同值的秩相同，但下一个值的秩不会跳转</li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="ot">NA</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb73-2" title="2"><span class="kw">min_rank</span>(x)</a>
<a class="sourceLine" id="cb73-3" title="3"><span class="co">#&gt; [1]  1  2  2 NA  4  5</span></a>
<a class="sourceLine" id="cb73-4" title="4"><span class="kw">row_number</span>(x)</a>
<a class="sourceLine" id="cb73-5" title="5"><span class="co">#&gt; [1]  1  2  3 NA  4  5</span></a>
<a class="sourceLine" id="cb73-6" title="6"><span class="kw">dense_rank</span>(x)</a>
<a class="sourceLine" id="cb73-7" title="7"><span class="co">#&gt; [1]  1  2  2 NA  3  4</span></a></code></pre></div>
<ul>
<li><code>percent_rank()</code>: 将秩按照比例压缩为[0,1]的值</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="ot">NA</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="kw">percent_rank</span>(x)</a>
<a class="sourceLine" id="cb74-3" title="3"><span class="co">#&gt; [1] 0.00 0.25 0.25   NA 0.75 1.00</span></a></code></pre></div>
<ul>
<li><code>ntile()</code>：breaks the input vector into n buckets.</li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb75-2" title="2"><span class="kw">ntile</span>(x,<span class="dt">n=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb75-3" title="3"><span class="co">#&gt; [1] 1 1 1 2 2 2</span></a>
<a class="sourceLine" id="cb75-4" title="4"><span class="kw">ntile</span>(x,<span class="dt">n=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb75-5" title="5"><span class="co">#&gt; [1] 1 1 2 2 3 3</span></a></code></pre></div>
</div>
<div id="exercises-2" class="section level3">
<h3><span class="header-section-number">1.3.3</span> Exercises</h3>

<div class="exercise">
<span id="exr:unnamed-chunk-86" class="exercise"><strong>Exercise 1.9  </strong></span>虽然现在的<code>dep_time</code>和<code>sched_dep_time</code>变量方便阅读，但不适合计算，因为它们实际上并不是连续型数值。将它们转换为一种更方便的表示形式，即从 0 点开始的分钟数
</div>

<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="co"># 观察两个变量的存储方式</span></a>
<a class="sourceLine" id="cb76-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="st">  </span><span class="kw">select</span>(dep_time, sched_dep_time)</a>
<a class="sourceLine" id="cb76-4" title="4"><span class="co">#&gt; # A tibble: 336,776 x 2</span></a>
<a class="sourceLine" id="cb76-5" title="5"><span class="co">#&gt;   dep_time sched_dep_time</span></a>
<a class="sourceLine" id="cb76-6" title="6"><span class="co">#&gt;      &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb76-7" title="7"><span class="co">#&gt; 1      517            515</span></a>
<a class="sourceLine" id="cb76-8" title="8"><span class="co">#&gt; 2      533            529</span></a>
<a class="sourceLine" id="cb76-9" title="9"><span class="co">#&gt; 3      542            540</span></a>
<a class="sourceLine" id="cb76-10" title="10"><span class="co">#&gt; 4      544            545</span></a>
<a class="sourceLine" id="cb76-11" title="11"><span class="co">#&gt; 5      554            600</span></a>
<a class="sourceLine" id="cb76-12" title="12"><span class="co">#&gt; 6      554            558</span></a>
<a class="sourceLine" id="cb76-13" title="13"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p>xyz 表示 x 点 yz 分，则总分钟数为<code>x %/% 100 * 60 + x %% 100</code> ; 但有一个问题是，由于 0 点是用2400代表的，经过这样的转换它变为 1440，我们希望它变为 0，所以在外层再套一个<code>%% 1440</code></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb77-2" title="2">  <span class="dt">dep_time_mins =</span> (dep_time <span class="op">%/%</span><span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span> <span class="op">+</span><span class="st"> </span>dep_time <span class="op">%%</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%%</span><span class="st"> </span><span class="dv">1440</span>, </a>
<a class="sourceLine" id="cb77-3" title="3">  <span class="dt">sched_dep_time_mins =</span> (sched_dep_time <span class="op">%/%</span><span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span> <span class="op">+</span><span class="st"> </span>sched_dep_time <span class="op">%%</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%%</span><span class="st"> </span><span class="dv">1440</span>)</a>
<a class="sourceLine" id="cb77-4" title="4"><span class="co">#&gt; # A tibble: 336,776 x 2</span></a>
<a class="sourceLine" id="cb77-5" title="5"><span class="co">#&gt;   dep_time_mins sched_dep_time_mins</span></a>
<a class="sourceLine" id="cb77-6" title="6"><span class="co">#&gt;           &lt;dbl&gt;               &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb77-7" title="7"><span class="co">#&gt; 1           317                 315</span></a>
<a class="sourceLine" id="cb77-8" title="8"><span class="co">#&gt; 2           333                 329</span></a>
<a class="sourceLine" id="cb77-9" title="9"><span class="co">#&gt; 3           342                 340</span></a>
<a class="sourceLine" id="cb77-10" title="10"><span class="co">#&gt; 4           344                 345</span></a>
<a class="sourceLine" id="cb77-11" title="11"><span class="co">#&gt; 5           354                 360</span></a>
<a class="sourceLine" id="cb77-12" title="12"><span class="co">#&gt; 6           354                 358</span></a>
<a class="sourceLine" id="cb77-13" title="13"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>比较<code>dep_time、sched_dep_time 和 dep_delay</code>，这三者应该是何种关系？</li>
</ol>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">flights_deptime &lt;-</a>
<a class="sourceLine" id="cb78-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(flights,</a>
<a class="sourceLine" id="cb78-3" title="3">    <span class="dt">dep_time_min =</span> (dep_time <span class="op">%/%</span><span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span> <span class="op">+</span><span class="st"> </span>dep_time <span class="op">%%</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%%</span><span class="st"> </span><span class="dv">1440</span>,</a>
<a class="sourceLine" id="cb78-4" title="4">    <span class="dt">sched_dep_time_min =</span> (sched_dep_time <span class="op">%/%</span><span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb78-5" title="5"><span class="st">                          </span>sched_dep_time <span class="op">%%</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%%</span><span class="st"> </span><span class="dv">1440</span>,</a>
<a class="sourceLine" id="cb78-6" title="6">    <span class="dt">dep_delay_diff =</span> dep_delay <span class="op">-</span><span class="st"> </span>dep_time_min <span class="op">+</span><span class="st"> </span>sched_dep_time_min</a>
<a class="sourceLine" id="cb78-7" title="7">  )</a>
<a class="sourceLine" id="cb78-8" title="8"><span class="kw">filter</span>(flights_deptime, dep_delay_diff <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(dep_delay_diff)</a>
<a class="sourceLine" id="cb78-9" title="9"><span class="co">#&gt; # A tibble: 1,236 x 1</span></a>
<a class="sourceLine" id="cb78-10" title="10"><span class="co">#&gt;   dep_delay_diff</span></a>
<a class="sourceLine" id="cb78-11" title="11"><span class="co">#&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb78-12" title="12"><span class="co">#&gt; 1           1440</span></a>
<a class="sourceLine" id="cb78-13" title="13"><span class="co">#&gt; 2           1440</span></a>
<a class="sourceLine" id="cb78-14" title="14"><span class="co">#&gt; 3           1440</span></a>
<a class="sourceLine" id="cb78-15" title="15"><span class="co">#&gt; 4           1440</span></a>
<a class="sourceLine" id="cb78-16" title="16"><span class="co">#&gt; 5           1440</span></a>
<a class="sourceLine" id="cb78-17" title="17"><span class="co">#&gt; 6           1440</span></a>
<a class="sourceLine" id="cb78-18" title="18"><span class="co">#&gt; # ... with 1,230 more rows</span></a></code></pre></div>
<p>如上所示，经过分钟的转换后，有1236行的<code>dep_delay</code> 不等于 <code>dep_time - sched_dep_time</code>. 有趣的是，这些差值全部等于1440。<br />
&gt; the discrepancies could be because a flight was scheduled to depart before midnight, but was delayed after midnight. All of these discrepancies are exactly equal to 1440 (24 hours), and the flights with these discrepancies were scheduled to depart later in the day.</p>
<ol start="3" style="list-style-type: decimal">
<li>使用排秩函数找出10个出发延误时间最长的航班</li>
</ol>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co">## 使min_rank默认小的值获得小的秩，arrange()默认降序排列，其中一个函数中要使用desc()</span></a>
<a class="sourceLine" id="cb79-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">delay_rank =</span> <span class="kw">min_rank</span>(<span class="kw">desc</span>(dep_delay))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(delay_rank) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year,month,day,dep_delay,delay_rank)</a>
<a class="sourceLine" id="cb79-3" title="3"><span class="co">#&gt; # A tibble: 336,776 x 5</span></a>
<a class="sourceLine" id="cb79-4" title="4"><span class="co">#&gt;    year month   day dep_delay delay_rank</span></a>
<a class="sourceLine" id="cb79-5" title="5"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb79-6" title="6"><span class="co">#&gt; 1  2013     1     9      1301          1</span></a>
<a class="sourceLine" id="cb79-7" title="7"><span class="co">#&gt; 2  2013     6    15      1137          2</span></a>
<a class="sourceLine" id="cb79-8" title="8"><span class="co">#&gt; 3  2013     1    10      1126          3</span></a>
<a class="sourceLine" id="cb79-9" title="9"><span class="co">#&gt; 4  2013     9    20      1014          4</span></a>
<a class="sourceLine" id="cb79-10" title="10"><span class="co">#&gt; 5  2013     7    22      1005          5</span></a>
<a class="sourceLine" id="cb79-11" title="11"><span class="co">#&gt; 6  2013     4    10       960          6</span></a>
<a class="sourceLine" id="cb79-12" title="12"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><code>1:3 + 1:10</code>会返回什么？为什么？</li>
</ol>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="dv">1</span><span class="op">:</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="co">#&gt;  [1]  2  4  6  5  7  9  8 10 12 11</span></a></code></pre></div>
<p>当一个向量中的值不够用时，这个向量会被循环使用
<code>1:3 + 1:10</code>等价于<code>c(1 + 1, 2 + 2, 3 + 3, 1 + 4, 2 + 5, 3 + 6, 1 + 7, 2 + 8, 3 + 9, 1 + 10)</code></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">c</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span>, <span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span>, <span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span>, <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span>, <span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>, <span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">9</span>, <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb81-2" title="2"><span class="co">#&gt;  [1]  2  4  6  5  7  9  8 10 12 11</span></a></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arrange.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summarize.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/rfordatascience/edit/master/dplyr-core.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
