<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.1 filter() | R for data science: tidyverse and beyond</title>
  <meta name="description" content="1.1 filter() | R for data science: tidyverse and beyond" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="1.1 filter() | R for data science: tidyverse and beyond" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="enixam/rfordatascience" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.1 filter() | R for data science: tidyverse and beyond" />
  
  
  

<meta name="author" content="Maxine" />


<meta name="date" content="2020-05-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dplyr-data-transformation.html"/>
<link rel="next" href="arrange.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/jsoneditor-5.25.6/jsoneditor.min.css" rel="stylesheet" />
<script src="libs/jsoneditor-5.25.6/jsoneditor.min.js"></script>
<script src="libs/jsonedit-binding-3.0.0/jsonedit.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R4DS: tidyverse and beyond</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="part"><span><b>I R for data science</b></span></li>
<li class="chapter" data-level="1" data-path="dplyr-data-transformation.html"><a href="dplyr-data-transformation.html"><i class="fa fa-check"></i><b>1</b> dplyr: Data transformation</a><ul>
<li class="chapter" data-level="1.1" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>1.1</b> <code>filter()</code></a><ul>
<li class="chapter" data-level="1.1.1" data-path="filter.html"><a href="filter.html#operators"><i class="fa fa-check"></i><b>1.1.1</b> Operators</a></li>
<li class="chapter" data-level="1.1.2" data-path="filter.html"><a href="filter.html#missing-values"><i class="fa fa-check"></i><b>1.1.2</b> Missing values</a></li>
<li class="chapter" data-level="1.1.3" data-path="filter.html"><a href="filter.html#exercises"><i class="fa fa-check"></i><b>1.1.3</b> Exercises</a></li>
<li class="chapter" data-level="1.1.4" data-path="filter.html"><a href="filter.html#slice"><i class="fa fa-check"></i><b>1.1.4</b> <code>slice()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="arrange.html"><a href="arrange.html"><i class="fa fa-check"></i><b>1.2</b> <code>arrange()</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="arrange.html"><a href="arrange.html#exercises-1"><i class="fa fa-check"></i><b>1.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="select.html"><a href="select.html"><i class="fa fa-check"></i><b>1.3</b> <code>select()</code></a><ul>
<li class="chapter" data-level="1.3.1" data-path="select.html"><a href="select.html#练习"><i class="fa fa-check"></i><b>1.3.1</b> 练习</a></li>
<li class="chapter" data-level="1.3.2" data-path="select.html"><a href="select.html#常用创建函数"><i class="fa fa-check"></i><b>1.3.2</b> 常用创建函数</a></li>
<li class="chapter" data-level="1.3.3" data-path="select.html"><a href="select.html#exercises-2"><i class="fa fa-check"></i><b>1.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="summarize.html"><a href="summarize.html"><i class="fa fa-check"></i><b>1.4</b> <code>summarize()</code></a><ul>
<li class="chapter" data-level="1.4.1" data-path="summarize.html"><a href="summarize.html#missing-values-in-summarize"><i class="fa fa-check"></i><b>1.4.1</b> Missing values in <code>summarize()</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="summarize.html"><a href="summarize.html#计数函数"><i class="fa fa-check"></i><b>1.4.2</b> 计数函数</a></li>
<li class="chapter" data-level="1.4.3" data-path="summarize.html"><a href="summarize.html#逻辑值的计数和比例sumx-10-和-meany-0"><i class="fa fa-check"></i><b>1.4.3</b> 逻辑值的计数和比例:<code>sum(x &gt; 10) 和 mean(y == 0)</code></a></li>
<li class="chapter" data-level="1.4.4" data-path="summarize.html"><a href="summarize.html#其他常用的摘要函数"><i class="fa fa-check"></i><b>1.4.4</b> 其他常用的摘要函数</a></li>
<li class="chapter" data-level="1.4.5" data-path="summarize.html"><a href="summarize.html#多个分组变量的消耗"><i class="fa fa-check"></i><b>1.4.5</b> 多个分组变量的消耗</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="group-by-combined-with-other-functions.html"><a href="group-by-combined-with-other-functions.html"><i class="fa fa-check"></i><b>1.5</b> <code>group_by()</code> combined with other functions</a></li>
<li class="chapter" data-level="1.6" data-path="dplyr-exercise.html"><a href="dplyr-exercise.html"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tibble-modern-data-frames.html"><a href="tibble-modern-data-frames.html"><i class="fa fa-check"></i><b>2</b> tibble: Modern data frames</a><ul>
<li class="chapter" data-level="2.1" data-path="tibble-intro.html"><a href="tibble-intro.html"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html"><i class="fa fa-check"></i><b>2.2</b> Comparing tibble and data.frame</a><ul>
<li class="chapter" data-level="2.2.1" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html#creating"><i class="fa fa-check"></i><b>2.2.1</b> Creating</a></li>
<li class="chapter" data-level="2.2.2" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html#printing"><i class="fa fa-check"></i><b>2.2.2</b> Printing</a></li>
<li class="chapter" data-level="2.2.3" data-path="tibble-data-frame.html"><a href="tibble-data-frame.html#subsetting"><i class="fa fa-check"></i><b>2.2.3</b> Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html"><i class="fa fa-check"></i><b>2.3</b> Comparing two data frames (tibbles)</a><ul>
<li class="chapter" data-level="2.3.1" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#dplyrall_equal"><i class="fa fa-check"></i><b>2.3.1</b> <code>dplyr::all_equal()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#janitorcompare_df_cols"><i class="fa fa-check"></i><b>2.3.2</b> <code>janitor::compare_df_cols()</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#vetralike"><i class="fa fa-check"></i><b>2.3.3</b> <code>vetr::alike()</code></a></li>
<li class="chapter" data-level="2.3.4" data-path="comparing-two-data-frames-tibbles.html"><a href="comparing-two-data-frames-tibbles.html#diffdfdiffdf"><i class="fa fa-check"></i><b>2.3.4</b> <code>diffdf::diffdf()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="tibble-exercise.html"><a href="tibble-exercise.html"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="readr-data-import.html"><a href="readr-data-import.html"><i class="fa fa-check"></i><b>3</b> readr: Data import</a><ul>
<li class="chapter" data-level="3.1" data-path="importing-data-in-base-r.html"><a href="importing-data-in-base-r.html"><i class="fa fa-check"></i><b>3.1</b> Importing data in base R</a></li>
<li class="chapter" data-level="3.2" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html"><i class="fa fa-check"></i><b>3.2</b> Importing data in <code>readr</code></a><ul>
<li class="chapter" data-level="3.2.1" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html#introduction"><i class="fa fa-check"></i><b>3.2.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2.2" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html#writing-data"><i class="fa fa-check"></i><b>3.2.2</b> Writing data</a></li>
<li class="chapter" data-level="3.2.3" data-path="importing-data-in-readr.html"><a href="importing-data-in-readr.html#exercises-3"><i class="fa fa-check"></i><b>3.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html"><i class="fa fa-check"></i><b>3.3</b> Parsing a vector</a><ul>
<li class="chapter" data-level="3.3.1" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#numeric"><i class="fa fa-check"></i><b>3.3.1</b> Numeric</a></li>
<li class="chapter" data-level="3.3.2" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#character"><i class="fa fa-check"></i><b>3.3.2</b> Character</a></li>
<li class="chapter" data-level="3.3.3" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#factor"><i class="fa fa-check"></i><b>3.3.3</b> Factor</a></li>
<li class="chapter" data-level="3.3.4" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#date-and-time"><i class="fa fa-check"></i><b>3.3.4</b> Date and time</a></li>
<li class="chapter" data-level="3.3.5" data-path="parsing-a-vector.html"><a href="parsing-a-vector.html#exercises-4"><i class="fa fa-check"></i><b>3.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="parsing-a-file.html"><a href="parsing-a-file.html"><i class="fa fa-check"></i><b>3.4</b> Parsing a file</a><ul>
<li class="chapter" data-level="3.4.1" data-path="parsing-a-file.html"><a href="parsing-a-file.html#strategies"><i class="fa fa-check"></i><b>3.4.1</b> Strategies</a></li>
<li class="chapter" data-level="3.4.2" data-path="parsing-a-file.html"><a href="parsing-a-file.html#possible-challenges"><i class="fa fa-check"></i><b>3.4.2</b> Possible challenges</a></li>
<li class="chapter" data-level="3.4.3" data-path="parsing-a-file.html"><a href="parsing-a-file.html#other-tips"><i class="fa fa-check"></i><b>3.4.3</b> Other tips</a></li>
<li class="chapter" data-level="3.4.4" data-path="parsing-a-file.html"><a href="parsing-a-file.html#example-dealing-with-metadata"><i class="fa fa-check"></i><b>3.4.4</b> Example: Dealing with metadata</a></li>
<li class="chapter" data-level="3.4.5" data-path="parsing-a-file.html"><a href="parsing-a-file.html#example-multi-row-headers"><i class="fa fa-check"></i><b>3.4.5</b> Example: multi-row headers</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="readxl.html"><a href="readxl.html"><i class="fa fa-check"></i><b>3.5</b> <code>readxl</code></a><ul>
<li class="chapter" data-level="3.5.1" data-path="readxl.html"><a href="readxl.html#multi-row-headers-in-excel"><i class="fa fa-check"></i><b>3.5.1</b> Multi-row headers in Excel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lubridate-dates-and-times.html"><a href="lubridate-dates-and-times.html"><i class="fa fa-check"></i><b>4</b> lubridate: Dates and times</a><ul>
<li class="chapter" data-level="4.1" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html"><i class="fa fa-check"></i><b>4.1</b> Creating dates and times</a><ul>
<li class="chapter" data-level="4.1.1" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#from-strings"><i class="fa fa-check"></i><b>4.1.1</b> From strings</a></li>
<li class="chapter" data-level="4.1.2" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#from-individual-components"><i class="fa fa-check"></i><b>4.1.2</b> From individual components</a></li>
<li class="chapter" data-level="4.1.3" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#from-other-times"><i class="fa fa-check"></i><b>4.1.3</b> From other times</a></li>
<li class="chapter" data-level="4.1.4" data-path="creating-dates-and-times.html"><a href="creating-dates-and-times.html#exercises-5"><i class="fa fa-check"></i><b>4.1.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="date-time-components.html"><a href="date-time-components.html"><i class="fa fa-check"></i><b>4.2</b> Date-time components</a><ul>
<li class="chapter" data-level="4.2.1" data-path="date-time-components.html"><a href="date-time-components.html#accessing-components"><i class="fa fa-check"></i><b>4.2.1</b> Accessing components</a></li>
<li class="chapter" data-level="4.2.2" data-path="date-time-components.html"><a href="date-time-components.html#rounding"><i class="fa fa-check"></i><b>4.2.2</b> Rounding</a></li>
<li class="chapter" data-level="4.2.3" data-path="date-time-components.html"><a href="date-time-components.html#setting-components"><i class="fa fa-check"></i><b>4.2.3</b> Setting components</a></li>
<li class="chapter" data-level="4.2.4" data-path="date-time-components.html"><a href="date-time-components.html#exercises-6"><i class="fa fa-check"></i><b>4.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="time-span.html"><a href="time-span.html"><i class="fa fa-check"></i><b>4.3</b> Time span</a><ul>
<li class="chapter" data-level="4.3.1" data-path="time-span.html"><a href="time-span.html#时期-durations"><i class="fa fa-check"></i><b>4.3.1</b> 时期 Durations</a></li>
<li class="chapter" data-level="4.3.2" data-path="time-span.html"><a href="time-span.html#阶段-periods"><i class="fa fa-check"></i><b>4.3.2</b> 阶段 Periods</a></li>
<li class="chapter" data-level="4.3.3" data-path="time-span.html"><a href="time-span.html#区间-intervals"><i class="fa fa-check"></i><b>4.3.3</b> 区间 Intervals</a></li>
<li class="chapter" data-level="4.3.4" data-path="time-span.html"><a href="time-span.html#conclusion"><i class="fa fa-check"></i><b>4.3.4</b> Conclusion</a></li>
<li class="chapter" data-level="4.3.5" data-path="time-span.html"><a href="time-span.html#exercises-7"><i class="fa fa-check"></i><b>4.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="hms.html"><a href="hms.html"><i class="fa fa-check"></i><b>4.4</b> hms</a></li>
<li class="chapter" data-level="4.5" data-path="dint.html"><a href="dint.html"><i class="fa fa-check"></i><b>4.5</b> dint</a><ul>
<li class="chapter" data-level="4.5.1" data-path="dint.html"><a href="dint.html#creation"><i class="fa fa-check"></i><b>4.5.1</b> Creation</a></li>
<li class="chapter" data-level="4.5.2" data-path="dint.html"><a href="dint.html#arithmetic-and-sequences"><i class="fa fa-check"></i><b>4.5.2</b> Arithmetic and Sequences</a></li>
<li class="chapter" data-level="4.5.3" data-path="dint.html"><a href="dint.html#accessors"><i class="fa fa-check"></i><b>4.5.3</b> Accessors</a></li>
<li class="chapter" data-level="4.5.4" data-path="dint.html"><a href="dint.html#formatting"><i class="fa fa-check"></i><b>4.5.4</b> Formatting</a></li>
<li class="chapter" data-level="4.5.5" data-path="dint.html"><a href="dint.html#labelling-functions-in-ggplot2"><i class="fa fa-check"></i><b>4.5.5</b> Labelling functions in ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="forcats-factor.html"><a href="forcats-factor.html"><i class="fa fa-check"></i><b>5</b> forcats: factor</a><ul>
<li class="chapter" data-level="5.1" data-path="factor-basics.html"><a href="factor-basics.html"><i class="fa fa-check"></i><b>5.1</b> Factor basics</a></li>
<li class="chapter" data-level="5.2" data-path="sorting.html"><a href="sorting.html"><i class="fa fa-check"></i><b>5.2</b> Sorting</a><ul>
<li class="chapter" data-level="5.2.1" data-path="sorting.html"><a href="sorting.html#sorting-by-frequency-appearance-or-numeric-order"><i class="fa fa-check"></i><b>5.2.1</b> Sorting by frequency, appearance, or numeric order</a></li>
<li class="chapter" data-level="5.2.2" data-path="sorting.html"><a href="sorting.html#sorting-by-another-variable"><i class="fa fa-check"></i><b>5.2.2</b> Sorting by another variable</a></li>
<li class="chapter" data-level="5.2.3" data-path="sorting.html"><a href="sorting.html#sorting-manually"><i class="fa fa-check"></i><b>5.2.3</b> Sorting manually</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html"><i class="fa fa-check"></i><b>5.3</b> Chaninge number of levels</a><ul>
<li class="chapter" data-level="5.3.1" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#lumping-levels"><i class="fa fa-check"></i><b>5.3.1</b> Lumping levels</a></li>
<li class="chapter" data-level="5.3.2" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#expanding-levels"><i class="fa fa-check"></i><b>5.3.2</b> Expanding levels</a></li>
<li class="chapter" data-level="5.3.3" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#dropping-levels"><i class="fa fa-check"></i><b>5.3.3</b> Dropping levels</a></li>
<li class="chapter" data-level="5.3.4" data-path="chaninge-number-of-levels.html"><a href="chaninge-number-of-levels.html#transforming-na-levels"><i class="fa fa-check"></i><b>5.3.4</b> Transforming NA levels</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="recoding.html"><a href="recoding.html"><i class="fa fa-check"></i><b>5.4</b> Recoding</a><ul>
<li class="chapter" data-level="5.4.1" data-path="recoding.html"><a href="recoding.html#exercises-8"><i class="fa fa-check"></i><b>5.4.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidyr-tidy-data.html"><a href="tidyr-tidy-data.html"><i class="fa fa-check"></i><b>6</b> tidyr: Tidy data</a><ul>
<li class="chapter" data-level="6.1" data-path="tidyr-intro.html"><a href="tidyr-intro.html"><i class="fa fa-check"></i><b>6.1</b> Tidy data</a><ul>
<li class="chapter" data-level="6.1.1" data-path="tidyr-intro.html"><a href="tidyr-intro.html#exercises-9"><i class="fa fa-check"></i><b>6.1.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="pivoting.html"><a href="pivoting.html"><i class="fa fa-check"></i><b>6.2</b> Pivoting</a><ul>
<li class="chapter" data-level="6.2.1" data-path="pivoting.html"><a href="pivoting.html#pivot_longer"><i class="fa fa-check"></i><b>6.2.1</b> <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="pivoting.html"><a href="pivoting.html#pivot_wider"><i class="fa fa-check"></i><b>6.2.2</b> <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="6.2.3" data-path="pivoting.html"><a href="pivoting.html#combining-pivot_longer-and-pivot_wider"><i class="fa fa-check"></i><b>6.2.3</b> Combining <code>pivot_longer()</code> and <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="pivoting.html"><a href="pivoting.html#exercises-10"><i class="fa fa-check"></i><b>6.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="nesting.html"><a href="nesting.html"><i class="fa fa-check"></i><b>6.3</b> Nesting</a><ul>
<li class="chapter" data-level="6.3.1" data-path="nesting.html"><a href="nesting.html#example-managing-multiple-models"><i class="fa fa-check"></i><b>6.3.1</b> Example: Managing multiple models</a></li>
<li class="chapter" data-level="6.3.2" data-path="nesting.html"><a href="nesting.html#multi-choice"><i class="fa fa-check"></i><b>6.3.2</b> Example: Multicple hoice data</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="rectangling.html"><a href="rectangling.html"><i class="fa fa-check"></i><b>6.4</b> Rectangling</a><ul>
<li class="chapter" data-level="6.4.1" data-path="rectangling.html"><a href="rectangling.html#github-users"><i class="fa fa-check"></i><b>6.4.1</b> Github users</a></li>
<li class="chapter" data-level="6.4.2" data-path="rectangling.html"><a href="rectangling.html#github-repos"><i class="fa fa-check"></i><b>6.4.2</b> Github repos</a></li>
<li class="chapter" data-level="6.4.3" data-path="rectangling.html"><a href="rectangling.html#game-of-throne-characters"><i class="fa fa-check"></i><b>6.4.3</b> Game of Throne characters</a></li>
<li class="chapter" data-level="6.4.4" data-path="rectangling.html"><a href="rectangling.html#sharla-gelfands-discography"><i class="fa fa-check"></i><b>6.4.4</b> Sharla Gelfand’s discography</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="separate-and-untie.html"><a href="separate-and-untie.html"><i class="fa fa-check"></i><b>6.5</b> <code>separate()</code> and <code>untie()</code></a><ul>
<li class="chapter" data-level="6.5.1" data-path="separate-and-untie.html"><a href="separate-and-untie.html#separate"><i class="fa fa-check"></i><b>6.5.1</b> <code>separate()</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="separate-and-untie.html"><a href="separate-and-untie.html#unite"><i class="fa fa-check"></i><b>6.5.2</b> <code>unite()</code></a></li>
<li class="chapter" data-level="6.5.3" data-path="separate-and-untie.html"><a href="separate-and-untie.html#exercises-11"><i class="fa fa-check"></i><b>6.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="tidyr-missing.html"><a href="tidyr-missing.html"><i class="fa fa-check"></i><b>6.6</b> Handling missing values</a></li>
<li class="chapter" data-level="6.7" data-path="tidyr-case.html"><a href="tidyr-case.html"><i class="fa fa-check"></i><b>6.7</b> Case Study</a></li>
<li class="chapter" data-level="6.8" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html"><i class="fa fa-check"></i><b>6.8</b> Miscellaneous Functions</a><ul>
<li class="chapter" data-level="6.8.1" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html#chop-and-unchop"><i class="fa fa-check"></i><b>6.8.1</b> <code>chop()</code> and <code>unchop()</code></a></li>
<li class="chapter" data-level="6.8.2" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html#uncount"><i class="fa fa-check"></i><b>6.8.2</b> <code>uncount()</code></a></li>
<li class="chapter" data-level="6.8.3" data-path="miscellaneous-functions.html"><a href="miscellaneous-functions.html#exercises-12"><i class="fa fa-check"></i><b>6.8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="non-tidy.html"><a href="non-tidy.html"><i class="fa fa-check"></i><b>6.9</b> None-tidy data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="purrr-functional-programming.html"><a href="purrr-functional-programming.html"><i class="fa fa-check"></i><b>7</b> purrr: Functional programming</a><ul>
<li class="chapter" data-level="7.1" data-path="map-family.html"><a href="map-family.html"><i class="fa fa-check"></i><b>7.1</b> <code>map()</code> family</a></li>
<li class="chapter" data-level="7.2" data-path="producing-atomic-vectors.html"><a href="producing-atomic-vectors.html"><i class="fa fa-check"></i><b>7.2</b> Producing atomic vectors</a><ul>
<li class="chapter" data-level="7.2.1" data-path="producing-atomic-vectors.html"><a href="producing-atomic-vectors.html#purrr-style-anonymous-functions"><i class="fa fa-check"></i><b>7.2.1</b> purrr-style anonymous functions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="predicate-functions.html"><a href="predicate-functions.html"><i class="fa fa-check"></i><b>7.3</b> Predicate functions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="predicate-functions.html"><a href="predicate-functions.html#basics"><i class="fa fa-check"></i><b>7.3.1</b> Basics</a></li>
<li class="chapter" data-level="7.3.2" data-path="predicate-functions.html"><a href="predicate-functions.html#map-variants"><i class="fa fa-check"></i><b>7.3.2</b> Map variants</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="group-functions.html"><a href="group-functions.html"><i class="fa fa-check"></i><b>7.4</b> group functions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="group-functions.html"><a href="group-functions.html#group_mapgroup_modify"><i class="fa fa-check"></i><b>7.4.1</b> group_map、group_modify</a></li>
<li class="chapter" data-level="7.4.2" data-path="group-functions.html"><a href="group-functions.html#group_nestgroup_splitgroup_keysgroup_data"><i class="fa fa-check"></i><b>7.4.2</b> group_nest、group_split、group_keys、group_data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="other-useful-tools.html"><a href="other-useful-tools.html"><i class="fa fa-check"></i><b>7.5</b> Other useful tools</a><ul>
<li class="chapter" data-level="7.5.1" data-path="other-useful-tools.html"><a href="other-useful-tools.html#imap"><i class="fa fa-check"></i><b>7.5.1</b> <code>imap()</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="other-useful-tools.html"><a href="other-useful-tools.html#adverbs"><i class="fa fa-check"></i><b>7.5.2</b> adverbs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>8</b> Relational data</a><ul>
<li class="chapter" data-level="8.1" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="mutating-joins.html"><a href="mutating-joins.html"><i class="fa fa-check"></i><b>8.2</b> Mutating joins</a></li>
<li class="chapter" data-level="8.3" data-path="filtering-join.html"><a href="filtering-join.html"><i class="fa fa-check"></i><b>8.3</b> Filtering join</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="broom-tidy-representation-of-models.html"><a href="broom-tidy-representation-of-models.html"><i class="fa fa-check"></i><b>9</b> broom: Tidy representation of models</a><ul>
<li class="chapter" data-level="9.1" data-path="viz-many-models.html"><a href="viz-many-models.html"><i class="fa fa-check"></i><b>9.1</b> Visualizing many models</a></li>
<li class="chapter" data-level="9.2" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>9.2</b> Examples</a><ul>
<li class="chapter" data-level="9.2.1" data-path="examples.html"><a href="examples.html#pca"><i class="fa fa-check"></i><b>9.2.1</b> PCA</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="broomextra.html"><a href="broomextra.html"><i class="fa fa-check"></i><b>9.3</b> broomExtra</a></li>
<li class="chapter" data-level="9.4" data-path="ggfortify.html"><a href="ggfortify.html"><i class="fa fa-check"></i><b>9.4</b> ggfortify</a></li>
</ul></li>
<li class="part"><span><b>II Importing</b></span></li>
<li class="chapter" data-level="10" data-path="vroom-fast-reading-of-delimited-files.html"><a href="vroom-fast-reading-of-delimited-files.html"><i class="fa fa-check"></i><b>10</b> vroom: Fast reading of delimited files</a></li>
<li class="chapter" data-level="11" data-path="reading-in-data-from-other-formats.html"><a href="reading-in-data-from-other-formats.html"><i class="fa fa-check"></i><b>11</b> Reading in data from other formats</a><ul>
<li class="chapter" data-level="11.1" data-path="pdf.html"><a href="pdf.html"><i class="fa fa-check"></i><b>11.1</b> PDF</a><ul>
<li class="chapter" data-level="11.1.1" data-path="pdf.html"><a href="pdf.html#scraping-pdf-data"><i class="fa fa-check"></i><b>11.1.1</b> Scraping pdf data</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="office-documents.html"><a href="office-documents.html"><i class="fa fa-check"></i><b>11.2</b> Office documents</a></li>
<li class="chapter" data-level="11.3" data-path="google-sheet.html"><a href="google-sheet.html"><i class="fa fa-check"></i><b>11.3</b> Google sheet</a></li>
<li class="chapter" data-level="11.4" data-path="images.html"><a href="images.html"><i class="fa fa-check"></i><b>11.4</b> Images</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="useful-apis.html"><a href="useful-apis.html"><i class="fa fa-check"></i><b>12</b> Useful APIs</a><ul>
<li class="chapter" data-level="12.1" data-path="wdi.html"><a href="wdi.html"><i class="fa fa-check"></i><b>12.1</b> WDI</a><ul>
<li class="chapter" data-level="12.1.1" data-path="wdi.html"><a href="wdi.html#wdisearch"><i class="fa fa-check"></i><b>12.1.1</b> <code>WDIsearch()</code></a></li>
<li class="chapter" data-level="12.1.2" data-path="wdi.html"><a href="wdi.html#wdi-1"><i class="fa fa-check"></i><b>12.1.2</b> <code>WDI</code></a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="ipumsr.html"><a href="ipumsr.html"><i class="fa fa-check"></i><b>12.2</b> ipumsr</a></li>
</ul></li>
<li class="part"><span><b>III Exploring and Wrangling</b></span></li>
<li class="chapter" data-level="13" data-path="data-summary.html"><a href="data-summary.html"><i class="fa fa-check"></i><b>13</b> Data summary</a><ul>
<li class="chapter" data-level="13.1" data-path="skimr.html"><a href="skimr.html"><i class="fa fa-check"></i><b>13.1</b> skimr</a></li>
<li class="chapter" data-level="13.2" data-path="visdat.html"><a href="visdat.html"><i class="fa fa-check"></i><b>13.2</b> visdat</a></li>
<li class="chapter" data-level="13.3" data-path="summarytools.html"><a href="summarytools.html"><i class="fa fa-check"></i><b>13.3</b> summarytools</a><ul>
<li class="chapter" data-level="13.3.1" data-path="summarytools.html"><a href="summarytools.html#freq"><i class="fa fa-check"></i><b>13.3.1</b> <code>freq</code></a></li>
<li class="chapter" data-level="13.3.2" data-path="summarytools.html"><a href="summarytools.html#descr"><i class="fa fa-check"></i><b>13.3.2</b> <code>descr()</code></a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="gt-and-gtsummary.html"><a href="gt-and-gtsummary.html"><i class="fa fa-check"></i><b>13.4</b> gt and gtsummary</a></li>
<li class="chapter" data-level="13.5" data-path="naniar.html"><a href="naniar.html"><i class="fa fa-check"></i><b>13.5</b> naniar</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="janitor.html"><a href="janitor.html"><i class="fa fa-check"></i><b>14</b> Janitor</a><ul>
<li class="chapter" data-level="14.1" data-path="janitor-cleaning.html"><a href="janitor-cleaning.html"><i class="fa fa-check"></i><b>14.1</b> cleaning</a><ul>
<li class="chapter" data-level="14.1.1" data-path="janitor-cleaning.html"><a href="janitor-cleaning.html#clean_names"><i class="fa fa-check"></i><b>14.1.1</b> <code>clean_names</code></a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="janitor-explore.html"><a href="janitor-explore.html"><i class="fa fa-check"></i><b>14.2</b> Exploring</a><ul>
<li class="chapter" data-level="14.2.1" data-path="janitor-explore.html"><a href="janitor-explore.html#tabyl"><i class="fa fa-check"></i><b>14.2.1</b> <code>tabyl</code></a></li>
<li class="chapter" data-level="14.2.2" data-path="janitor-explore.html"><a href="janitor-explore.html#get_dupes"><i class="fa fa-check"></i><b>14.2.2</b> <code>get_dupes</code></a></li>
<li class="chapter" data-level="14.2.3" data-path="janitor-explore.html"><a href="janitor-explore.html#remove_"><i class="fa fa-check"></i><b>14.2.3</b> <code>remove_</code></a></li>
<li class="chapter" data-level="14.2.4" data-path="janitor-explore.html"><a href="janitor-explore.html#round_half_up"><i class="fa fa-check"></i><b>14.2.4</b> <code>round_half_up</code></a></li>
<li class="chapter" data-level="14.2.5" data-path="janitor-explore.html"><a href="janitor-explore.html#excel_numeric_to_date"><i class="fa fa-check"></i><b>14.2.5</b> <code>excel_numeric_to_date</code></a></li>
<li class="chapter" data-level="14.2.6" data-path="janitor-explore.html"><a href="janitor-explore.html#top_levels"><i class="fa fa-check"></i><b>14.2.6</b> <code>top_levels</code></a></li>
<li class="chapter" data-level="14.2.7" data-path="janitor-explore.html"><a href="janitor-explore.html#row_to_names"><i class="fa fa-check"></i><b>14.2.7</b> <code>row_to_names</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Miscellaneous tools</b></span></li>
<li class="chapter" data-level="15" data-path="advanced-relational-data.html"><a href="advanced-relational-data.html"><i class="fa fa-check"></i><b>15</b> Advanced relational data</a><ul>
<li class="chapter" data-level="15.1" data-path="fuzzyjoin.html"><a href="fuzzyjoin.html"><i class="fa fa-check"></i><b>15.1</b> fuzzyjoin</a><ul>
<li class="chapter" data-level="15.1.1" data-path="fuzzyjoin.html"><a href="fuzzyjoin.html#inexact-matching"><i class="fa fa-check"></i><b>15.1.1</b> inexact matching</a></li>
<li class="chapter" data-level="15.1.2" data-path="fuzzyjoin.html"><a href="fuzzyjoin.html#stringdist"><i class="fa fa-check"></i><b>15.1.2</b> stringdist</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="funneljoin.html"><a href="funneljoin.html"><i class="fa fa-check"></i><b>15.2</b> funneljoin</a><ul>
<li class="chapter" data-level="15.2.1" data-path="funneljoin.html"><a href="funneljoin.html#after_join"><i class="fa fa-check"></i><b>15.2.1</b> <code>after_join()</code></a></li>
<li class="chapter" data-level="15.2.2" data-path="funneljoin.html"><a href="funneljoin.html#funnel-in-one-table"><i class="fa fa-check"></i><b>15.2.2</b> funnel in one table</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="dm.html"><a href="dm.html"><i class="fa fa-check"></i><b>15.3</b> dm</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="categorical-data-facotr.html"><a href="categorical-data-facotr.html"><i class="fa fa-check"></i><b>16</b> Categorical data (facotr)</a><ul>
<li class="chapter" data-level="16.1" data-path="frequency-and-contingency-table.html"><a href="frequency-and-contingency-table.html"><i class="fa fa-check"></i><b>16.1</b> Frequency and contingency table</a><ul>
<li class="chapter" data-level="16.1.1" data-path="frequency-and-contingency-table.html"><a href="frequency-and-contingency-table.html#frq-and-flat_table"><i class="fa fa-check"></i><b>16.1.1</b> <code>frq()</code> and <code>flat_table()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="coding.html"><a href="coding.html"><i class="fa fa-check"></i><b>16.2</b> Coding</a><ul>
<li class="chapter" data-level="16.2.1" data-path="coding.html"><a href="coding.html#rec"><i class="fa fa-check"></i><b>16.2.1</b> <code>rec()</code></a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="cutting.html"><a href="cutting.html"><i class="fa fa-check"></i><b>16.3</b> Cutting</a><ul>
<li class="chapter" data-level="16.3.1" data-path="cutting.html"><a href="cutting.html#chop"><i class="fa fa-check"></i><b>16.3.1</b> <code>chop()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="dealing-with-missing-values.html"><a href="dealing-with-missing-values.html"><i class="fa fa-check"></i><b>17</b> Dealing with missing values</a><ul>
<li class="chapter" data-level="17.1" data-path="explore-missing.html"><a href="explore-missing.html"><i class="fa fa-check"></i><b>17.1</b> Exploring</a><ul>
<li class="chapter" data-level="17.1.1" data-path="explore-missing.html"><a href="explore-missing.html#naniar-1"><i class="fa fa-check"></i><b>17.1.1</b> naniar</a></li>
<li class="chapter" data-level="17.1.2" data-path="explore-missing.html"><a href="explore-missing.html#replace-a-value-with-na"><i class="fa fa-check"></i><b>17.1.2</b> Replace a value with NA</a></li>
<li class="chapter" data-level="17.1.3" data-path="explore-missing.html"><a href="explore-missing.html#janitor-1"><i class="fa fa-check"></i><b>17.1.3</b> janitor</a></li>
<li class="chapter" data-level="17.1.4" data-path="explore-missing.html"><a href="explore-missing.html#sjmisc"><i class="fa fa-check"></i><b>17.1.4</b> sjmisc</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>17.2</b> Wrangling</a><ul>
<li class="chapter" data-level="17.2.1" data-path="wrangling.html"><a href="wrangling.html#tidyr"><i class="fa fa-check"></i><b>17.2.1</b> tidyr</a></li>
<li class="chapter" data-level="17.2.2" data-path="wrangling.html"><a href="wrangling.html#janitor-2"><i class="fa fa-check"></i><b>17.2.2</b> janitor</a></li>
<li class="chapter" data-level="17.2.3" data-path="wrangling.html"><a href="wrangling.html#visdat-1"><i class="fa fa-check"></i><b>17.2.3</b> visdat</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="imputation.html"><a href="imputation.html"><i class="fa fa-check"></i><b>17.3</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">written with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for data science: tidyverse and beyond</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="filter" class="section level2">
<h2><span class="header-section-number">1.1</span> <code>filter()</code></h2>
<p><code>filter()</code> 可以基于观测值筛选行，符合条件的行留下，不符合条件的被剔除，最终得到一个观测子集。第一个参数是数据集的名称，第二个参数以及随后的参数是用来筛选行的条件。例如，我们可以使用以下代码筛选出一月一日的所有航班（条件：月 = 1 且 日 = 1）</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">filter</span>(month <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, day <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; # A tibble: 842 x 19</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt; # ... with 836 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<p>思考筛选的方式：
以行为单位，如果该行满足所指定的条件，则被筛选出 ； 若不满足，则被剔除。使用<code>filter()</code>时，总应该从每一行的角度来思考问题。</p>
<div id="operators" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Operators</h3>
<p>为了有效地进行筛选，R 提供了一套标准的运算符，包括比较运算符和逻辑运算符。</p>
<p><strong>比较运算符</strong>： <code>==、！= 、 &gt; 、 &gt;= 、 &lt; 、 &lt;=</code>
当开始编写条件时，最容易犯的错误就是用<code>=</code>而不是<code>==</code>来测试是否相等。R 对于这种错误会提供一条启发性的错误信息：</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">flights <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span><span class="kw">filter</span>(<span class="dt">month =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt; Error: `month` (`month = 1`) must not be named, do you need `==`?</span></a></code></pre></div>
<p>在判断是否相等时，还有另一个常见问题：浮点数。例如，下面的结果可能出人意料：</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">sqrt</span>(<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="dv">1</span> <span class="op">/</span><span class="dv">49</span> <span class="op">*</span><span class="st"> </span><span class="dv">49</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>计算机使用的是有限位运算，不能存储无限位的数。因此我们看到的每个数都是一个近似值。比较浮点数是否相等时，不能用<code>==</code>,而应该用<code>near()</code>,它用于比较两个数值向量是否相等，且带有一定容忍度(tolerence):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">near</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">near</span>(<span class="dv">1</span> <span class="op">/</span><span class="dv">49</span> <span class="op">*</span><span class="st"> </span><span class="dv">49</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>**逻辑运算符*
<code>filter()</code>中的多个参数是“与”的关系，如 <code>data %&gt;% filter(condition_1,condition_2,···,condition_n)</code> 表示的是“我希望同时筛选出满足这n个条件的行。如果要实现其他类型的组合，需要使用逻辑（布尔）运算符。<code>&amp;</code>表示与，<code>|</code>表示或，<code>!</code>表示非。下图给出了布尔运算的完整集合：</p>
<p><img src="images/18.png" width="524" style="display: block; margin: auto;" /></p>
<p>例如，想要找出11月 <strong>或</strong> 12月出发的所有航班：</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(month <span class="op">==</span><span class="st"> </span><span class="dv">11</span> <span class="op">|</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span><span class="dv">12</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; # A tibble: 55,403 x 19</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; 1  2013    11     1        5           2359         6      352            345</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; 2  2013    11     1       35           2250       105      123           2356</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; 3  2013    11     1      455            500        -5      641            651</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; 4  2013    11     1      539            545        -6      856            827</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; 5  2013    11     1      542            545        -3      831            855</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; 6  2013    11     1      549            600       -11      912            923</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; # ... with 55,397 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<p>这种问题有一个有用的简写形式：<code>x %in% y</code>，这个表达式在x被包含于y的时候返回TRUE，我们可以这样改写上面的代码：</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(month <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">11</span>, <span class="dv">12</span>))  <span class="co">## 找出所有月份值包含在该向量里的行</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt; # A tibble: 55,403 x 19</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; 1  2013    11     1        5           2359         6      352            345</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt; 2  2013    11     1       35           2250       105      123           2356</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt; 3  2013    11     1      455            500        -5      641            651</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; 4  2013    11     1      539            545        -6      856            827</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; 5  2013    11     1      542            545        -3      831            855</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; 6  2013    11     1      549            600       -11      912            923</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; # ... with 55,397 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<p>有时可以使用德摩根律来将筛选条件简化：<code>!(x &amp; y)</code>等价于<code>!x | !y</code>，而<code>!(x | y)</code>等价于<code>!x &amp; !y</code>。例如，如果想要找出延误时间（到达和出发)都不多于两个小时的航班，以下两种方式均可：
<code>flights %&gt;% filter(arr_delay &lt;= 120 &amp; dep_dealy &lt;= 120 )</code><br />
<code>flights %&gt;% filter(!(arr_delay &gt; 120| dep_delay &gt; 120 ))</code></p>
<p>dplyr中另外一个对筛选有帮助的函数是<code>between(x, left, right)</code>，它用于判断x是否落在left和right两个值确定的闭区间里。
例如找出所有在11月和12月出发的航班也可以这样表达：</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">between</span>(month, <span class="dv">11</span>, <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; # A tibble: 55,403 x 19</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt; 1  2013    11     1        5           2359         6      352            345</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; 2  2013    11     1       35           2250       105      123           2356</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; 3  2013    11     1      455            500        -5      641            651</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; 4  2013    11     1      539            545        -6      856            827</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt; 5  2013    11     1      542            545        -3      831            855</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt; 6  2013    11     1      549            600       -11      912            923</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt; # ... with 55,397 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<p>有些时候，<code>filter()</code> 函数中用来筛选的条件可能比较复杂，需要书写令人费解的逻辑表达式，这时候可以考虑创建一个新变量代表逻辑判断的结果。这样检查代码会容易很多。我们很快就会介绍如何创建新变量。</p>

<div class="rmdcaution">
&amp; and &amp;&amp; indicate logical AND and | and || indicate logical OR. The shorter form performs elementwise comparisons in much the same way as arithmetic operators. The longer form evaluates left to right examining only the first element of each vector. Evaluation proceeds only until the result is determined. The longer form is appropriate for programming control-flow and typically preferred in if clauses.
</div>

</div>
<div id="missing-values" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Missing values</h3>
<p>NA (not available)表示未知的值、缺失值，缺失值一个很重要的特点是它是“可传染的”。如果运算中包含了缺失值，那么运算结果一般来说也会是缺失值。</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="ot">NA</span> <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="ot">NA</span> <span class="op">==</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="ot">NA</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="ot">NA</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
<p>以上的表达式的结果都是NA，这很好理解，如果R不知道表达式其中的一个量究竟是什么值，自然表达式的结果也就不可知。<br />
还要注意一件事：</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="ot">NA</span> <span class="op">==</span><span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
<p>这样理解：</p>
<blockquote>
<p>令 x 为Mary的年龄，我们不知道她有多大：x &lt;- NA<br />
令 y 为John的年龄，我们同样不知道他又多大：x &lt;- NA<br />
Mary和John的年龄相同吗？： x == y<br />
不知道！</p>
</blockquote>
<p>鉴于此，使用<code>NA == x</code>来判断x是否是缺失值不可行。我们用函数<code>is.na()</code>进行判断：</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">x =<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">is.na</span>(x)</a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>前面说过，<code>filter()</code> 实际上是在提问：某行的某个 \ 某些变量满足给定的条件吗？如果为 TRUE，则筛选出该行。如果该行在涉及变量上的取值是 NA，那么逻辑表达式也会返回 NA，这些行将被返回结果为 FALSE 的行一并被排除。如果想保留缺失值，同样可以利用逻辑表达式指出：</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="ot">NA</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb14-2" title="2">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">is.na</span>(x) <span class="op">|</span><span class="st"> </span>x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co">#&gt; # A tibble: 2 x 1</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">#&gt;       x</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co">#&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co">#&gt; 1    NA</span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="co">#&gt; 2     3</span></a></code></pre></div>
<p>For more topics on missing values, see section <a href="tidyr-missing.html#tidyr-missing">6.6</a> and Chapter <a href="dealing-with-missing-values.html#dealing-with-missing-values">17</a>.</p>
</div>
<div id="exercises" class="section level3">
<h3><span class="header-section-number">1.1.3</span> Exercises</h3>

<div class="exercise">
<span id="exr:unnamed-chunk-17" class="exercise"><strong>Exercise 1.1  </strong></span>找出满足以下条件的所有航班:
</div>

<blockquote>
<p>到达时间延误两小时或更多的航班</p>
</blockquote>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(arr_delay <span class="op">&gt;=</span><span class="st"> </span><span class="dv">120</span>)</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co">#&gt; # A tibble: 10,200 x 19</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">#&gt; 1  2013     1     1      811            630       101     1047            830</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">#&gt; 2  2013     1     1      848           1835       853     1001           1950</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">#&gt; 3  2013     1     1      957            733       144     1056            853</span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">#&gt; 4  2013     1     1     1114            900       134     1447           1222</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">#&gt; 5  2013     1     1     1505           1310       115     1638           1431</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">#&gt; 6  2013     1     1     1525           1340       105     1831           1626</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">#&gt; # ... with 10,194 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<blockquote>
<p>飞往休斯顿（IAH机场或者HOU机场）的航班</p>
</blockquote>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;IAH&quot;</span> <span class="op">|</span><span class="st"> </span>dest <span class="op">==</span><span class="st"> &quot;HOU&quot;</span>)</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co">#&gt; # A tibble: 9,313 x 19</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co">#&gt; 3  2013     1     1      623            627        -4      933            932</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co">#&gt; 4  2013     1     1      728            732        -4     1041           1038</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">#&gt; 5  2013     1     1      739            739         0     1104           1038</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">#&gt; 6  2013     1     1      908            908         0     1228           1219</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="co">#&gt; # ... with 9,307 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<p>也可以写成<code>filter(flights, dest %in% c("HOU","IAH"))</code></p>
<blockquote>
<p>由联合航空（United）、美利坚航空（American）或者三角洲航空（Delat）运营的航班
<code>carrier</code>列代表了航空公司，但是用两个字母缩写表示：</p>
</blockquote>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">flights[<span class="st">&quot;carrier&quot;</span>]</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">#&gt; # A tibble: 336,776 x 1</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">#&gt;   carrier</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#&gt;   &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">#&gt; 1 UA     </span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#&gt; 2 UA     </span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#&gt; 3 AA     </span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">#&gt; 4 B6     </span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">#&gt; 5 DL     </span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co">#&gt; 6 UA     </span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co">#&gt; # ... with 336,770 more rows</span></a></code></pre></div>
<p>我们可以在<code>airlines</code>数据集中找到这些缩写的含义：</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">airlines</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="co">#&gt; # A tibble: 16 x 2</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co">#&gt;   carrier name                    </span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;                   </span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="co">#&gt; 1 9E      Endeavor Air Inc.       </span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co">#&gt; 2 AA      American Airlines Inc.  </span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">#&gt; 3 AS      Alaska Airlines Inc.    </span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">#&gt; 4 B6      JetBlue Airways         </span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co">#&gt; 5 DL      Delta Air Lines Inc.    </span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co">#&gt; 6 EV      ExpressJet Airlines Inc.</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co">#&gt; # ... with 10 more rows</span></a></code></pre></div>
<p>三角洲航空对应 “DL”，“UA” 代表联合航空，“AA”代表美利坚航空</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(carrier <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;DL&quot;</span>, <span class="st">&quot;UA&quot;</span>, <span class="st">&quot;AA&quot;</span>))</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co">#&gt; # A tibble: 139,504 x 19</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co">#&gt; 4  2013     1     1      554            600        -6      812            837</span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="co">#&gt; 5  2013     1     1      554            558        -4      740            728</span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="co">#&gt; 6  2013     1     1      558            600        -2      753            745</span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="co">#&gt; # ... with 139,498 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<blockquote>
<p>夏季(7月、8月、9月)出发的航班</p>
</blockquote>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(month <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">#&gt; # A tibble: 86,326 x 19</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="co">#&gt; 1  2013     7     1        1           2029       212      236           2359</span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="co">#&gt; 2  2013     7     1        2           2359         3      344            344</span></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="co">#&gt; 3  2013     7     1       29           2245       104      151              1</span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="co">#&gt; 4  2013     7     1       43           2130       193      322             14</span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="co">#&gt; 5  2013     7     1       44           2150       174      300            100</span></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="co">#&gt; 6  2013     7     1       46           2051       235      304           2358</span></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="co">#&gt; # ... with 86,320 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb20-12" title="12"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb20-13" title="13"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<p>另一种写法：<code>filter(flgihts,month &gt;= 7, month &lt;= 9)</code><br />
用<code>between()</code>函数的写法：</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">between</span>(month,<span class="dv">7</span>,<span class="dv">9</span>))</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="co">#&gt; # A tibble: 86,326 x 19</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co">#&gt; 1  2013     7     1        1           2029       212      236           2359</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">#&gt; 2  2013     7     1        2           2359         3      344            344</span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co">#&gt; 3  2013     7     1       29           2245       104      151              1</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="co">#&gt; 4  2013     7     1       43           2130       193      322             14</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="co">#&gt; 5  2013     7     1       44           2150       174      300            100</span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="co">#&gt; 6  2013     7     1       46           2051       235      304           2358</span></a>
<a class="sourceLine" id="cb21-11" title="11"><span class="co">#&gt; # ... with 86,320 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb21-12" title="12"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb21-13" title="13"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<blockquote>
<p>到达时间延误超过两小时，但出发时间没有延误的航班</p>
</blockquote>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(dep_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">120</span> ,</a>
<a class="sourceLine" id="cb22-2" title="2">                   arr_delay <span class="op">&lt;=</span><span class="st"> </span><span class="dv">120</span>)</a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co">#&gt; # A tibble: 1,262 x 19</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co">#&gt; 1  2013     1     1     1540           1338       122     2020           1825</span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="co">#&gt; 2  2013     1     2     2334           2129       125       33           2242</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="co">#&gt; 3  2013     1     3     1321           1115       126     1450           1257</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co">#&gt; 4  2013     1     3     1758           1550       128     2240           2050</span></a>
<a class="sourceLine" id="cb22-10" title="10"><span class="co">#&gt; 5  2013     1     3     1933           1730       123     2131           1953</span></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="co">#&gt; 6  2013     1     4     1602           1359       123     1715           1517</span></a>
<a class="sourceLine" id="cb22-12" title="12"><span class="co">#&gt; # ... with 1,256 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb22-13" title="13"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb22-14" title="14"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<blockquote>
<p>延误至少一小时，但飞行过程弥补回30分钟的航班</p>
</blockquote>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(dep_delay <span class="op">-</span><span class="st"> </span>arr_delay <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="co">#&gt; # A tibble: 17,950 x 19</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb23-5" title="5"><span class="co">#&gt; 1  2013     1     1      701            700         1     1123           1154</span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="co">#&gt; 2  2013     1     1      820            820         0     1249           1329</span></a>
<a class="sourceLine" id="cb23-7" title="7"><span class="co">#&gt; 3  2013     1     1      840            845        -5     1311           1350</span></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="co">#&gt; 4  2013     1     1      857            851         6     1157           1222</span></a>
<a class="sourceLine" id="cb23-9" title="9"><span class="co">#&gt; 5  2013     1     1      909            810        59     1331           1315</span></a>
<a class="sourceLine" id="cb23-10" title="10"><span class="co">#&gt; 6  2013     1     1     1025            951        34     1258           1302</span></a>
<a class="sourceLine" id="cb23-11" title="11"><span class="co">#&gt; # ... with 17,944 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb23-12" title="12"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-13" title="13"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<blockquote>
<p>出发时间在午夜和早上6点之间（包括0点和6点）的航班</p>
</blockquote>
<p>在变量<code>dep_time</code>中，0 点用数值 2400 代表：</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">summary</span>(flights<span class="op">$</span>dep_time)</a>
<a class="sourceLine" id="cb24-2" title="2"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s </span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="co">#&gt;       1     907    1401    1349    1744    2400    8255</span></a></code></pre></div>
<p>出于这点，不能简单写成<code>dep_time &lt;= 600</code>，而是如下：</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">flights <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(dep_time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span> <span class="op">|</span><span class="st"> </span>dep_time <span class="op">==</span><span class="st"> </span><span class="dv">2400</span>)</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co">#&gt; # A tibble: 9,373 x 19</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co">#&gt; 1  2013     1     1      517            515         2      830            819</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="co">#&gt; 2  2013     1     1      533            529         4      850            830</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="co">#&gt; 3  2013     1     1      542            540         2      923            850</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004           1022</span></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="co">#&gt; 5  2013     1     1      554            600        -6      812            837</span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="co">#&gt; 6  2013     1     1      554            558        -4      740            728</span></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="co">#&gt; # ... with 9,367 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb25-12" title="12"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb25-13" title="13"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>

<div class="exercise">
<span id="exr:unnamed-chunk-29" class="exercise"><strong>Exercise 1.2  </strong></span>dep_time`有缺失值的航班有多少？其他变量的缺失值情况如何？
</div>

<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">sum</span>(<span class="kw">is.na</span>(flights<span class="op">$</span>dep_time))</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="co">#&gt; [1] 8255</span></a>
<a class="sourceLine" id="cb26-3" title="3">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">is.na</span>(dep_time))</a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co">#&gt; # A tibble: 8,255 x 19</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="co">#&gt; 1  2013     1     1       NA           1630        NA       NA           1815</span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="co">#&gt; 2  2013     1     1       NA           1935        NA       NA           2240</span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="co">#&gt; 3  2013     1     1       NA           1500        NA       NA           1825</span></a>
<a class="sourceLine" id="cb26-10" title="10"><span class="co">#&gt; 4  2013     1     1       NA            600        NA       NA            901</span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="co">#&gt; 5  2013     1     2       NA           1540        NA       NA           1747</span></a>
<a class="sourceLine" id="cb26-12" title="12"><span class="co">#&gt; 6  2013     1     2       NA           1620        NA       NA           1746</span></a>
<a class="sourceLine" id="cb26-13" title="13"><span class="co">#&gt; # ... with 8,249 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb26-14" title="14"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a></code></pre></div>
<p>注意到，所有<code>dep_time</code>为 NA 的航班在有关实际到达、出发情况的变量上取值皆为 NA，这些很可能是被取消的航班。</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># 其他变量中的缺失值</span></a>
<a class="sourceLine" id="cb27-2" title="2">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">  </span><span class="kw">summarize_all</span>( <span class="op">~</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">is.na</span>(.)))</a>
<a class="sourceLine" id="cb27-4" title="4"><span class="co">#&gt; # A tibble: 1 x 19</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;int&gt;    &lt;int&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="co">#&gt; 1     0     0     0     8255              0      8255     8713              0</span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="co">#&gt; # ... with 11 more variables: arr_delay &lt;int&gt;, carrier &lt;int&gt;, flight &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="co">#&gt; #   tailnum &lt;int&gt;, origin &lt;int&gt;, dest &lt;int&gt;, air_time &lt;int&gt;, distance &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="co">#&gt; #   hour &lt;int&gt;, minute &lt;int&gt;, time_hour &lt;int&gt;</span></a></code></pre></div>

<div class="exercise">
<span id="exr:unnamed-chunk-32" class="exercise"><strong>Exercise 1.3  </strong></span>为什么<code>NA ^ 0</code>的值不是NA，而<code>NA * 0</code>的值是NA ？为什么NA | TRUE 的值不是NA？为什么FALSE &amp; NA的值不是NA，能找出一般规律吗？
</div>

<p><strong>只要表达式的值被NA背后的未知量所决定，就返回NA</strong>
对于所有 x 的取值，都有<span class="math inline">\(x ^ 0 = 1\)</span>，<code>NA ^ 0</code>不取决于 NA 到底可能是什么值。<br />
但对于<span class="math inline">\(x * 0\)</span>，如果x趋近于正负无穷（ R 用<code>-inf</code> 和 <code>inf</code>代表），则R会返回 <code>NaN</code> 错误（not a number），只要知道 NA 究竟是什么，才能知道该表达式的结果</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="ot">NA</span> <span class="op">^</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="ot">NA</span> <span class="op">*</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="kw">c</span>(<span class="ot">Inf</span>,<span class="op">-</span><span class="ot">Inf</span>) <span class="op">*</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="co">#&gt; [1] NaN NaN</span></a></code></pre></div>
<p>同样，对于 <code>NA | TRUE</code>，不论 NA 是什么，该表达式总为真 ； 对于<code>NA &amp; FALSE</code>，不论 NA 是什么，该表达式总为假。</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="ot">NA</span> <span class="op">|</span><span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="ot">NA</span> <span class="op">&amp;</span><span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>而 <code>NA &amp; TRUE</code>和<code>NA | FALSE</code>则会返回 NA：</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="ot">NA</span> <span class="op">&amp;</span><span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="ot">NA</span> <span class="op">|</span><span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
</div>
<div id="slice" class="section level3">
<h3><span class="header-section-number">1.1.4</span> <code>slice()</code></h3>
<p><code>slice()</code> 及相关帮助函数同样可以用来筛选行，</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(1L)</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co">#&gt;   mpg cyl disp  hp drat   wt qsec vs am gear carb</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="co">#&gt; 1  21   6  160 110  3.9 2.62 16.5  0  1    4    4</span></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="co"># Similar to tail(mtcars, 1):</span></a>
<a class="sourceLine" id="cb31-5" title="5">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="kw">n</span>())</a>
<a class="sourceLine" id="cb31-6" title="6"><span class="co">#&gt;    mpg cyl disp  hp drat   wt qsec vs am gear carb</span></a>
<a class="sourceLine" id="cb31-7" title="7"><span class="co">#&gt; 1 21.4   4  121 109 4.11 2.78 18.6  1  1    4    2</span></a>
<a class="sourceLine" id="cb31-8" title="8">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">5</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb31-9" title="9"><span class="co">#&gt;     mpg cyl  disp  hp drat   wt qsec vs am gear carb</span></a>
<a class="sourceLine" id="cb31-10" title="10"><span class="co">#&gt; 1  18.7   8 360.0 175 3.15 3.44 17.0  0  0    3    2</span></a>
<a class="sourceLine" id="cb31-11" title="11"><span class="co">#&gt; 2  18.1   6 225.0 105 2.76 3.46 20.2  1  0    3    1</span></a>
<a class="sourceLine" id="cb31-12" title="12"><span class="co">#&gt; 3  14.3   8 360.0 245 3.21 3.57 15.8  0  0    3    4</span></a>
<a class="sourceLine" id="cb31-13" title="13"><span class="co">#&gt; 4  24.4   4 146.7  62 3.69 3.19 20.0  1  0    4    2</span></a>
<a class="sourceLine" id="cb31-14" title="14"><span class="co">#&gt; 5  22.8   4 140.8  95 3.92 3.15 22.9  1  0    4    2</span></a>
<a class="sourceLine" id="cb31-15" title="15"><span class="co">#&gt; 6  19.2   6 167.6 123 3.92 3.44 18.3  1  0    4    4</span></a>
<a class="sourceLine" id="cb31-16" title="16"><span class="co">#&gt; 7  17.8   6 167.6 123 3.92 3.44 18.9  1  0    4    4</span></a>
<a class="sourceLine" id="cb31-17" title="17"><span class="co">#&gt; 8  16.4   8 275.8 180 3.07 4.07 17.4  0  0    3    3</span></a>
<a class="sourceLine" id="cb31-18" title="18"><span class="co">#&gt; 9  17.3   8 275.8 180 3.07 3.73 17.6  0  0    3    3</span></a>
<a class="sourceLine" id="cb31-19" title="19"><span class="co">#&gt; 10 15.2   8 275.8 180 3.07 3.78 18.0  0  0    3    3</span></a>
<a class="sourceLine" id="cb31-20" title="20"><span class="co">#&gt; 11 10.4   8 472.0 205 2.93 5.25 18.0  0  0    3    4</span></a>
<a class="sourceLine" id="cb31-21" title="21"><span class="co">#&gt; 12 10.4   8 460.0 215 3.00 5.42 17.8  0  0    3    4</span></a>
<a class="sourceLine" id="cb31-22" title="22"><span class="co">#&gt; 13 14.7   8 440.0 230 3.23 5.34 17.4  0  0    3    4</span></a>
<a class="sourceLine" id="cb31-23" title="23"><span class="co">#&gt; 14 32.4   4  78.7  66 4.08 2.20 19.5  1  1    4    1</span></a>
<a class="sourceLine" id="cb31-24" title="24"><span class="co">#&gt; 15 30.4   4  75.7  52 4.93 1.61 18.5  1  1    4    2</span></a>
<a class="sourceLine" id="cb31-25" title="25"><span class="co">#&gt; 16 33.9   4  71.1  65 4.22 1.83 19.9  1  1    4    1</span></a>
<a class="sourceLine" id="cb31-26" title="26"><span class="co">#&gt; 17 21.5   4 120.1  97 3.70 2.46 20.0  1  0    3    1</span></a>
<a class="sourceLine" id="cb31-27" title="27"><span class="co">#&gt; 18 15.5   8 318.0 150 2.76 3.52 16.9  0  0    3    2</span></a>
<a class="sourceLine" id="cb31-28" title="28"><span class="co">#&gt; 19 15.2   8 304.0 150 3.15 3.44 17.3  0  0    3    2</span></a>
<a class="sourceLine" id="cb31-29" title="29"><span class="co">#&gt; 20 13.3   8 350.0 245 3.73 3.84 15.4  0  0    3    4</span></a>
<a class="sourceLine" id="cb31-30" title="30"><span class="co">#&gt; 21 19.2   8 400.0 175 3.08 3.85 17.1  0  0    3    2</span></a>
<a class="sourceLine" id="cb31-31" title="31"><span class="co">#&gt; 22 27.3   4  79.0  66 4.08 1.94 18.9  1  1    4    1</span></a>
<a class="sourceLine" id="cb31-32" title="32"><span class="co">#&gt; 23 26.0   4 120.3  91 4.43 2.14 16.7  0  1    5    2</span></a>
<a class="sourceLine" id="cb31-33" title="33"><span class="co">#&gt; 24 30.4   4  95.1 113 3.77 1.51 16.9  1  1    5    2</span></a>
<a class="sourceLine" id="cb31-34" title="34"><span class="co">#&gt; 25 15.8   8 351.0 264 4.22 3.17 14.5  0  1    5    4</span></a>
<a class="sourceLine" id="cb31-35" title="35"><span class="co">#&gt; 26 19.7   6 145.0 175 3.62 2.77 15.5  0  1    5    6</span></a>
<a class="sourceLine" id="cb31-36" title="36"><span class="co">#&gt; 27 15.0   8 301.0 335 3.54 3.57 14.6  0  1    5    8</span></a>
<a class="sourceLine" id="cb31-37" title="37"><span class="co">#&gt; 28 21.4   4 121.0 109 4.11 2.78 18.6  1  1    4    2</span></a>
<a class="sourceLine" id="cb31-38" title="38"><span class="co"># Rows can be dropped with negative indices:</span></a>
<a class="sourceLine" id="cb31-39" title="39"><span class="kw">slice</span>(mtcars, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>))</a>
<a class="sourceLine" id="cb31-40" title="40"><span class="co">#&gt;     mpg cyl  disp  hp drat   wt qsec vs am gear carb</span></a>
<a class="sourceLine" id="cb31-41" title="41"><span class="co">#&gt; 1  18.7   8 360.0 175 3.15 3.44 17.0  0  0    3    2</span></a>
<a class="sourceLine" id="cb31-42" title="42"><span class="co">#&gt; 2  18.1   6 225.0 105 2.76 3.46 20.2  1  0    3    1</span></a>
<a class="sourceLine" id="cb31-43" title="43"><span class="co">#&gt; 3  14.3   8 360.0 245 3.21 3.57 15.8  0  0    3    4</span></a>
<a class="sourceLine" id="cb31-44" title="44"><span class="co">#&gt; 4  24.4   4 146.7  62 3.69 3.19 20.0  1  0    4    2</span></a>
<a class="sourceLine" id="cb31-45" title="45"><span class="co">#&gt; 5  22.8   4 140.8  95 3.92 3.15 22.9  1  0    4    2</span></a>
<a class="sourceLine" id="cb31-46" title="46"><span class="co">#&gt; 6  19.2   6 167.6 123 3.92 3.44 18.3  1  0    4    4</span></a>
<a class="sourceLine" id="cb31-47" title="47"><span class="co">#&gt; 7  17.8   6 167.6 123 3.92 3.44 18.9  1  0    4    4</span></a>
<a class="sourceLine" id="cb31-48" title="48"><span class="co">#&gt; 8  16.4   8 275.8 180 3.07 4.07 17.4  0  0    3    3</span></a>
<a class="sourceLine" id="cb31-49" title="49"><span class="co">#&gt; 9  17.3   8 275.8 180 3.07 3.73 17.6  0  0    3    3</span></a>
<a class="sourceLine" id="cb31-50" title="50"><span class="co">#&gt; 10 15.2   8 275.8 180 3.07 3.78 18.0  0  0    3    3</span></a>
<a class="sourceLine" id="cb31-51" title="51"><span class="co">#&gt; 11 10.4   8 472.0 205 2.93 5.25 18.0  0  0    3    4</span></a>
<a class="sourceLine" id="cb31-52" title="52"><span class="co">#&gt; 12 10.4   8 460.0 215 3.00 5.42 17.8  0  0    3    4</span></a>
<a class="sourceLine" id="cb31-53" title="53"><span class="co">#&gt; 13 14.7   8 440.0 230 3.23 5.34 17.4  0  0    3    4</span></a>
<a class="sourceLine" id="cb31-54" title="54"><span class="co">#&gt; 14 32.4   4  78.7  66 4.08 2.20 19.5  1  1    4    1</span></a>
<a class="sourceLine" id="cb31-55" title="55"><span class="co">#&gt; 15 30.4   4  75.7  52 4.93 1.61 18.5  1  1    4    2</span></a>
<a class="sourceLine" id="cb31-56" title="56"><span class="co">#&gt; 16 33.9   4  71.1  65 4.22 1.83 19.9  1  1    4    1</span></a>
<a class="sourceLine" id="cb31-57" title="57"><span class="co">#&gt; 17 21.5   4 120.1  97 3.70 2.46 20.0  1  0    3    1</span></a>
<a class="sourceLine" id="cb31-58" title="58"><span class="co">#&gt; 18 15.5   8 318.0 150 2.76 3.52 16.9  0  0    3    2</span></a>
<a class="sourceLine" id="cb31-59" title="59"><span class="co">#&gt; 19 15.2   8 304.0 150 3.15 3.44 17.3  0  0    3    2</span></a>
<a class="sourceLine" id="cb31-60" title="60"><span class="co">#&gt; 20 13.3   8 350.0 245 3.73 3.84 15.4  0  0    3    4</span></a>
<a class="sourceLine" id="cb31-61" title="61"><span class="co">#&gt; 21 19.2   8 400.0 175 3.08 3.85 17.1  0  0    3    2</span></a>
<a class="sourceLine" id="cb31-62" title="62"><span class="co">#&gt; 22 27.3   4  79.0  66 4.08 1.94 18.9  1  1    4    1</span></a>
<a class="sourceLine" id="cb31-63" title="63"><span class="co">#&gt; 23 26.0   4 120.3  91 4.43 2.14 16.7  0  1    5    2</span></a>
<a class="sourceLine" id="cb31-64" title="64"><span class="co">#&gt; 24 30.4   4  95.1 113 3.77 1.51 16.9  1  1    5    2</span></a>
<a class="sourceLine" id="cb31-65" title="65"><span class="co">#&gt; 25 15.8   8 351.0 264 4.22 3.17 14.5  0  1    5    4</span></a>
<a class="sourceLine" id="cb31-66" title="66"><span class="co">#&gt; 26 19.7   6 145.0 175 3.62 2.77 15.5  0  1    5    6</span></a>
<a class="sourceLine" id="cb31-67" title="67"><span class="co">#&gt; 27 15.0   8 301.0 335 3.54 3.57 14.6  0  1    5    8</span></a>
<a class="sourceLine" id="cb31-68" title="68"><span class="co">#&gt; 28 21.4   4 121.0 109 4.11 2.78 18.6  1  1    4    2</span></a></code></pre></div>
<p>当要求依据某种排序选出前 / 后 n个观测时，<code>slice_max()</code> 和 <code>slice_min()</code> 可以很好地完成任务</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># top 5 cars with largest mpg</span></a>
<a class="sourceLine" id="cb32-2" title="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_max</span>(<span class="dt">order_by =</span> mpg, <span class="dt">n =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb32-3" title="3"><span class="co"># top 10% cars with least mpg, with ties not kept together </span></a>
<a class="sourceLine" id="cb32-4" title="4">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_min</span>(<span class="dt">order_by =</span> mpg, <span class="dt">prop =</span> <span class="fl">0.05</span>, <span class="dt">with_ties =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><code>slice_head()</code> and <code>slice_tail()</code> select the first or last rows. <code>slice_sample()</code> randomly selects rows.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co"># First and last rows based on existing order</span></a>
<a class="sourceLine" id="cb33-2" title="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_head</span>(<span class="dt">n =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb33-3" title="3">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_tail</span>(<span class="dt">n =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb33-4" title="4"></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="co"># slice_sample() allows you to random select with or without replacement</span></a>
<a class="sourceLine" id="cb33-6" title="6">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_sample</span>(<span class="dt">n =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb33-7" title="7">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_sample</span>(<span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dplyr-data-transformation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="arrange.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/rfordatascience/edit/master/dplyr-core.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
